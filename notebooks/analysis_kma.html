
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. KMA ANALYSIS &#8212; Storm Surge NZ - Summary - 21/05/2021</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.37f24b989f4638ff9c27c22dc7559d4f.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. LINEAR REGRESSION" href="models_linear.html" />
    <link rel="prev" title="3. CCA ANALYSIS" href="analysis_cca.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.jpeg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Storm Surge NZ - Summary - 21/05/2021</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   geocean-nz-ss
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="data_visualization.html">
   1. DATA VISUALIZATION / VALIDATION
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="analysis_pca.html">
   2. PCA ANALYSIS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="analysis_cca.html">
   3. CCA ANALYSIS
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. KMA ANALYSIS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="models_linear.html">
   5. LINEAR REGRESSION
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="models_knn.html">
   6. KNN REGRESSOR
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="forensic.html">
   7. STORMS VISUALIZATION
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/analysis_kma.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/javitausia/geocean-nz-ss"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/javitausia/geocean-nz-ss/issues/new?title=Issue%20on%20page%20%2Fnotebooks/analysis_kma.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/javitausia/geocean-nz-ss/master?urlpath=tree/notebooks/analysis_kma.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-wheather-types">
   4.1. calculate the wheather types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-prediction-errors">
   4.2. calculate prediction errors
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="kma-analysis">
<h1><span class="section-number">4. </span>KMA ANALYSIS<a class="headerlink" href="#kma-analysis" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># basics</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># append sscode to path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">))</span>

<span class="c1"># data viewer</span>
<span class="kn">from</span> <span class="nn">sscode.data</span> <span class="kn">import</span> <span class="n">Loader</span><span class="p">,</span> <span class="n">load_moana_hindcast_ss</span>
<span class="kn">from</span> <span class="nn">sscode.kma</span> <span class="kn">import</span> <span class="n">KMA_simple</span>
<span class="kn">from</span> <span class="nn">sscode.config</span> <span class="kn">import</span> <span class="n">default_region_reduced</span>

<span class="c1"># warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the data</span>
<span class="n">load_cfsr_moana_uhslc</span> <span class="o">=</span> <span class="n">Loader</span><span class="p">(</span>
    <span class="n">data_to_load</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cfsr&#39;</span><span class="p">,</span><span class="s1">&#39;moana&#39;</span><span class="p">,</span><span class="s1">&#39;uhslc&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> loading the sea-level-pressure fields... 


 loading daily resampled data... 
</pre></div>
</div>
<img alt="../_images/analysis_kma_2_1.png" src="../_images/analysis_kma_2_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> loading the Moana v2 hindcast data... 
</pre></div>
</div>
<img alt="../_images/analysis_kma_2_3.png" src="../_images/analysis_kma_2_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> loading and plotting the UHSLC tidal guages... 
</pre></div>
</div>
<img alt="../_images/analysis_kma_2_5.png" src="../_images/analysis_kma_2_5.png" />
<img alt="../_images/analysis_kma_2_6.png" src="../_images/analysis_kma_2_6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load / calculate the regional pcs</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;../data/cfsr/cfsr_regional_daily_pcs.nc&#39;</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    <span class="n">pcs_cfsr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
        <span class="s1">&#39;../data/cfsr/cfsr_regional_daily_pcs.nc&#39;</span>
    <span class="p">)</span>
    <span class="kn">from</span> <span class="nn">sscode.plotting.pca</span> <span class="kn">import</span> <span class="n">plot_pcs</span>
    <span class="n">plot_pcs</span><span class="p">(</span><span class="n">pcs_cfsr</span><span class="p">,</span><span class="n">n_plot</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> plotting 5 components with 2 EOFs + PC... 


 being the EOFs the slp, the gradient, in steps t, t-1 
</pre></div>
</div>
<img alt="../_images/analysis_kma_3_1.png" src="../_images/analysis_kma_3_1.png" />
<img alt="../_images/analysis_kma_3_2.png" src="../_images/analysis_kma_3_2.png" />
<img alt="../_images/analysis_kma_3_3.png" src="../_images/analysis_kma_3_3.png" />
<img alt="../_images/analysis_kma_3_4.png" src="../_images/analysis_kma_3_4.png" />
<img alt="../_images/analysis_kma_3_5.png" src="../_images/analysis_kma_3_5.png" />
<img alt="../_images/analysis_kma_3_6.png" src="../_images/analysis_kma_3_6.png" />
<img alt="../_images/analysis_kma_3_7.png" src="../_images/analysis_kma_3_7.png" />
<img alt="../_images/analysis_kma_3_8.png" src="../_images/analysis_kma_3_8.png" />
<img alt="../_images/analysis_kma_3_9.png" src="../_images/analysis_kma_3_9.png" />
<img alt="../_images/analysis_kma_3_10.png" src="../_images/analysis_kma_3_10.png" />
</div>
</div>
<div class="section" id="calculate-the-wheather-types">
<h2><span class="section-number">4.1. </span>calculate the wheather types<a class="headerlink" href="#calculate-the-wheather-types" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kms_data</span> <span class="o">=</span> <span class="n">KMA_simple</span><span class="p">(</span>
    <span class="n">load_cfsr_moana_uhslc</span><span class="o">.</span><span class="n">predictor_slp</span><span class="p">,</span>
    <span class="n">load_moana_hindcast_ss</span><span class="p">(</span><span class="n">daily</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">pcs_cfsr</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">64</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> loading the Moana v2 hindcast data (ss)... 


 The score of the KMA model is: 
</pre></div>
</div>
<img alt="../_images/analysis_kma_5_1.png" src="../_images/analysis_kma_5_1.png" />
<img alt="../_images/analysis_kma_5_2.png" src="../_images/analysis_kma_5_2.png" />
<img alt="../_images/analysis_kma_5_3.png" src="../_images/analysis_kma_5_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kms_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

.xr-wrap {
  min-width: 300px;
  max-width: 700px;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><div class='xr-wrap'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d32d9a2c-bc55-4f73-a32a-8f8b0f6652f6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d32d9a2c-bc55-4f73-a32a-8f8b0f6652f6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 117</li><li><span class='xr-has-index'>latitude</span>: 101</li><li><span class='xr-has-index'>lon</span>: 100</li><li><span class='xr-has-index'>longitude</span>: 101</li><li><span class='xr-has-index'>n_clusters</span>: 64</li><li><span>n_components</span>: 72</li><li><span class='xr-has-index'>test_time</span>: 839</li><li><span class='xr-has-index'>train_time</span>: 7546</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-16129553-9599-4041-8050-ed1fca462c66' class='xr-section-summary-in' type='checkbox'  checked><label for='section-16129553-9599-4041-8050-ed1fca462c66' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>140.0 140.5 141.0 ... 189.5 190.0</div><input id='attrs-4de28a7a-0cd6-4120-aa06-4d52b570f109' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4de28a7a-0cd6-4120-aa06-4d52b570f109' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5582b7b-c527-4417-b423-79bb18cdef53' class='xr-var-data-in' type='checkbox'><label for='data-c5582b7b-c527-4417-b423-79bb18cdef53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ], dtype=float32)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-20.0 -20.5 -21.0 ... -69.5 -70.0</div><input id='attrs-484ef9a7-5097-4995-b80e-b3752e7d183d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-484ef9a7-5097-4995-b80e-b3752e7d183d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7af77cf5-17e7-45a2-9949-c52a14ce6a57' class='xr-var-data-in' type='checkbox'><label for='data-7af77cf5-17e7-45a2-9949-c52a14ce6a57' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([-20. , -20.5, -21. , -21.5, -22. , -22.5, -23. , -23.5, -24. , -24.5,
       -25. , -25.5, -26. , -26.5, -27. , -27.5, -28. , -28.5, -29. , -29.5,
       -30. , -30.5, -31. , -31.5, -32. , -32.5, -33. , -33.5, -34. , -34.5,
       -35. , -35.5, -36. , -36.5, -37. , -37.5, -38. , -38.5, -39. , -39.5,
       -40. , -40.5, -41. , -41.5, -42. , -42.5, -43. , -43.5, -44. , -44.5,
       -45. , -45.5, -46. , -46.5, -47. , -47.5, -48. , -48.5, -49. , -49.5,
       -50. , -50.5, -51. , -51.5, -52. , -52.5, -53. , -53.5, -54. , -54.5,
       -55. , -55.5, -56. , -56.5, -57. , -57.5, -58. , -58.5, -59. , -59.5,
       -60. , -60.5, -61. , -61.5, -62. , -62.5, -63. , -63.5, -64. , -64.5,
       -65. , -65.5, -66. , -66.5, -67. , -67.5, -68. , -68.5, -69. , -69.5,
       -70. ], dtype=float32)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>n_clusters</span></div><div class='xr-var-dims'>(n_clusters)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 58 59 60 61 62 63</div><input id='attrs-ab515164-f738-495a-a241-480db64d0174' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ab515164-f738-495a-a241-480db64d0174' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5bc0685d-02c7-4b97-aff6-9a53f38f5887' class='xr-var-data-in' type='checkbox'><label for='data-5bc0685d-02c7-4b97-aff6-9a53f38f5887' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-51.98 -51.83 ... -31.34 -31.13</div><input id='attrs-f2f87bba-f9f9-4a37-8c53-1ff1ba6f49c3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f2f87bba-f9f9-4a37-8c53-1ff1ba6f49c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dcbbefa1-2607-42b3-ab35-960d55b83717' class='xr-var-data-in' type='checkbox'><label for='data-dcbbefa1-2607-42b3-ab35-960d55b83717' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([-51.981239, -51.830883, -51.680023, -51.52866 , -51.376789, -51.224415,
       -51.071533, -50.918144, -50.764252, -50.609848, -50.454937, -50.299515,
       -50.143585, -49.987144, -49.830196, -49.672733, -49.514763, -49.356277,
       -49.197281, -49.037769, -48.877747, -48.717209, -48.55616 , -48.394596,
       -48.232517, -48.069923, -47.906811, -47.743187, -47.579044, -47.414387,
       -47.249214, -47.083523, -46.917316, -46.750591, -46.583347, -46.415588,
       -46.247311, -46.078518, -45.909203, -45.739372, -45.569023, -45.398155,
       -45.226768, -45.054867, -44.882442, -44.709503, -44.536045, -44.362068,
       -44.187572, -44.012558, -43.837025, -43.660976, -43.484409, -43.307323,
       -43.129723, -42.951603, -42.772968, -42.593815, -42.414146, -42.233959,
       -42.053257, -41.87204 , -41.690308, -41.50806 , -41.325298, -41.142025,
       -40.958233, -40.773933, -40.589115, -40.40379 , -40.217949, -40.031601,
       -39.844738, -39.657368, -39.46949 , -39.281101, -39.092205, -38.902802,
       -38.712891, -38.522472, -38.331551, -38.140125, -37.948196, -37.755764,
       -37.562828, -37.369396, -37.175461, -36.981026, -36.786095, -36.590664,
       -36.394741, -36.198318, -36.001404, -35.803997, -35.606098, -35.407707,
       -35.208828, -35.00946 , -34.809605, -34.609264, -34.40844 , -34.20713 ,
       -34.005341, -33.803066, -33.600319, -33.397091, -33.193386, -32.989204,
       -32.784554, -32.579426, -32.373833, -32.167767, -31.961237, -31.75424 ,
       -31.54678 , -31.338856, -31.130472])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>161.0 161.3 161.5 ... 184.7 185.0</div><input id='attrs-f81ae14d-271e-4135-a6ab-06be1efeb0fd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f81ae14d-271e-4135-a6ab-06be1efeb0fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e095d263-672e-4f6b-9fae-1363c202a750' class='xr-var-data-in' type='checkbox'><label for='data-e095d263-672e-4f6b-9fae-1363c202a750' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([161.030228, 161.272034, 161.513855, 161.755661, 161.997482, 162.239288,
       162.48111 , 162.722916, 162.964737, 163.206543, 163.448364, 163.69017 ,
       163.931992, 164.173798, 164.415619, 164.657425, 164.899246, 165.141052,
       165.382874, 165.62468 , 165.866501, 166.108307, 166.350128, 166.591934,
       166.833755, 167.075562, 167.317383, 167.559189, 167.80101 , 168.042816,
       168.284637, 168.526443, 168.768265, 169.010071, 169.251892, 169.493698,
       169.735519, 169.977325, 170.219147, 170.460953, 170.702774, 170.94458 ,
       171.186401, 171.428207, 171.670029, 171.911835, 172.153656, 172.395462,
       172.637283, 172.879089, 173.120911, 173.362717, 173.604538, 173.846344,
       174.088165, 174.329971, 174.571793, 174.813599, 175.05542 , 175.297226,
       175.539047, 175.780853, 176.022675, 176.264481, 176.506302, 176.748108,
       176.989929, 177.231735, 177.473557, 177.715363, 177.957184, 178.19899 ,
       178.440811, 178.682617, 178.924438, 179.166245, 179.408066, 179.649872,
       179.891693, 180.133499, 180.37532 , 180.617126, 180.858948, 181.100754,
       181.342575, 181.584381, 181.826202, 182.068008, 182.30983 , 182.551636,
       182.793457, 183.035263, 183.277084, 183.51889 , 183.760712, 184.002518,
       184.244339, 184.486145, 184.727966, 184.969772])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>quantile</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.995</div><input id='attrs-dfdba82a-274b-45b6-8649-6bc200b5545d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dfdba82a-274b-45b6-8649-6bc200b5545d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-01dce24e-890b-4ee5-807c-c284f961bc0e' class='xr-var-data-in' type='checkbox'><label for='data-01dce24e-890b-4ee5-807c-c284f961bc0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array(0.995)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>train_time</span></div><div class='xr-var-dims'>(train_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1994-01-17 ... 2014-09-14</div><input id='attrs-7786f984-55af-416b-9a52-12da5c3778a2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7786f984-55af-416b-9a52-12da5c3778a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fc5327a-f5da-45c9-abb2-c001cdec7642' class='xr-var-data-in' type='checkbox'><label for='data-3fc5327a-f5da-45c9-abb2-c001cdec7642' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([&#x27;1994-01-17T00:00:00.000000000&#x27;, &#x27;1994-01-18T00:00:00.000000000&#x27;,
       &#x27;1994-01-19T00:00:00.000000000&#x27;, ..., &#x27;2014-09-12T00:00:00.000000000&#x27;,
       &#x27;2014-09-13T00:00:00.000000000&#x27;, &#x27;2014-09-14T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>test_time</span></div><div class='xr-var-dims'>(test_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2014-09-15 ... 2016-12-31</div><input id='attrs-51e6b7e4-453f-41aa-994e-e88cecc00aee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-51e6b7e4-453f-41aa-994e-e88cecc00aee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04855272-607d-4dc6-b467-9041bd1e4632' class='xr-var-data-in' type='checkbox'><label for='data-04855272-607d-4dc6-b467-9041bd1e4632' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([&#x27;2014-09-15T00:00:00.000000000&#x27;, &#x27;2014-09-16T00:00:00.000000000&#x27;,
       &#x27;2014-09-17T00:00:00.000000000&#x27;, ..., &#x27;2016-12-29T00:00:00.000000000&#x27;,
       &#x27;2016-12-30T00:00:00.000000000&#x27;, &#x27;2016-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></li></ul></div></li><li class='xr-section-item'><input id='section-46fe56d3-595f-40d2-9ab4-3daba7ef3574' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46fe56d3-595f-40d2-9ab4-3daba7ef3574' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>bmus</span></div><div class='xr-var-dims'>(train_time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>21 15 51 5 5 5 ... 15 48 52 52 52</div><input id='attrs-7a6af268-ec37-4a0f-bc98-d1cf1497b9b2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7a6af268-ec37-4a0f-bc98-d1cf1497b9b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83b2669f-fd91-42d4-8127-a4aa50da713e' class='xr-var-data-in' type='checkbox'><label for='data-83b2669f-fd91-42d4-8127-a4aa50da713e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([21, 15, 51, ..., 52, 52, 52], dtype=int32)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>bmus_pred</span></div><div class='xr-var-dims'>(test_time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>52 49 49 52 19 19 ... 38 25 6 56 56</div><input id='attrs-8acc084d-0adb-4b2e-b20d-0a54e076f578' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8acc084d-0adb-4b2e-b20d-0a54e076f578' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af5a05fa-7138-4ac3-ab74-3c086c247539' class='xr-var-data-in' type='checkbox'><label for='data-af5a05fa-7138-4ac3-ab74-3c086c247539' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([52, 49, 49, 52, 19, 19, 19, 28, 42, 57, 21, 38, 52,  7, 24, 44, 28,
       28, 32, 32, 32, 22, 15, 28, 21,  7, 14, 27,  9,  9,  9, 40,  0, 53,
        9, 26, 26,  4, 18,  4,  9, 27, 47, 47, 47, 22, 15, 54, 22, 52, 50,
       50, 50, 21, 12, 12, 51, 19, 19, 22, 22, 22, 22, 22, 32, 22, 27, 27,
       27, 27, 27, 22, 38, 38, 38, 38,  6, 25, 30,  3,  3,  3,  3, 40, 40,
       40,  6, 14,  6, 25,  5,  5, 56, 56, 30,  8,  8, 30, 30, 30, 30, 30,
       30, 30, 30, 35,  5,  7, 12, 37, 48, 37, 37, 37, 30,  7,  5, 14, 51,
        6, 25, 29, 56, 56, 22, 56,  8, 13, 13,  5,  5, 29, 29, 14, 29, 29,
       58, 31, 29,  5, 51, 51, 38, 38, 18, 18, 12, 37, 37, 37, 13, 20,  3,
       13, 30, 37, 13, 13, 30,  3, 13, 13, 14, 14, 14, 14, 29, 29,  5,  5,
        5, 56, 56, 56, 21, 21,  7,  5,  5, 61, 61, 43, 55,  1, 20, 35,  7,
       37, 45,  5, 12,  9, 40, 52,  7, 36, 17, 53, 48,  0,  9, 37, 40, 54,
       40, 40, 40, 18, 38, 38, 55, 62, 63,  4, 53, 48,  0,  0,  0,  0,  0,
       48, 54, 41, 19, 18, 62, 26, 26, 16,  0, 35, 54, 15, 47, 47, 47, 47,
       47, 34, 22, 59, 17, 17, 26, 26, 36,  4, 18, 18, 19, 62, 62, 63, 63,
       24, 24, 15, 54, 59, 59, 19, 19,  4,  2,  2, 15,  2,  4,  2, 42, 62,
       62, 62, 16, 40, 40,  4, 62, 63, 53, 44, 63, 63,  2,  2,  2,  2, 42,
       24, 32, 28, 32, 19,  1, 62, 20, 63, 36,  3, 31, 31, 49, 40,  9, 41,
       19, 63, 63, 53, 53, 53, 48, 48, 54, 52, 17, 63, 24, 24, 36, 36, 24,
       57, 54, 23, 19, 52, 14, 49, 49, 49, 49, 59, 63, 24, 54,  9, 17, 16,
       53, 48,  0, 53, 26, 53,  0,  0, 33, 25, 33, 40, 22, 52, 19, 42, 62,
       57,  4,  9, 17, 63, 17, 63,  9,  9, 24,  4, 36, 46, 20, 44,  3, 59,
       59, 46, 46,  0,  0, 53, 53,  2,  2, 32, 32,  2, 57, 26, 26, 26,  2,
       42,  4,  4,  4,  2,  4, 53, 42,  4, 32, 42, 42,  4,  4, 12,  9,  9,
       42, 18, 18,  4,  9,  9, 42,  9,  9, 27, 14,  7,  9, 18, 37, 44, 44,
       27, 21, 38, 38, 27, 54, 22, 28, 15, 15, 15, 15, 54,  9, 27, 48, 35,
       48, 48,  4,  4, 18, 18, 18, 27, 21, 21, 56,  8, 21,  8,  8,  6, 14,
       14, 27, 21, 12, 42,  6,  6, 21,  7,  3, 20,  6,  5, 13, 13,  6, 39,
       39, 13,  5, 51, 32, 42, 61, 61, 25, 27, 12, 12, 37,  6, 30, 21, 12,
        9,  5, 45, 45, 45, 13, 29,  3, 25, 25, 27, 27,  5,  5, 51,  6,  6,
        6, 51, 51,  6, 30,  5, 61, 39, 39, 29, 56, 56, 51, 12, 37, 61, 61,
       61,  5, 12, 12, 38, 42, 37, 37, 37, 53, 12, 37,  4,  4,  4, 20,  0,
        0,  0,  3, 46, 13,  7, 54,  3, 13,  3,  3, 14, 12, 36, 12, 14, 37,
       30,  3,  7, 35, 36,  4, 21, 12, 12, 36, 12, 24, 15,  4, 17, 17, 16,
        7, 12, 12, 37, 37, 50, 50, 50, 52, 42, 62, 63,  2, 26, 16, 50, 35,
       15, 35, 24, 48, 48, 30, 40, 54, 47, 34, 34, 32, 32, 22, 52, 57,  1,
       47, 59, 55, 11, 23, 23,  1,  1, 23, 23, 19, 62, 62, 26, 26, 26, 10,
       10, 31, 33, 54, 54, 22, 28,  2,  2,  2,  2,  4, 50,  4,  9, 31, 31,
       47, 47, 23, 23, 22, 28, 17, 52, 36, 24, 24,  4,  4,  4, 41, 41, 46,
       44, 44, 35, 47, 15, 34, 28, 63, 63, 24, 28, 18, 15, 34, 34, 34, 47,
       15, 47, 34, 28, 19,  1,  1,  1, 58, 55, 59, 55, 62, 62, 50, 35, 24,
       24, 24, 24, 24, 53, 46, 44, 35, 35, 57, 33, 33, 33, 49, 28, 28,  9,
       42,  9, 57,  4, 40, 36, 24, 17,  4, 63, 36, 44,  9,  9,  9,  9,  9,
        9, 40, 52, 14,  7,  3,  3, 58,  3, 29, 29, 29,  8, 29, 29, 31, 49,
       56, 47, 47, 47, 47, 28, 18, 15, 15, 51, 22, 18, 28, 32, 27, 54, 54,
       24, 48, 48,  3,  3, 40, 36, 27, 52, 21, 21, 35, 36, 49, 49,  8, 47,
       47, 47, 47, 21, 27, 56,  1,  1, 31,  1,  1, 19, 28, 28, 51, 42, 57,
       27, 25, 31, 22, 32, 38, 38, 38, 25,  8, 21, 21, 21, 21, 27, 27, 56,
       22, 52, 63, 21, 21, 15, 51, 27, 54, 51, 27,  5, 21,  6,  6,  8, 30,
       27, 38, 25,  6, 56, 56], dtype=int32)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>cluster_centers</span></div><div class='xr-var-dims'>(n_clusters, n_components)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>16.16 -93.46 ... 0.05609 0.7162</div><input id='attrs-2867f940-2eae-49a8-81e8-b60f5fb1dcdb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2867f940-2eae-49a8-81e8-b60f5fb1dcdb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f5bbc5a6-b5fc-4616-b391-f6f5bce7c79c' class='xr-var-data-in' type='checkbox'><label for='data-f5bbc5a6-b5fc-4616-b391-f6f5bce7c79c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[ 1.61569715e+01, -9.34643719e+01, -2.20864324e+01, ...,
        -9.13784890e-02, -6.32673394e-01,  6.50343012e-01],
       [-5.79857216e+01,  5.61316070e+01,  4.57685921e+01, ...,
         2.70601250e-01, -9.47995396e-01,  1.01020938e+00],
       [ 1.21845941e+02,  1.82815669e+01, -2.22469265e+01, ...,
        -5.71567110e-01, -5.50534542e-01,  3.73281556e-01],
       ...,
       [-3.77164782e+01, -2.44762279e+01, -1.82318718e+01, ...,
         1.88063164e+00, -7.84234344e-01, -6.60448188e-01],
       [ 1.88989095e+01, -2.41102074e+01,  8.32747687e+01, ...,
        -4.80505502e-02, -3.53557459e-01, -3.37743597e-01],
       [ 3.69548186e+01, -5.84466530e+00,  3.59788866e+01, ...,
        -6.41328645e-02,  5.60874870e-02,  7.16192859e-01]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>slp_clusters</span></div><div class='xr-var-dims'>(n_clusters, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.014e+05 1.014e+05 ... 9.86e+04</div><input id='attrs-8aaff41d-799e-4aae-ac4e-a6c13d2eb30e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8aaff41d-799e-4aae-ac4e-a6c13d2eb30e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-206588c0-439f-4506-af84-636c2b28dcdd' class='xr-var-data-in' type='checkbox'><label for='data-206588c0-439f-4506-af84-636c2b28dcdd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[[101417.79775124, 101407.67104994, 101399.3402614 , ...,
         101415.95635359, 101413.30918133, 101409.98243211],
        [101444.66999967, 101437.43642517, 101430.50128775, ...,
         101448.52851685, 101445.94300519, 101442.86047235],
        [101466.8459488 , 101462.19075111, 101456.77652278, ...,
         101480.51112708, 101478.08847001, 101475.39013365],
        ...,
        [ 99847.19862299,  99800.99996724,  99749.38016534, ...,
          97628.52334332,  97621.67181768,  97614.95062934],
        [100178.39098328, 100130.43717857, 100076.64361611, ...,
          97595.29418894,  97587.4636297 ,  97579.76037982],
        [100473.92443208, 100426.82445828, 100373.79986201, ...,
          97564.20800781,  97555.03444993,  97545.96574661]],

       [[101155.9824076 , 101147.12073682, 101139.87503712, ...,
         101382.99268435, 101384.93360232, 101386.34086886],
        [101170.39475969, 101163.81587514, 101157.4292135 , ...,
         101405.76928568, 101407.85798154, 101409.64968247],
        [101179.55991297, 101175.0163303 , 101169.56930453, ...,
         101426.86172503, 101429.28407975, 101431.65837445],
        ...,
        [101385.10171384, 101345.37119084, 101300.90528771, ...,
          99137.95669431,  99129.61173074,  99121.48977179],
        [101637.23657369, 101596.65909688, 101551.13463142, ...,
          99133.21269074,  99124.53314316,  99116.07014974],
        [101853.20498961, 101813.81895902, 101769.58614309, ...,
          99129.27931686,  99119.99755574,  99110.91176387]],

       [[101806.82875744, 101796.23142981, 101786.55791171, ...,
         101634.24077691, 101629.44597284, 101624.01654886],
        [101848.76212488, 101841.53055866, 101833.75737227, ...,
         101671.3890594 , 101666.65391245, 101661.46136533],
        [101885.98138331, 101881.74456535, 101875.97437376, ...,
         101707.46382068, 101702.99974268, 101698.27160528],
        ...,
        [ 99470.33777592,  99408.82751426,  99341.30269097, ...,
          97343.26428881,  97348.47489149,  97353.95716146],
        [ 99848.16037636,  99784.84794147,  99714.85661582, ...,
          97362.30845424,  97365.82697173,  97369.63378286],
        [100175.30330171, 100113.03335813, 100043.83735739, ...,
          97385.25120598,  97386.64618056,  97388.32931858]],

       ...,

       [[100743.82236665, 100738.31590113, 100736.52664781, ...,
         101091.29749237, 101101.89850485, 101111.04800871],
        [100757.98104122, 100755.4375    , 100755.10988012, ...,
         101101.02114763, 101111.54421471, 101120.82302892],
        [100768.67612922, 100768.90121004, 100770.22906564, ...,
         101111.17468121, 101121.59243669, 101131.00058369],
        ...,
        [ 99752.80088227,  99712.32283809,  99667.80704472, ...,
          98339.02910605,  98340.78200207,  98342.80517017],
        [100015.66448904,  99974.01069729,  99928.06097342, ...,
          98291.87657148,  98293.55137617,  98295.47374506],
        [100249.32958423, 100208.23612608, 100162.86644666, ...,
          98255.22574309,  98256.44726563,  98257.84830729]],

       [[101668.10822405, 101655.96266974, 101645.20699405, ...,
         101430.51888253, 101430.82187035, 101430.73349144],
        [101706.30158343, 101697.50070685, 101688.90121838, ...,
         101447.37020787, 101447.81590169, 101448.04845145],
        [101740.42459542, 101734.57562546, 101728.10381324, ...,
         101461.70960519, 101462.52401414, 101463.3168271 ],
        ...,
        [101429.04625186, 101391.18414016, 101347.1886463 , ...,
          98370.15785203,  98356.94333147,  98344.68546084],
        [101761.66002837, 101721.28529576, 101674.50961682, ...,
          98412.17423503,  98398.75167411,  98386.21783854],
        [102055.52142392, 102014.73376814, 101967.6414295 , ...,
          98455.50717308,  98441.60279018,  98428.49089007]],

       [[101783.5554908 , 101773.25461242, 101764.18002615, ...,
         101425.21952705, 101422.21579669, 101419.15290029],
        [101822.80134041, 101816.09273669, 101809.31652701, ...,
         101441.57529507, 101438.51825279, 101435.63673975],
        [101858.24150496, 101854.83224651, 101850.46841398, ...,
         101455.32219212, 101452.42487819, 101449.97554919],
        ...,
        [100363.2550587 , 100324.72002846, 100280.01582714, ...,
          98665.8507697 ,  98665.68757088,  98665.72475901],
        [100750.71860824, 100708.68883884, 100660.09010889, ...,
          98632.00672043,  98630.67440304,  98629.58544922],
        [101090.16823127, 101046.82514806, 100996.90575647, ...,
          98602.35777365,  98599.49927808,  98596.89500116]]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>ss_clusters_mean</span></div><div class='xr-var-dims'>(n_clusters, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.05950955 ... 0.053620696</div><input id='attrs-7f913649-ef62-45de-a6b8-11a0d9c72740' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7f913649-ef62-45de-a6b8-11a0d9c72740' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a652d6ee-9082-40bb-8b17-a0c311d422b9' class='xr-var-data-in' type='checkbox'><label for='data-a652d6ee-9082-40bb-8b17-a0c311d422b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[[-0.05950955, -0.06014652, -0.05931846, ..., -0.05188535,
         -0.05193631, -0.05221019],
        [-0.06090446, -0.06063695, -0.05902548, ..., -0.05323566,
         -0.05310191, -0.05305735],
        [-0.06168153, -0.06157324, -0.06020383, ..., -0.05512103,
         -0.05492993, -0.0548344 ],
        ...,
        [-0.00803822, -0.00564968, -0.00433758, ..., -0.02112739,
         -0.02170064, -0.02276433],
        [-0.00910828, -0.00631847, -0.00484713, ..., -0.02104458,
         -0.02178344, -0.02235032],
        [-0.00796178, -0.00629936, -0.0052293 , ..., -0.02096816,
         -0.02090446, -0.02085988]],

       [[ 0.05881905,  0.05943809,  0.05931428, ...,  0.11112382,
          0.10956194,  0.10870476],
        [ 0.05953334,  0.0599143 ,  0.05997143, ...,  0.11337144,
          0.11175238,  0.11118095],
        [ 0.06017143,  0.06091429,  0.06177145, ...,  0.11566669,
          0.11354286,  0.11300955],
        ...,
        [ 0.03086666,  0.0313524 ,  0.03045715, ...,  0.01806667,
          0.01880952,  0.0200381 ],
        [ 0.03141905,  0.03224762,  0.03130477, ...,  0.01742857,
          0.01849524,  0.01960953],
        [ 0.03079047,  0.03064763,  0.02929524, ...,  0.01776191,
          0.01800952,  0.01806667]],

       [[ 0.14031523,  0.13861954,  0.13823913, ...,  0.08379348,
          0.08057608,  0.07888045],
        [ 0.13859782,  0.13680436,  0.1367391 , ...,  0.08377174,
          0.08167392,  0.07998912],
        [ 0.13573913,  0.13531522,  0.13577177, ...,  0.083     ,
          0.08221738,  0.08118479],
        ...,
        [-0.0231413 , -0.02254348, -0.02316304, ..., -0.00441304,
         -0.003     , -0.0018587 ],
        [-0.01927174, -0.01857608, -0.01859782, ..., -0.00561957,
         -0.00447826, -0.00308696],
        [-0.018     , -0.01666304, -0.01660869, ..., -0.00569565,
         -0.00573913, -0.00443478]],

       ...,

       [[ 0.04188001,  0.0412    ,  0.03912   , ...,  0.04412001,
          0.03816   ,  0.03444   ],
        [ 0.04168   ,  0.04148   ,  0.03792   , ...,  0.04096   ,
          0.03476   ,  0.03128   ],
        [ 0.04092   ,  0.0394    ,  0.0352    , ...,  0.0394    ,
          0.03688   ,  0.03564001],
        ...,
        [ 0.00696   ,  0.0082    ,  0.01548   , ..., -0.01236   ,
         -0.01292   , -0.014     ],
        [ 0.01208   ,  0.01348   ,  0.01888   , ..., -0.01184   ,
         -0.01184   , -0.01316   ],
        [ 0.0182    ,  0.01808   ,  0.02152   , ..., -0.01216   ,
         -0.01156   , -0.01232   ]],

       [[-0.01909775, -0.01776692, -0.01590226, ...,  0.14410533,
          0.14410532,  0.14557146],
        [-0.0201579 , -0.01793233, -0.01542857, ...,  0.14603005,
          0.14593235,  0.14662404],
        [-0.02006767, -0.01779699, -0.01476692, ...,  0.1468797 ,
          0.14752635,  0.14767669],
        ...,
        [-0.01216541, -0.01323309, -0.01409775, ...,  0.04690978,
          0.04680453,  0.04723308],
        [-0.01155639, -0.01250376, -0.0123985 , ...,  0.04637595,
          0.04628571,  0.04685714],
        [-0.01041353, -0.01067669, -0.00992481, ...,  0.04540602,
          0.04534587,  0.04590978]],

       [[ 0.01603448,  0.01748277,  0.01832759, ...,  0.06402586,
          0.06464656,  0.06518103],
        [ 0.0145    ,  0.01550862,  0.01588793, ...,  0.06578448,
          0.06577586,  0.06604309],
        [ 0.01367241,  0.01503448,  0.01475   , ...,  0.06771551,
          0.06736208,  0.06693966],
        ...,
        [-0.02634482, -0.02637931, -0.02618966, ...,  0.04989656,
          0.05155172,  0.05359483],
        [-0.02763793, -0.02875   , -0.02890518, ...,  0.05056898,
          0.0522069 ,  0.05406035],
        [-0.02882759, -0.0297069 , -0.02921552, ...,  0.05076724,
          0.05198276,  0.0536207 ]]], dtype=float32)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>ss_clusters_max</span></div><div class='xr-var-dims'>(n_clusters, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.1314 0.127 ... 0.1771 0.1835</div><input id='attrs-4c56137c-8986-4f90-a51a-dd6690113eb9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4c56137c-8986-4f90-a51a-dd6690113eb9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd06c606-aadf-4cb8-87b7-aa2d16238d57' class='xr-var-data-in' type='checkbox'><label for='data-fd06c606-aadf-4cb8-87b7-aa2d16238d57' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[[0.13144001, 0.127     , 0.11976001, ..., 0.11222   ,
         0.13766001, 0.13888001],
        [0.11986001, 0.11564   , 0.11544   , ..., 0.11122001,
         0.13344   , 0.13466   ],
        [0.10838001, 0.10394   , 0.09918001, ..., 0.10392   ,
         0.11486   , 0.11166001],
        ...,
        [0.07606   , 0.07742   , 0.07600001, ..., 0.12314   ,
         0.11670001, 0.1128    ],
        [0.06888   , 0.07300001, 0.08744   , ..., 0.11336001,
         0.10904001, 0.10726   ],
        [0.0652    , 0.08522   , 0.10144   , ..., 0.11526   ,
         0.11372   , 0.11294   ]],

       [[0.24848001, 0.23812001, 0.22640001, ..., 0.26260001,
         0.25736002, 0.24632   ],
        [0.24580001, 0.23392001, 0.22636001, ..., 0.27076001,
         0.27196001, 0.26688001],
        [0.24176001, 0.23660001, 0.23628001, ..., 0.25688001,
         0.26584002, 0.26924002],
        ...,
        [0.14792001, 0.13748001, 0.13984001, ..., 0.11416   ,
         0.11176001, 0.112     ],
        [0.15740001, 0.15696001, 0.15536   , ..., 0.10832   ,
         0.10844001, 0.109     ],
        [0.14936001, 0.15656001, 0.16188   , ..., 0.1088    ,
         0.11076001, 0.10728001]],

       [[0.31063   , 0.30626001, 0.31017002, ..., 0.27908001,
         0.2749    , 0.27089502],
        [0.31108501, 0.30880502, 0.31335002, ..., 0.27943502,
         0.27416501, 0.26998001],
        [0.31044502, 0.31198501, 0.31698502, ..., 0.28270501,
         0.27507   , 0.26988501],
        ...,
        [0.077995  , 0.08745001, 0.08916501, ..., 0.099725  ,
         0.09718001, 0.1       ],
        [0.075815  , 0.08718   , 0.096445  , ..., 0.099815  ,
         0.10254501, 0.101545  ],
        [0.09217501, 0.09527001, 0.09409   , ..., 0.103725  ,
         0.102635  , 0.10063501]],

       ...,

       [[0.29992003, 0.30692003, 0.30004003, ..., 0.26636002,
         0.27432002, 0.28196   ],
        [0.2928    , 0.30468002, 0.29880001, ..., 0.28984002,
         0.30812001, 0.31864002],
        [0.28956001, 0.29956003, 0.29356002, ..., 0.31152   ,
         0.35532002, 0.37824001],
        ...,
        [0.13408001, 0.112     , 0.09568   , ..., 0.08720001,
         0.08108   , 0.07984   ],
        [0.12364   , 0.10268   , 0.09164001, ..., 0.0842    ,
         0.07968001, 0.0812    ],
        [0.11064001, 0.0928    , 0.09352   , ..., 0.08212001,
         0.07932001, 0.0812    ]],

       [[0.17446001, 0.17484001, 0.17688001, ..., 0.32380001,
         0.32212002, 0.32280002],
        [0.17472001, 0.1751    , 0.17288   , ..., 0.31844002,
         0.32004001, 0.31940001],
        [0.17734   , 0.17738001, 0.17782   , ..., 0.31408001,
         0.31938   , 0.32338001],
        ...,
        [0.12262   , 0.12016   , 0.11538001, ..., 0.18848001,
         0.18984001, 0.19190001],
        [0.12622   , 0.11482001, 0.11146   , ..., 0.18032001,
         0.17828001, 0.18400001],
        [0.12806   , 0.12078   , 0.11494   , ..., 0.18206001,
         0.17800001, 0.18272001]],

       [[0.22720001, 0.23012501, 0.22727501, ..., 0.261675  ,
         0.25040002, 0.24727501],
        [0.21920001, 0.21885001, 0.21225001, ..., 0.26185001,
         0.25312501, 0.25212501],
        [0.20550001, 0.20570001, 0.19837501, ..., 0.27352501,
         0.261675  , 0.25912501],
        ...,
        [0.08467501, 0.07412501, 0.062125  , ..., 0.17845001,
         0.18015001, 0.18512501],
        [0.08412501, 0.0672    , 0.043425  , ..., 0.18055001,
         0.18015001, 0.18540001],
        [0.083575  , 0.06705   , 0.0455    , ..., 0.18422501,
         0.17710001, 0.18350001]]])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-23b00453-d4bd-4ac4-90b4-d39e9bcb9581' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-23b00453-d4bd-4ac4-90b4-d39e9bcb9581' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">sscode.statistical</span> <span class="kn">import</span> <span class="n">gev_matrix</span>

<span class="n">gev_matrix</span><span class="p">(</span>
    <span class="n">load_moana_hindcast_ss</span><span class="p">(</span><span class="n">daily</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
        <span class="n">time</span><span class="o">=</span><span class="n">kms_data</span><span class="o">.</span><span class="n">train_time</span><span class="p">[</span><span class="n">kms_data</span><span class="o">.</span><span class="n">bmus</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">),</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span>
<span class="p">)</span> <span class="c1"># TODO: implement gev analysis over the clusters</span>

</pre></div>
</div>
</div>
<div class="section" id="calculate-prediction-errors">
<h2><span class="section-number">4.2. </span>calculate prediction errors<a class="headerlink" href="#calculate-prediction-errors" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">load_moana_hindcast_ss</span><span class="p">(</span><span class="n">daily</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">kms_data</span><span class="o">.</span><span class="n">test_time</span><span class="p">)</span> <span class="o">-</span> \
    <span class="n">kms_data</span><span class="o">.</span><span class="n">ss_clusters_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">kms_data</span><span class="o">.</span><span class="n">bmus_pred</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">col</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> loading the Moana v2 hindcast data (ss)... 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.plot.facetgrid.FacetGrid at 0x7f908078bd68&gt;
</pre></div>
</div>
<img alt="../_images/analysis_kma_9_2.png" src="../_images/analysis_kma_9_2.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="analysis_cca.html" title="previous page"><span class="section-number">3. </span>CCA ANALYSIS</a>
    <a class='right-next' id="next-link" href="models_linear.html" title="next page"><span class="section-number">5. </span>LINEAR REGRESSION</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Javier Tausía Hoyal<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>