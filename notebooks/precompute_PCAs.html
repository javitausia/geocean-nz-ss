
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;no title&gt; &#8212; Storm Surge NZ - Summary</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Storm Surge NZ - Summary</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   geoocean-nz-ss
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data_visualization.html">
   1. Data visualization and validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="more_validations.html">
   2. LINZ and OTHER data analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="repo_workflow_theory.html">
   3. Repository workflow + THEORY
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="analysis_pca.html">
   4. PC analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="models_linear.html">
   5. MultiLinear regression models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="models_knn.html">
   6. KNN regressor models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="models_xgboost.html">
   7. XGBoost regression models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="models_mda_rbf.html">
   8. MDA - RBF model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="experiments.html">
   9. RUN experiments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="models_results.html">
   10. VISUALIZE experiments results
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/precompute_PCAs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/javitausia/geocean-nz-ss"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/javitausia/geocean-nz-ss/issues/new?title=Issue%20on%20page%20%2Fnotebooks/precompute_PCAs.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/javitausia/geocean-nz-ss/master?urlpath=tree/notebooks/precompute_PCAs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># basics</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>

<span class="c1"># arrays</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># append sscode to path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/home/metocean/geocean-nz-ss&#39;</span><span class="p">)</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;/data&#39;</span> <span class="c1">#&#39;/data/storm_surge_data/&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SSURGE_DATA_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_path</span>

<span class="c1"># custom</span>
<span class="kn">from</span> <span class="nn">sscode.config</span> <span class="kn">import</span> <span class="n">default_location</span><span class="p">,</span> \
    <span class="n">default_region</span><span class="p">,</span> <span class="n">default_region_reduced</span>
<span class="kn">from</span> <span class="nn">sscode.data</span> <span class="kn">import</span> <span class="n">Loader</span>
<span class="kn">from</span> <span class="nn">sscode.pca_new</span> <span class="kn">import</span> <span class="n">PCA_DynamicPred</span>

<span class="c1"># warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># for autocomplete code</span>
<span class="o">%</span><span class="k">config</span> Completer.use_jedi = False

<span class="kn">import</span> <span class="nn">gc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATA PATH /data
/data (173.9, -40.5) (140, 190, -70, -20) (160, 185, -52, -30)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the data</span>
<span class="n">load_cfsr_moana_uhslc</span> <span class="o">=</span> <span class="n">Loader</span><span class="p">(</span>
    <span class="n">data_to_load</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cfsr&#39;</span><span class="p">,</span><span class="s1">&#39;moana&#39;</span><span class="p">,</span><span class="s1">&#39;uhslc&#39;</span><span class="p">],</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
    <span class="n">time_resample</span><span class="o">=</span><span class="s1">&#39;6H&#39;</span><span class="p">,</span> <span class="n">load_winds</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> loading the sea-level-pressure fields... 


 resampling data to 6H... 


 loading and calculating the winds... 


 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 -1.25 -1.408 ... -10.53
    vgrd10m         (time, latitude, longitude) float32 -8.33 -8.559 ... 10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 
</pre></div>
</div>
<img alt="../_images/precompute_PCAs_1_1.png" src="../_images/precompute_PCAs_1_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> loading the Moana v2 hindcast data... 


 loading and plotting the UHSLC tidal guages... 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PCA_PreComputer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class Experiment summarizes all the previous work done with the linear and the</span>
<span class="sd">    knn models, as this class allows the user to perform a detailed analysis of one</span>
<span class="sd">    requested model given a set of parameters</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slp_data</span><span class="p">,</span>
                 <span class="n">wind_data</span><span class="p">,</span>
                 <span class="n">ss_data</span><span class="p">,</span> <span class="c1"># this must have several stations</span>
                 <span class="n">sites_to_analyze</span><span class="p">,</span>
                 <span class="c1"># these are the metrics to evaluate the model</span>
                 <span class="n">pca_attrs</span><span class="p">,</span>
                 <span class="n">pcs_folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        As the initializator, the __init__ function creates the instance of the class,</span>
<span class="sd">        given a set of parameters, which are described below</span>

<span class="sd">        Args:</span>
<span class="sd">            slp_data (xarray.Dataset): These are the sea-level-pressure fields, previously</span>
<span class="sd">                loaded with the Loader class, loader.predictor_slp!!</span>
<span class="sd">            wind_data (xarray.Dataset): These are the wind fields, previously</span>
<span class="sd">                loaded with the Loader class, loader.predictor_wind!!</span>
<span class="sd">            ss_data (xarray.Dataset): This is the storm surge from the moana hindcast, previously</span>
<span class="sd">                loaded with the Loader class, loader.predictand!!</span>
<span class="sd">            sites_to_analyze (list, optional): This is the list with all the moana v2</span>
<span class="sd">                hindcast locations to analyze. Defaults to random locations.</span>
<span class="sd">            pca_attrs (dict, optional): PCA dictionary with all the parameters to use in pca.</span>
<span class="sd">                Defaults to pca_attrs_default.</span>
<span class="sd">            pca_folder (string, optionl): The folder from/in which the PCs should be loaded/saved.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># lets build the experiment!! + with CFSR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor_data</span> <span class="o">=</span> <span class="s1">&#39;cfsr&#39;</span>

        <span class="c1"># save class simplest attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slp_data</span> <span class="o">=</span> <span class="n">slp_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wind_data</span> <span class="o">=</span> <span class="n">wind_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss_data</span> <span class="o">=</span> <span class="n">ss_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss_sites</span> <span class="o">=</span> <span class="n">sites_to_analyze</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span> <span class="o">=</span> <span class="n">pca_attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcs_folder</span> <span class="o">=</span> <span class="n">pcs_folder</span>
    

    <span class="k">def</span> <span class="nf">compute_pcas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function goes over all the sites/configurations and computes</span>
<span class="sd">        and stores the results of the PCA analysis if not already available.</span>

<span class="sd">        Args:</span>
<span class="sd">            </span>

<span class="sd">        Returns:</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>

        

        <span class="k">for</span> <span class="n">isite</span><span class="p">,</span><span class="n">site</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ss_sites</span><span class="p">):</span>

            <span class="c1"># we first load in memmory the selected site</span>
            <span class="n">ss_site</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">site</span><span class="p">)[[</span>
                <span class="s1">&#39;ss&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span>
            <span class="p">]]</span><span class="o">.</span><span class="n">load</span><span class="p">()</span> <span class="c1"># load the ss and the location of the site</span>
            <span class="n">site_location</span> <span class="o">=</span> <span class="p">(</span><span class="n">ss_site</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">ss_site</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

            <span class="c1"># lets iterate over all the pca_attrs + model_attrs</span>
            
                <span class="c1"># loop over all the combinations for the linear model</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i_parameters</span><span class="p">,</span><span class="n">parameters</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">icg</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">itl</span><span class="p">,</span><span class="n">itr</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> \
                    <span class="k">for</span> <span class="n">icg</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]))]</span> \
                    <span class="k">for</span> <span class="n">iw</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">1</span><span class="p">]))]</span> \
                    <span class="k">for</span> <span class="n">itl</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">2</span><span class="p">]))]</span> \
                    <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">3</span><span class="p">]))]</span> \
                    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">4</span><span class="p">]))]]</span>
                <span class="p">,</span> <span class="p">[(</span><span class="n">cg</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">tl</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> \
                    <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> \
                    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span> \
                    <span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">2</span><span class="p">]</span> \
                    <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">3</span><span class="p">]</span> \
                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">4</span><span class="p">]]</span>
            <span class="p">):</span>  
                

                <span class="c1"># Some info</span>
                <span class="nb">print</span><span class="p">(</span>
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> --------------------------------------------------------- </span><span class="se">\</span>
<span class="s1">                        </span><span class="se">\n\n</span><span class="s1"> Experiment </span><span class="si">{}</span><span class="s1"> in site </span><span class="si">{}</span><span class="s1">, coords = </span><span class="si">{}</span><span class="s1"> ...... </span><span class="se">\</span>
<span class="s1">                        </span><span class="se">\n\n</span><span class="s1"> pca_params = </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n\n</span><span class="s1"> </span><span class="se">\</span>
<span class="s1">                        </span><span class="se">\n\n</span><span class="s1"> and iteration with indexes = </span><span class="si">{}</span><span class="s1"> </span><span class="se">\</span>
<span class="s1">                        </span><span class="se">\n\n</span><span class="s1"> ---------------------------------------------------------&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">counter</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># this is just the counter</span>
                            <span class="n">site</span><span class="p">,</span> <span class="c1"># site to analyze in this loop</span>
                            <span class="n">site_location</span><span class="p">,</span> <span class="c1"># site coordinates</span>
                            <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="n">parameters</span><span class="p">[:</span><span class="mi">5</span><span class="p">])),</span>
                            <span class="n">i_parameters</span> <span class="c1"># this are the parameters indexes</span>
                        <span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span>
                <span class="p">)</span>

                <span class="c1"># perform the experiment</span>
                <span class="n">dict_to_pca</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">parameters</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
                <span class="n">trash</span> <span class="o">=</span> <span class="n">dict_to_pca</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;winds&#39;</span><span class="p">)</span>
                
                <span class="c1"># change region parameter if local area is required</span>
                <span class="k">if</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;local&#39;</span><span class="p">:</span>
                    <span class="n">local_region</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="p">(</span><span class="n">site_location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="c1"># new lon / lat region</span>
                                     <span class="n">site_location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">site_location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                     <span class="n">site_location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                                    <span class="p">))</span>
                    <span class="n">dict_to_pca</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">local_region</span>

                <span class="n">pca_data</span><span class="p">,</span> <span class="n">pca_scaler</span> <span class="o">=</span> <span class="n">PCA_DynamicPred</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">slp_data</span><span class="p">,</span>
                        <span class="n">pres_vars</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SLP&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="s1">&#39;latitude&#39;</span><span class="p">),</span>
                        <span class="n">wind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wind_data</span> <span class="k">if</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">wind_vars</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;wind_proj_mask&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;ugrd10m&#39;</span><span class="p">,</span><span class="s1">&#39;vgrd10m&#39;</span><span class="p">),</span>
                        <span class="n">pca_plot</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">pcs_folder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcs_folder</span><span class="p">,</span>
                        <span class="n">site_id</span><span class="o">=</span><span class="n">site</span><span class="p">,</span>
                        <span class="n">site_location</span><span class="o">=</span><span class="n">site_location</span><span class="p">,</span>
                        <span class="n">pca_percent</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                        <span class="n">pca_method</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">dict_to_pca</span> <span class="c1"># extra arguments without the winds</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">pcs_get</span><span class="p">()</span>
                    
                
                <span class="c1"># This seems necessary to keep memory under control    </span>
                <span class="k">del</span> <span class="n">pca_data</span>
                <span class="k">del</span> <span class="n">pca_scaler</span>
                <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca_attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;calculate_gradient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">],</span>
    <span class="s1">&#39;winds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">],</span>
    <span class="s1">&#39;time_lapse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="c1">#2,3], # 1 equals to NO time delay </span>
    <span class="s1">&#39;time_resample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;12H&#39;</span><span class="p">],</span> <span class="c1"># 1D and 12H, 6H available...</span>
    <span class="c1">#&#39;region&#39;: [(&#39;local&#39;,(1.5,1.5))]#,(&#39;local&#39;,(2.5,2.5)),(True,default_region_reduced)]</span>
    <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;local&#39;</span><span class="p">,(</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))]</span><span class="c1"># ,(True,default_region_reduced)]</span>
    <span class="c1">#&#39;region&#39;: [(True,default_region_reduced)]</span>
<span class="p">}</span>

<span class="n">sites_to_analyze</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span> <span class="c1"># closest Moana v2 Hindcast to tidal gauges</span>
    <span class="p">[</span>  <span class="mi">689</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">393</span><span class="p">,</span><span class="mi">1327</span><span class="p">,</span><span class="mi">393</span><span class="p">,</span><span class="mi">480</span><span class="p">,</span><span class="mi">999</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">1124</span><span class="p">,</span><span class="mi">949</span><span class="p">,</span><span class="mi">708</span><span class="p">,</span> <span class="c1"># UHSLC</span>
      <span class="mi">1296</span><span class="p">,</span><span class="mi">378</span><span class="p">,</span><span class="mi">1124</span><span class="p">,</span><span class="mi">780</span><span class="p">,</span><span class="mi">613</span><span class="p">,</span><span class="mi">488</span><span class="p">,</span><span class="mi">1442</span><span class="p">,</span><span class="mi">1217</span><span class="p">,</span><span class="mi">578</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">1177</span><span class="p">,</span><span class="mi">1025</span><span class="p">,</span><span class="mi">689</span><span class="p">,</span><span class="mi">949</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">1146</span><span class="p">,</span> <span class="c1"># LINZ</span>
      <span class="mi">1174</span><span class="p">,</span><span class="mi">1260</span><span class="p">,</span><span class="mi">1217</span><span class="p">,</span><span class="mi">744</span><span class="p">,</span><span class="mi">1064</span><span class="p">,</span><span class="mi">1214</span><span class="p">,</span><span class="mi">803</span><span class="p">,</span><span class="mi">999</span> <span class="c1"># OTHER (ports...)</span>
    <span class="p">]</span>
    <span class="c1">#[ 613,488,1442,1217,578,200,1177,1025,689,949,224,1146 ]</span>
    <span class="c1">#[1174,1260,1217]</span>
<span class="p">)</span>

<span class="n">sites_to_analyze</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1448</span><span class="p">)</span> <span class="c1"># 1448 points in total</span>


<span class="n">PCA_precomputer</span> <span class="o">=</span> <span class="n">PCA_PreComputer</span><span class="p">(</span>
           <span class="n">load_cfsr_moana_uhslc</span><span class="o">.</span><span class="n">predictor_slp</span><span class="p">,</span>
            <span class="n">load_cfsr_moana_uhslc</span><span class="o">.</span><span class="n">predictor_wind</span><span class="p">,</span>
            <span class="c1"># load_cfsr_moana_uhslc.predictor_wind,</span>
            <span class="n">load_cfsr_moana_uhslc</span><span class="o">.</span><span class="n">predictand</span><span class="p">,</span> <span class="c1"># all the sites are passed to exp at first</span>
            <span class="n">sites_to_analyze</span><span class="o">=</span><span class="n">sites_to_analyze</span><span class="p">,</span> 
            <span class="n">pca_attrs</span><span class="o">=</span><span class="n">pca_attrs</span><span class="p">,</span>
            <span class="n">pcs_folder</span> <span class="o">=</span> <span class="s1">&#39;/home/metocean/pcas&#39;</span>
        <span class="p">)</span>

<span class="n">PCA_precomputer</span><span class="o">.</span><span class="n">compute_pcas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> ---------------------------------------------------------                         

 Experiment 1 in site 0, coords = (array(165.98740554), array(-50.95653983)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;0&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_0_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        212M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.738 7.798 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -1.989 -1.739 ... 2.237
    uw2              (time, latitude, longitude) float32 59.88 60.81 ... 4.119
    vw2              (time, latitude, longitude) float32 3.956 3.024 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.99 7.99 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.352 1.711 ... -2.916
    bearings         (latitude, longitude) float64 31.53 24.94 ... 200.8 207.1
    direc_proj_math  (latitude, longitude) float64 1.02 1.136 ... -1.934 -2.045
    wind_proj_mask   (time, latitude, longitude) float64 2.352 1.711 ... -2.916
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;0&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 1, coords = (array(166.04785894), array(-50.95653983)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;1&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_1_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        212M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.738 7.798 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.989 -1.739 ... 2.724
    uw2              (time, latitude, longitude) float32 59.88 60.81 ... 5.953
    vw2              (time, latitude, longitude) float32 3.956 3.024 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.99 7.99 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.509 1.893 ... -3.6
    bearings         (latitude, longitude) float64 32.72 26.28 ... 206.0 211.8
    direc_proj_math  (latitude, longitude) float64 0.9997 1.112 ... -2.125
    wind_proj_mask   (time, latitude, longitude) float64 2.509 1.893 ... -3.6
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;1&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 2, coords = (array(166.10831234), array(-50.95653983)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;2&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_2_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        212M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.738 7.798 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.989 -1.739 ... 2.724
    uw2              (time, latitude, longitude) float32 59.88 60.81 ... 5.953
    vw2              (time, latitude, longitude) float32 3.956 3.024 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.99 7.99 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.662 2.069 ... -3.588
    bearings         (latitude, longitude) float64 33.88 27.58 ... 204.8 210.7
    direc_proj_math  (latitude, longitude) float64 0.9795 1.089 ... -2.107
    wind_proj_mask   (time, latitude, longitude) float64 2.662 2.069 ... -3.588
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;2&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 3, coords = (array(166.16876574), array(-50.95653983)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;3&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_3_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.738 7.798 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.989 -1.739 ... 2.724
    uw2              (time, latitude, longitude) float32 59.88 60.81 ... 5.953
    vw2              (time, latitude, longitude) float32 3.956 3.024 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.99 7.99 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.81 2.241 ... -3.574
    bearings         (latitude, longitude) float64 35.01 28.86 ... 203.5 209.6
    direc_proj_math  (latitude, longitude) float64 0.9598 1.067 ... -2.088
    wind_proj_mask   (time, latitude, longitude) float64 2.81 2.241 ... -3.574
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;3&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 4, coords = (array(166.22921914), array(-50.95653983)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;4&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_4_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.798 7.868 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.739 -1.478 ... 2.724
    uw2              (time, latitude, longitude) float32 60.81 61.91 ... 5.953
    vw2              (time, latitude, longitude) float32 3.024 2.186 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.99 8.006 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.408 1.76 ... -3.558
    bearings         (latitude, longitude) float64 30.11 23.34 ... 202.3 208.5
    direc_proj_math  (latitude, longitude) float64 1.045 1.163 ... -1.96 -2.068
    wind_proj_mask   (time, latitude, longitude) float64 2.408 1.76 ... -3.558
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;4&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 5, coords = (array(165.86649874), array(-50.91814531)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;5&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_5_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.4 164.7 165.0 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.64 7.738 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.25 -1.989 ... 2.237
    uw2              (time, latitude, longitude) float32 58.37 59.88 ... 4.119
    vw2              (time, latitude, longitude) float32 5.061 3.956 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.964 7.99 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.467 1.932 ... -2.953
    bearings         (latitude, longitude) float64 34.45 28.41 ... 203.9 210.1
    direc_proj_math  (latitude, longitude) float64 0.9695 1.075 ... -2.096
    wind_proj_mask   (time, latitude, longitude) float64 2.467 1.932 ... -2.953
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;5&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 6, coords = (array(165.92695214), array(-50.91814531)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;6&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_6_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.738 7.798 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -1.989 -1.739 ... 2.237
    uw2              (time, latitude, longitude) float32 59.88 60.81 ... 4.119
    vw2              (time, latitude, longitude) float32 3.956 3.024 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.99 7.99 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.098 1.447 ... -2.94
    bearings         (latitude, longitude) float64 29.64 23.01 ... 202.6 209.0
    direc_proj_math  (latitude, longitude) float64 1.054 1.169 ... -1.966 -2.076
    wind_proj_mask   (time, latitude, longitude) float64 2.098 1.447 ... -2.94
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;6&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 7, coords = (array(165.98740554), array(-50.91814531)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;7&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_7_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.738 7.798 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -1.989 -1.739 ... 2.237
    uw2              (time, latitude, longitude) float32 59.88 60.81 ... 4.119
    vw2              (time, latitude, longitude) float32 3.956 3.024 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.99 7.99 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.259 1.63 ... -2.925
    bearings         (latitude, longitude) float64 30.84 24.34 ... 201.3 207.8
    direc_proj_math  (latitude, longitude) float64 1.033 1.146 ... -1.943 -2.056
    wind_proj_mask   (time, latitude, longitude) float64 2.259 1.63 ... -2.925
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;7&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 8, coords = (array(166.22921914), array(-50.91814531)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;8&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_8_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.798 7.868 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.739 -1.478 ... 2.724
    uw2              (time, latitude, longitude) float32 60.81 61.91 ... 5.953
    vw2              (time, latitude, longitude) float32 3.024 2.186 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.99 8.006 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.317 1.683 ... -3.567
    bearings         (latitude, longitude) float64 29.43 22.78 ... 202.9 209.1
    direc_proj_math  (latitude, longitude) float64 1.057 1.173 ... -1.97 -2.08
    wind_proj_mask   (time, latitude, longitude) float64 2.317 1.683 ... -3.567
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;8&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 9, coords = (array(166.28967254), array(-50.91814531)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;9&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_9_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.798 7.868 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.739 -1.478 ... 2.724
    uw2              (time, latitude, longitude) float32 60.81 61.91 ... 5.953
    vw2              (time, latitude, longitude) float32 3.024 2.186 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.99 8.006 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.477 1.866 ... -3.55
    bearings         (latitude, longitude) float64 30.63 24.12 ... 201.6 208.0
    direc_proj_math  (latitude, longitude) float64 1.036 1.15 ... -1.947 -2.059
    wind_proj_mask   (time, latitude, longitude) float64 2.477 1.866 ... -3.55
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;9&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 10, coords = (array(165.86649874), array(-50.87971909)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;10&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_10_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.4 164.7 165.0 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.64 7.738 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.25 -1.989 ... 2.237
    uw2              (time, latitude, longitude) float32 58.37 59.88 ... 4.119
    vw2              (time, latitude, longitude) float32 5.061 3.956 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.964 7.99 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.373 1.846 ... -2.961
    bearings         (latitude, longitude) float64 33.74 27.77 ... 204.5 210.8
    direc_proj_math  (latitude, longitude) float64 0.9819 1.086 ... -2.108
    wind_proj_mask   (time, latitude, longitude) float64 2.373 1.846 ... -2.961
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;10&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 11, coords = (array(166.28967254), array(-50.87971909)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;11&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_11_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.798 7.868 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.739 -1.478 ... 2.724
    uw2              (time, latitude, longitude) float32 60.81 61.91 ... 5.953
    vw2              (time, latitude, longitude) float32 3.024 2.186 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.99 8.006 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.388 1.789 ... -3.56
    bearings         (latitude, longitude) float64 29.97 23.55 ... 202.1 208.7
    direc_proj_math  (latitude, longitude) float64 1.048 1.16 ... -1.957 -2.071
    wind_proj_mask   (time, latitude, longitude) float64 2.388 1.789 ... -3.56
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;11&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 12, coords = (array(166.35012594), array(-50.87971909)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;12&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_12_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.798 7.868 ... 2.841
    vgrd10m          (time, latitude, longitude) float32 -1.739 -1.478 ... 3.2
    uw2              (time, latitude, longitude) float32 60.81 61.91 ... 8.074
    vw2              (time, latitude, longitude) float32 3.024 2.186 ... 10.24
    wind_magnitude   (time, latitude, longitude) float32 7.99 8.006 ... 4.28
    wind_proj        (time, latitude, longitude) float64 2.542 1.965 ... -4.236
    bearings         (latitude, longitude) float64 31.13 24.85 ... 207.4 213.4
    direc_proj_math  (latitude, longitude) float64 1.028 1.137 ... -2.05 -2.153
    wind_proj_mask   (time, latitude, longitude) float64 2.542 1.965 ... -4.236
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;12&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 13, coords = (array(165.86649874), array(-50.84126116)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;13&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_13_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.4 164.7 165.0 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.64 7.738 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.25 -1.989 ... 2.237
    uw2              (time, latitude, longitude) float32 58.37 59.88 ... 4.119
    vw2              (time, latitude, longitude) float32 5.061 3.956 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.964 7.99 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.281 1.763 ... -2.968
    bearings         (latitude, longitude) float64 33.05 27.16 ... 205.1 211.5
    direc_proj_math  (latitude, longitude) float64 0.9939 1.097 ... -2.01 -2.121
    wind_proj_mask   (time, latitude, longitude) float64 2.281 1.763 ... -2.968
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;13&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 14, coords = (array(166.35012594), array(-50.84126116)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;14&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_14_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.798 7.868 ... 2.841
    vgrd10m          (time, latitude, longitude) float32 -1.739 -1.478 ... 3.2
    uw2              (time, latitude, longitude) float32 60.81 61.91 ... 8.074
    vw2              (time, latitude, longitude) float32 3.024 2.186 ... 10.24
    wind_magnitude   (time, latitude, longitude) float32 7.99 8.006 ... 4.28
    wind_proj        (time, latitude, longitude) float64 2.455 1.888 ... -4.243
    bearings         (latitude, longitude) float64 30.47 24.28 ... 208.1 214.1
    direc_proj_math  (latitude, longitude) float64 1.039 1.147 ... -2.062 -2.167
    wind_proj_mask   (time, latitude, longitude) float64 2.455 1.888 ... -4.243
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;14&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 15, coords = (array(165.86649874), array(-50.8027715)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;15&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_15_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 164.4 164.7 165.0 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.64 7.738 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.25 -1.989 ... 2.237
    uw2              (time, latitude, longitude) float32 58.37 59.88 ... 4.119
    vw2              (time, latitude, longitude) float32 5.061 3.956 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.964 7.99 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.193 1.683 ... -2.975
    bearings         (latitude, longitude) float64 32.39 26.58 ... 205.8 212.3
    direc_proj_math  (latitude, longitude) float64 1.005 1.107 ... -2.021 -2.134
    wind_proj_mask   (time, latitude, longitude) float64 2.193 1.683 ... -2.975
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;15&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 16, coords = (array(166.35012594), array(-50.8027715)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;16&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_16_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -52.3 -51.99 -51.67 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.798 7.868 ... 2.841
    vgrd10m          (time, latitude, longitude) float32 -1.739 -1.478 ... 3.2
    uw2              (time, latitude, longitude) float32 60.81 61.91 ... 8.074
    vw2              (time, latitude, longitude) float32 3.024 2.186 ... 10.24
    wind_magnitude   (time, latitude, longitude) float32 7.99 8.006 ... 4.28
    wind_proj        (time, latitude, longitude) float64 2.371 1.815 ... -4.251
    bearings         (latitude, longitude) float64 29.84 23.74 ... 208.8 214.9
    direc_proj_math  (latitude, longitude) float64 1.05 1.156 ... -2.074 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 2.371 1.815 ... -4.251
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;16&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 17, coords = (array(165.86649874), array(-50.76425011)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;17&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_17_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 164.4 164.7 165.0 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.249 7.289 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.309 -2.098 ... 2.237
    uw2              (time, latitude, longitude) float32 52.55 53.14 ... 4.119
    vw2              (time, latitude, longitude) float32 5.334 4.401 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.608 7.585 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.629 2.023 ... -2.982
    bearings         (latitude, longitude) float64 37.89 31.52 ... 206.5 213.1
    direc_proj_math  (latitude, longitude) float64 0.9095 1.021 ... -2.148
    wind_proj_mask   (time, latitude, longitude) float64 2.629 2.023 ... -2.982
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;17&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 18, coords = (array(166.28967254), array(-50.76425011)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;18&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_18_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.724
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.953
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.498 1.847 ... -3.59
    bearings         (latitude, longitude) float64 33.89 26.91 ... 203.9 210.8
    direc_proj_math  (latitude, longitude) float64 0.9794 1.101 ... -2.109
    wind_proj_mask   (time, latitude, longitude) float64 2.498 1.847 ... -3.59
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;18&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 19, coords = (array(166.35012594), array(-50.76425011)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;19&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_19_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.841
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 3.2
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 8.074
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 10.24
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 4.28
    wind_proj        (time, latitude, longitude) float64 2.652 2.029 ... -4.257
    bearings         (latitude, longitude) float64 35.13 28.33 ... 209.6 215.7
    direc_proj_math  (latitude, longitude) float64 0.9577 1.076 ... -2.195
    wind_proj_mask   (time, latitude, longitude) float64 2.652 2.029 ... -4.257
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;19&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 20, coords = (array(165.86649874), array(-50.72569698)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;20&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_20_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 164.4 164.7 165.0 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.249 7.289 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.309 -2.098 ... 2.237
    uw2              (time, latitude, longitude) float32 52.55 53.14 ... 4.119
    vw2              (time, latitude, longitude) float32 5.334 4.401 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.608 7.585 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.524 1.924 ... -2.989
    bearings         (latitude, longitude) float64 37.05 30.75 ... 207.2 213.9
    direc_proj_math  (latitude, longitude) float64 0.9242 1.034 ... -2.162
    wind_proj_mask   (time, latitude, longitude) float64 2.524 1.924 ... -2.989
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;20&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 21, coords = (array(165.92695214), array(-50.72569698)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;21&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_21_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.237
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 4.119
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.089 1.371 ... -2.979
    bearings         (latitude, longitude) float64 32.04 25.03 ... 205.8 212.7
    direc_proj_math  (latitude, longitude) float64 1.012 1.134 ... -2.021 -2.141
    wind_proj_mask   (time, latitude, longitude) float64 2.089 1.371 ... -2.979
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;21&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 22, coords = (array(166.28967254), array(-50.72569698)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;22&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_22_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.724
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.953
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.398 1.758 ... -3.599
    bearings         (latitude, longitude) float64 33.08 26.22 ... 204.6 211.6
    direc_proj_math  (latitude, longitude) float64 0.9934 1.113 ... -2.0 -2.123
    wind_proj_mask   (time, latitude, longitude) float64 2.398 1.758 ... -3.599
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;22&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 23, coords = (array(165.92695214), array(-50.68711209)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;23&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_23_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.237
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 4.119
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.02
    wind_proj        (time, latitude, longitude) float64 1.992 1.288 ... -2.986
    bearings         (latitude, longitude) float64 31.29 24.39 ... 206.5 213.5
    direc_proj_math  (latitude, longitude) float64 1.025 1.145 ... -2.034 -2.156
    wind_proj_mask   (time, latitude, longitude) float64 1.992 1.288 ... -2.986
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;23&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 24, coords = (array(165.98740554), array(-50.68711209)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;24&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_24_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.03
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.237
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 4.119
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 5.003
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.02
    wind_proj        (time, latitude, longitude) float64 2.15 1.47 ... -2.975
    bearings         (latitude, longitude) float64 32.52 25.79 ... 205.1 212.3
    direc_proj_math  (latitude, longitude) float64 1.003 1.121 ... -2.008 -2.134
    wind_proj_mask   (time, latitude, longitude) float64 2.15 1.47 ... -2.975
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;24&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 25, coords = (array(166.28967254), array(-50.68711209)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;25&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_25_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.8 -49.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.44
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.724
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.953
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.42
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.657
    wind_proj        (time, latitude, longitude) float64 2.302 1.673 ... -3.608
    bearings         (latitude, longitude) float64 32.32 25.55 ... 205.3 212.5
    direc_proj_math  (latitude, longitude) float64 1.007 1.125 ... -2.013 -2.138
    wind_proj_mask   (time, latitude, longitude) float64 2.302 1.673 ... -3.608
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;25&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 26, coords = (array(165.98740554), array(-50.64849546)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;26&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_26_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.6 166.9 167.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 1.792
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.19
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 3.213
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 4.795
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 2.83
    wind_proj        (time, latitude, longitude) float64 2.056 1.387 ... -2.767
    bearings         (latitude, longitude) float64 31.78 25.15 ... 200.9 207.2
    direc_proj_math  (latitude, longitude) float64 1.016 1.132 ... -1.935 -2.046
    wind_proj_mask   (time, latitude, longitude) float64 2.056 1.387 ... -2.767
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;26&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 27, coords = (array(166.04785894), array(-50.64849546)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;27&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_27_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.73
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 5.187
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.207 1.561 ... -3.521
    bearings         (latitude, longitude) float64 32.97 26.5 ... 206.1 211.9
    direc_proj_math  (latitude, longitude) float64 0.9953 1.108 ... -2.127
    wind_proj_mask   (time, latitude, longitude) float64 2.207 1.561 ... -3.521
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;27&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 28, coords = (array(166.28967254), array(-50.64849546)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;28&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_28_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.73
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.187
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.209 1.591 ... -3.473
    bearings         (latitude, longitude) float64 31.58 24.92 ... 201.1 207.4
    direc_proj_math  (latitude, longitude) float64 1.02 1.136 ... -1.939 -2.05
    wind_proj_mask   (time, latitude, longitude) float64 2.209 1.591 ... -3.473
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;28&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 29, coords = (array(166.04785894), array(-50.60984705)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;29&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_29_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.73
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 5.187
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.116 1.48 ... -3.527
    bearings         (latitude, longitude) float64 32.25 25.87 ... 206.7 212.6
    direc_proj_math  (latitude, longitude) float64 1.008 1.119 ... -2.036 -2.139
    wind_proj_mask   (time, latitude, longitude) float64 2.116 1.48 ... -3.527
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;29&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 30, coords = (array(166.28967254), array(-50.60984705)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;30&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_30_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.73
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.187
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.12 1.513 ... -3.481
    bearings         (latitude, longitude) float64 30.87 24.32 ... 201.6 208.1
    direc_proj_math  (latitude, longitude) float64 1.032 1.146 ... -1.948 -2.061
    wind_proj_mask   (time, latitude, longitude) float64 2.12 1.513 ... -3.481
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;30&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 31, coords = (array(166.04785894), array(-50.57116687)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;31&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_31_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.73
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 5.187
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.027 1.402 ... -3.532
    bearings         (latitude, longitude) float64 31.56 25.27 ... 207.3 213.3
    direc_proj_math  (latitude, longitude) float64 1.02 1.13 ... -2.048 -2.152
    wind_proj_mask   (time, latitude, longitude) float64 2.027 1.402 ... -3.532
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;31&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 32, coords = (array(166.28967254), array(-50.57116687)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;32&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_32_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.73
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.187
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.034 1.439 ... -3.489
    bearings         (latitude, longitude) float64 30.19 23.75 ... 202.2 208.7
    direc_proj_math  (latitude, longitude) float64 1.044 1.156 ... -1.958 -2.073
    wind_proj_mask   (time, latitude, longitude) float64 2.034 1.439 ... -3.489
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;32&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 33, coords = (array(166.04785894), array(-50.5324549)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;33&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_33_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.73
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 5.187
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.555
    wind_proj        (time, latitude, longitude) float64 1.942 1.327 ... -3.537
    bearings         (latitude, longitude) float64 30.89 24.69 ... 208.0 214.1
    direc_proj_math  (latitude, longitude) float64 1.032 1.14 ... -2.06 -2.165
    wind_proj_mask   (time, latitude, longitude) float64 1.942 1.327 ... -3.537
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;33&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 34, coords = (array(166.10831234), array(-50.5324549)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;34&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_34_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.73
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 5.187
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.085 1.489 ... -3.53
    bearings         (latitude, longitude) float64 32.01 25.94 ... 206.7 213.0
    direc_proj_math  (latitude, longitude) float64 1.012 1.118 ... -2.038 -2.146
    wind_proj_mask   (time, latitude, longitude) float64 2.085 1.489 ... -3.53
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;34&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 35, coords = (array(166.28967254), array(-50.5324549)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;35&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_35_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.73
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.187
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.555
    wind_proj        (time, latitude, longitude) float64 1.952 1.367 ... -3.497
    bearings         (latitude, longitude) float64 29.54 23.2 ... 202.8 209.4
    direc_proj_math  (latitude, longitude) float64 1.055 1.166 ... -1.968 -2.085
    wind_proj_mask   (time, latitude, longitude) float64 1.952 1.367 ... -3.497
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;35&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 36, coords = (array(166.10831234), array(-50.49371114)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;36&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_36_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.73
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 5.187
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.001 1.415 ... -3.535
    bearings         (latitude, longitude) float64 31.35 25.37 ... 207.4 213.7
    direc_proj_math  (latitude, longitude) float64 1.024 1.128 ... -2.05 -2.16
    wind_proj_mask   (time, latitude, longitude) float64 2.001 1.415 ... -3.535
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;36&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 37, coords = (array(166.16876574), array(-50.49371114)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;37&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_37_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 164.7 165.0 165.3 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.289 7.309 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -2.098 -1.899 ... 2.73
    uw2              (time, latitude, longitude) float32 53.14 53.42 ... 5.187
    vw2              (time, latitude, longitude) float32 4.401 3.607 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.585 7.551 ... 3.555
    wind_proj        (time, latitude, longitude) float64 2.139 1.571 ... -3.527
    bearings         (latitude, longitude) float64 32.44 26.58 ... 206.1 212.6
    direc_proj_math  (latitude, longitude) float64 1.005 1.107 ... -2.027 -2.139
    wind_proj_mask   (time, latitude, longitude) float64 2.139 1.571 ... -3.527
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;37&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 38, coords = (array(166.22921914), array(-50.49371114)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;38&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_38_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.73
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.187
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.555
    wind_proj        (time, latitude, longitude) float64 1.723 1.132 ... -3.517
    bearings         (latitude, longitude) float64 27.76 21.39 ... 204.8 211.4
    direc_proj_math  (latitude, longitude) float64 1.086 1.197 ... -2.003 -2.119
    wind_proj_mask   (time, latitude, longitude) float64 1.723 1.132 ... -3.517
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;38&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 39, coords = (array(166.28967254), array(-50.49371114)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;39&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_39_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -51.99 -51.67 -51.36 ... -49.49 -49.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 166.9 167.2 167.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 7.309 7.39 ... 2.277
    vgrd10m          (time, latitude, longitude) float32 -1.899 -1.679 ... 2.73
    uw2              (time, latitude, longitude) float32 53.42 54.61 ... 5.187
    vw2              (time, latitude, longitude) float32 3.607 2.82 ... 7.455
    wind_magnitude   (time, latitude, longitude) float32 7.551 7.578 ... 3.555
    wind_proj        (time, latitude, longitude) float64 1.872 1.299 ... -3.505
    bearings         (latitude, longitude) float64 28.92 22.67 ... 203.4 210.2
    direc_proj_math  (latitude, longitude) float64 1.066 1.175 ... -1.979 -2.098
    wind_proj_mask   (time, latitude, longitude) float64 1.872 1.299 ... -3.505
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;39&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 40, coords = (array(167.43828715), array(-47.33186544)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;40&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_40_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.098
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.322
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.206
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.749
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.719
    wind_proj        (time, latitude, longitude) float64 0.6849 0.471 ... 0.463
    bearings         (latitude, longitude) float64 33.57 26.01 ... 207.8 214.7
    direc_proj_math  (latitude, longitude) float64 0.9849 1.117 ... -2.176
    wind_proj_mask   (time, latitude, longitude) float64 0.6849 0.471 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;40&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 41, coords = (array(167.49874055), array(-47.33186544)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;41&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_41_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.098
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.322
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.206
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.749
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.719
    wind_proj        (time, latitude, longitude) float64 0.7796 ... 0.4987
    bearings         (latitude, longitude) float64 34.91 27.56 ... 206.4 213.4
    direc_proj_math  (latitude, longitude) float64 0.9615 1.09 ... -2.032 -2.154
    wind_proj_mask   (time, latitude, longitude) float64 0.7796 0.5835 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;41&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 42, coords = (array(167.55919395), array(-47.33186544)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;42&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_42_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.098
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.322
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.206
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.749
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.719
    wind_proj        (time, latitude, longitude) float64 0.871 0.6927 ... 0.5353
    bearings         (latitude, longitude) float64 36.2 29.07 ... 204.9 212.1
    direc_proj_math  (latitude, longitude) float64 0.9389 1.063 ... -2.132
    wind_proj_mask   (time, latitude, longitude) float64 0.871 0.6927 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;42&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 43, coords = (array(167.61964736), array(-47.33186544)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;43&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_43_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.047
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.305
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.096
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.704
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.673
    wind_proj        (time, latitude, longitude) float64 0.9593 0.7985 ... 0.406
    bearings         (latitude, longitude) float64 37.46 30.53 ... 210.8 217.2
    direc_proj_math  (latitude, longitude) float64 0.917 1.038 ... -2.109 -2.221
    wind_proj_mask   (time, latitude, longitude) float64 0.9593 0.7985 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;43&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 44, coords = (array(167.43828715), array(-47.2905558)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;44&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_44_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.098
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.322
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.206
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.749
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.719
    wind_proj        (time, latitude, longitude) float64 0.6239 ... 0.4369
    bearings         (latitude, longitude) float64 32.71 25.28 ... 208.6 215.6
    direc_proj_math  (latitude, longitude) float64 0.9998 1.13 ... -2.071 -2.192
    wind_proj_mask   (time, latitude, longitude) float64 0.6239 0.4178 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;44&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 45, coords = (array(167.61964736), array(-47.2905558)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;45&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_45_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.047
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.305
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.096
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.704
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.673
    wind_proj        (time, latitude, longitude) float64 0.896 0.74 ... 0.3797
    bearings         (latitude, longitude) float64 36.56 29.72 ... 211.7 218.2
    direc_proj_math  (latitude, longitude) float64 0.9327 1.052 ... -2.237
    wind_proj_mask   (time, latitude, longitude) float64 0.896 0.74 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;45&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 46, coords = (array(167.68010076), array(-47.2905558)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;46&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_46_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.047
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.305
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.096
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.704
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.673
    wind_proj        (time, latitude, longitude) float64 0.9807 0.841 ... 0.4129
    bearings         (latitude, longitude) float64 37.77 31.12 ... 210.3 217.0
    direc_proj_math  (latitude, longitude) float64 0.9116 1.028 ... -2.1 -2.216
    wind_proj_mask   (time, latitude, longitude) float64 0.9807 0.841 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;46&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 47, coords = (array(167.43828715), array(-47.24921387)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;47&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_47_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.098
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.322
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.206
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.749
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.719
    wind_proj        (time, latitude, longitude) float64 0.5656 ... 0.4095
    bearings         (latitude, longitude) float64 31.9 24.59 ... 209.5 216.5
    direc_proj_math  (latitude, longitude) float64 1.014 1.142 ... -2.085 -2.208
    wind_proj_mask   (time, latitude, longitude) float64 0.5656 0.3673 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;47&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 48, coords = (array(167.68010076), array(-47.24921387)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;48&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_48_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.37 -46.05
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 1.047
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -1.305
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 1.096
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 1.704
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 1.673
    wind_proj        (time, latitude, longitude) float64 0.9193 ... 0.3858
    bearings         (latitude, longitude) float64 36.89 30.33 ... 211.2 217.9
    direc_proj_math  (latitude, longitude) float64 0.9269 1.041 ... -2.233
    wind_proj_mask   (time, latitude, longitude) float64 0.9193 0.7837 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;48&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 49, coords = (array(167.43828715), array(-47.20783964)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;49&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_49_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.814
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.3333
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.6626
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.1111
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.8796
    wind_proj        (time, latitude, longitude) float64 0.5098 ... -0.136
    bearings         (latitude, longitude) float64 31.11 23.94 ... 204.8 211.2
    direc_proj_math  (latitude, longitude) float64 1.028 1.153 ... -2.003 -2.115
    wind_proj_mask   (time, latitude, longitude) float64 0.5098 0.3194 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;49&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 50, coords = (array(167.68010076), array(-47.20783964)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;50&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_50_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.2649
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.7899
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 0.8602 0.729 ... -0.254
    bearings         (latitude, longitude) float64 36.05 29.57 ... 206.3 212.5
    direc_proj_math  (latitude, longitude) float64 0.9416 1.055 ... -2.03 -2.138
    wind_proj_mask   (time, latitude, longitude) float64 0.8602 0.729 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;50&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 51, coords = (array(167.74055416), array(-47.20783964)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;51&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_51_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.2649
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.7899
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 0.9412 ... -0.2363
    bearings         (latitude, longitude) float64 37.2 30.89 ... 205.0 211.4
    direc_proj_math  (latitude, longitude) float64 0.9215 1.032 ... -2.118
    wind_proj_mask   (time, latitude, longitude) float64 0.9412 0.8244 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;51&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 52, coords = (array(167.80100756), array(-47.20783964)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;52&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_52_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.959 4.138 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.408 ... -0.2649
    uw2              (time, latitude, longitude) float32 15.67 17.13 ... 0.7899
    vw2              (time, latitude, longitude) float32 1.982 1.297 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 4.202 4.292 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 0.917 0.728 ... -0.2179
    bearings         (latitude, longitude) float64 32.18 25.15 ... 203.7 210.2
    direc_proj_math  (latitude, longitude) float64 1.009 1.132 ... -1.984 -2.098
    wind_proj_mask   (time, latitude, longitude) float64 0.917 0.728 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;52&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 53, coords = (array(167.86146096), array(-47.20783964)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;53&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_53_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.959 4.138 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.408 ... -0.2649
    uw2              (time, latitude, longitude) float32 15.67 17.13 ... 0.7899
    vw2              (time, latitude, longitude) float32 1.982 1.297 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 4.202 4.292 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 1.007 ... -0.1991
    bearings         (latitude, longitude) float64 33.44 26.58 ... 202.3 209.0
    direc_proj_math  (latitude, longitude) float64 0.9872 1.107 ... -2.077
    wind_proj_mask   (time, latitude, longitude) float64 1.007 0.8333 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;53&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 54, coords = (array(167.92191436), array(-47.20783964)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;54&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_54_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.959 4.138 ... 1.154
    vgrd10m          (time, latitude, longitude) float32 -1.408 ... 0.1196
    uw2              (time, latitude, longitude) float32 15.67 17.13 ... 1.331
    vw2              (time, latitude, longitude) float32 1.982 1.297 ... 0.01431
    wind_magnitude   (time, latitude, longitude) float32 4.202 4.292 ... 1.16
    wind_proj        (time, latitude, longitude) float64 1.094 0.9357 ... -0.741
    bearings         (latitude, longitude) float64 34.66 27.98 ... 207.8 213.8
    direc_proj_math  (latitude, longitude) float64 0.9658 1.082 ... -2.055 -2.16
    wind_proj_mask   (time, latitude, longitude) float64 1.094 0.9357 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;54&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 55, coords = (array(167.98236776), array(-47.20783964)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;55&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_55_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.959 4.138 ... 1.154
    vgrd10m          (time, latitude, longitude) float32 -1.408 ... 0.1196
    uw2              (time, latitude, longitude) float32 15.67 17.13 ... 1.331
    vw2              (time, latitude, longitude) float32 1.982 1.297 ... 0.01431
    wind_magnitude   (time, latitude, longitude) float32 4.202 4.292 ... 1.16
    wind_proj        (time, latitude, longitude) float64 1.178 1.035 ... -0.7237
    bearings         (latitude, longitude) float64 35.85 29.34 ... 206.5 212.7
    direc_proj_math  (latitude, longitude) float64 0.945 1.059 ... -2.033 -2.141
    wind_proj_mask   (time, latitude, longitude) float64 1.178 1.035 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;55&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 56, coords = (array(167.43828715), array(-47.16643312)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;56&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_56_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.814
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.3333
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.6626
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.1111
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.8796
    wind_proj        (time, latitude, longitude) float64 0.4563 ... -0.1473
    bearings         (latitude, longitude) float64 30.37 23.31 ... 205.4 211.9
    direc_proj_math  (latitude, longitude) float64 1.041 1.164 ... -2.015 -2.128
    wind_proj_mask   (time, latitude, longitude) float64 0.4563 0.2738 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;56&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 57, coords = (array(167.49874055), array(-47.16643312)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;57&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_57_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.814
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.3333
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.6626
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.1111
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.8796
    wind_proj        (time, latitude, longitude) float64 0.5469 ... -0.1293
    bearings         (latitude, longitude) float64 31.63 24.74 ... 204.1 210.7
    direc_proj_math  (latitude, longitude) float64 1.019 1.139 ... -1.991 -2.107
    wind_proj_mask   (time, latitude, longitude) float64 0.5469 0.3783 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;57&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 58, coords = (array(167.98236776), array(-47.16643312)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;58&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_58_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.959 4.138 ... 1.154
    vgrd10m          (time, latitude, longitude) float32 -1.408 ... 0.1196
    uw2              (time, latitude, longitude) float32 15.67 17.13 ... 1.331
    vw2              (time, latitude, longitude) float32 1.982 1.297 ... 0.01431
    wind_magnitude   (time, latitude, longitude) float32 4.202 4.292 ... 1.16
    wind_proj        (time, latitude, longitude) float64 1.121 ... -0.7357
    bearings         (latitude, longitude) float64 35.05 28.62 ... 207.2 213.5
    direc_proj_math  (latitude, longitude) float64 0.9591 1.071 ... -2.155
    wind_proj_mask   (time, latitude, longitude) float64 1.121 0.9827 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;58&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 59, coords = (array(168.04282116), array(-47.16643312)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;59&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_59_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.959 4.138 ... 1.154
    vgrd10m          (time, latitude, longitude) float32 -1.408 ... 0.1196
    uw2              (time, latitude, longitude) float32 15.67 17.13 ... 1.331
    vw2              (time, latitude, longitude) float32 1.982 1.297 ... 0.01431
    wind_magnitude   (time, latitude, longitude) float32 4.202 4.292 ... 1.16
    wind_proj        (time, latitude, longitude) float64 1.202 1.078 ... -0.7177
    bearings         (latitude, longitude) float64 36.19 29.93 ... 205.9 212.3
    direc_proj_math  (latitude, longitude) float64 0.9391 1.048 ... -2.135
    wind_proj_mask   (time, latitude, longitude) float64 1.202 1.078 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;59&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 60, coords = (array(168.10327456), array(-47.16643312)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;60&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_60_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.138 4.279 ... 1.154
    vgrd10m          (time, latitude, longitude) float32 -1.139 ... 0.1196
    uw2              (time, latitude, longitude) float32 17.13 18.31 ... 1.331
    vw2              (time, latitude, longitude) float32 1.297 0.771 ... 0.01431
    wind_magnitude   (time, latitude, longitude) float32 4.292 4.368 ... 1.16
    wind_proj        (time, latitude, longitude) float64 1.17 0.9579 ... -0.6988
    bearings         (latitude, longitude) float64 31.21 24.26 ... 204.5 211.1
    direc_proj_math  (latitude, longitude) float64 1.026 1.147 ... -1.999 -2.114
    wind_proj_mask   (time, latitude, longitude) float64 1.17 0.9579 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;60&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 61, coords = (array(168.16372796), array(-47.16643312)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;61&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_61_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.138 4.279 ... 1.154
    vgrd10m          (time, latitude, longitude) float32 -1.139 ... 0.1196
    uw2              (time, latitude, longitude) float32 17.13 18.31 ... 1.331
    vw2              (time, latitude, longitude) float32 1.297 0.771 ... 0.01431
    wind_magnitude   (time, latitude, longitude) float32 4.292 4.368 ... 1.16
    wind_proj        (time, latitude, longitude) float64 1.26 1.062 ... -0.6791
    bearings         (latitude, longitude) float64 32.45 25.67 ... 203.2 209.9
    direc_proj_math  (latitude, longitude) float64 1.004 1.123 ... -1.975 -2.093
    wind_proj_mask   (time, latitude, longitude) float64 1.26 1.062 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;61&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 62, coords = (array(167.49874055), array(-47.1249943)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;62&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_62_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.814
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.3333
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.6626
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.1111
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.8796
    wind_proj        (time, latitude, longitude) float64 0.4945 ... -0.1409
    bearings         (latitude, longitude) float64 30.9 24.12 ... 204.7 211.5
    direc_proj_math  (latitude, longitude) float64 1.031 1.15 ... -2.002 -2.12
    wind_proj_mask   (time, latitude, longitude) float64 0.4945 0.3329 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;62&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 63, coords = (array(167.55919395), array(-47.1249943)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;63&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_63_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.814
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.3333
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.6626
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.1111
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.8796
    wind_proj        (time, latitude, longitude) float64 0.5815 ... -0.1221
    bearings         (latitude, longitude) float64 32.12 25.49 ... 203.3 210.2
    direc_proj_math  (latitude, longitude) float64 1.01 1.126 ... -1.978 -2.099
    wind_proj_mask   (time, latitude, longitude) float64 0.5815 0.4332 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;63&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 64, coords = (array(168.16372796), array(-47.1249943)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;64&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_64_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.138 4.279 ... 1.154
    vgrd10m          (time, latitude, longitude) float32 -1.139 ... 0.1196
    uw2              (time, latitude, longitude) float32 17.13 18.31 ... 1.331
    vw2              (time, latitude, longitude) float32 1.297 0.771 ... 0.01431
    wind_magnitude   (time, latitude, longitude) float32 4.292 4.368 ... 1.16
    wind_proj        (time, latitude, longitude) float64 1.206 1.015 ... -0.6914
    bearings         (latitude, longitude) float64 31.71 25.03 ... 203.8 210.7
    direc_proj_math  (latitude, longitude) float64 1.017 1.134 ... -1.986 -2.106
    wind_proj_mask   (time, latitude, longitude) float64 1.206 1.015 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;64&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 65, coords = (array(168.22418136), array(-47.1249943)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;65&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_65_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.138 4.279 ... 1.566
    vgrd10m          (time, latitude, longitude) float32 -1.139 ... 0.6965
    uw2              (time, latitude, longitude) float32 17.13 18.31 ... 2.452
    vw2              (time, latitude, longitude) float32 1.297 0.771 ... 0.4851
    wind_magnitude   (time, latitude, longitude) float32 4.292 4.368 ... 1.714
    wind_proj        (time, latitude, longitude) float64 1.292 1.115 ... -1.477
    bearings         (latitude, longitude) float64 32.91 26.39 ... 209.4 215.6
    direc_proj_math  (latitude, longitude) float64 0.9964 1.11 ... -2.084 -2.191
    wind_proj_mask   (time, latitude, longitude) float64 1.292 1.115 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;65&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 66, coords = (array(168.28463476), array(-47.1249943)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;66&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_66_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.138 4.279 ... 1.566
    vgrd10m          (time, latitude, longitude) float32 -1.139 ... 0.6965
    uw2              (time, latitude, longitude) float32 17.13 18.31 ... 2.452
    vw2              (time, latitude, longitude) float32 1.297 0.771 ... 0.4851
    wind_magnitude   (time, latitude, longitude) float32 4.292 4.368 ... 1.714
    wind_proj        (time, latitude, longitude) float64 1.376 1.213 ... -1.46
    bearings         (latitude, longitude) float64 34.08 27.71 ... 208.1 214.4
    direc_proj_math  (latitude, longitude) float64 0.976 1.087 ... -2.062 -2.172
    wind_proj_mask   (time, latitude, longitude) float64 1.376 1.213 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;66&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 67, coords = (array(167.55919395), array(-47.08352317)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;67&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_67_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.959 ... 0.814
    vgrd10m          (time, latitude, longitude) float32 -1.679 ... -0.3333
    uw2              (time, latitude, longitude) float32 14.2 15.67 ... 0.6626
    vw2              (time, latitude, longitude) float32 2.82 1.982 ... 0.1111
    wind_magnitude   (time, latitude, longitude) float32 4.126 4.202 ... 0.8796
    wind_proj        (time, latitude, longitude) float64 0.5303 ... -0.134
    bearings         (latitude, longitude) float64 31.4 24.88 ... 204.0 211.0
    direc_proj_math  (latitude, longitude) float64 1.023 1.137 ... -1.989 -2.112
    wind_proj_mask   (time, latitude, longitude) float64 0.5303 0.3882 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;67&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 68, coords = (array(168.28463476), array(-47.08352317)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;68&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_68_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.55 -48.24 -47.93 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.138 4.279 ... 1.566
    vgrd10m          (time, latitude, longitude) float32 -1.139 ... 0.6965
    uw2              (time, latitude, longitude) float32 17.13 18.31 ... 2.452
    vw2              (time, latitude, longitude) float32 1.297 0.771 ... 0.4851
    wind_magnitude   (time, latitude, longitude) float32 4.292 4.368 ... 1.714
    wind_proj        (time, latitude, longitude) float64 1.323 1.165 ... -1.473
    bearings         (latitude, longitude) float64 33.34 27.06 ... 208.9 215.3
    direc_proj_math  (latitude, longitude) float64 0.989 1.099 ... -2.075 -2.186
    wind_proj_mask   (time, latitude, longitude) float64 1.323 1.165 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;68&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 69, coords = (array(167.55919395), array(-47.04201973)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;69&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_69_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.814
    vgrd10m          (time, latitude, longitude) float32 -1.47 ... -0.3333
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.6626
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.1111
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.8796
    wind_proj        (time, latitude, longitude) float64 0.8747 ... -0.1463
    bearings         (latitude, longitude) float64 36.86 29.66 ... 204.7 211.8
    direc_proj_math  (latitude, longitude) float64 0.9274 1.053 ... -2.127
    wind_proj_mask   (time, latitude, longitude) float64 0.8747 0.8015 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;69&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 70, coords = (array(167.61964736), array(-47.04201973)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;70&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_70_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.47 ... -0.2649
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.7899
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 0.9544 ... -0.3218
    bearings         (latitude, longitude) float64 38.13 31.14 ... 210.5 216.9
    direc_proj_math  (latitude, longitude) float64 0.9053 1.027 ... -2.215
    wind_proj_mask   (time, latitude, longitude) float64 0.9544 0.8951 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;70&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 71, coords = (array(168.28463476), array(-47.04201973)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;71&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_71_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.566
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 0.6965
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 2.452
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 0.4851
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.714
    wind_proj        (time, latitude, longitude) float64 1.731 1.672 ... -1.486
    bearings         (latitude, longitude) float64 38.94 32.1 ... 209.6 216.1
    direc_proj_math  (latitude, longitude) float64 0.8911 1.011 ... -2.202
    wind_proj_mask   (time, latitude, longitude) float64 1.731 1.672 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;71&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 72, coords = (array(167.61964736), array(-47.00048398)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;72&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_72_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.47 ... -0.2649
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.7899
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 0.8959 ... -0.3356
    bearings         (latitude, longitude) float64 37.2 30.3 ... 211.4 217.8
    direc_proj_math  (latitude, longitude) float64 0.9215 1.042 ... -2.231
    wind_proj_mask   (time, latitude, longitude) float64 0.8959 0.8421 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;72&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 73, coords = (array(168.28463476), array(-47.00048398)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;73&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_73_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.566
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 0.6965
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 2.452
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 0.4851
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.714
    wind_proj        (time, latitude, longitude) float64 1.676 1.621 ... -1.499
    bearings         (latitude, longitude) float64 38.01 31.24 ... 210.5 217.0
    direc_proj_math  (latitude, longitude) float64 0.9074 1.026 ... -2.217
    wind_proj_mask   (time, latitude, longitude) float64 1.676 1.621 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;73&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 74, coords = (array(167.61964736), array(-46.95891591)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;74&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_74_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.47 ... -0.2649
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.7899
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 0.8397 ... -0.3499
    bearings         (latitude, longitude) float64 36.31 29.5 ... 212.2 218.8
    direc_proj_math  (latitude, longitude) float64 0.9371 1.056 ... -2.247
    wind_proj_mask   (time, latitude, longitude) float64 0.8397 0.7914 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;74&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 75, coords = (array(167.68010076), array(-46.95891591)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;75&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_75_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.8888
    vgrd10m          (time, latitude, longitude) float32 -1.47 ... -0.2649
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.7899
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.07018
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9274
    wind_proj        (time, latitude, longitude) float64 0.9157 ... -0.3322
    bearings         (latitude, longitude) float64 37.51 30.89 ... 210.9 217.6
    direc_proj_math  (latitude, longitude) float64 0.9161 1.032 ... -2.227
    wind_proj_mask   (time, latitude, longitude) float64 0.9157 0.8796 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;75&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 76, coords = (array(168.22418136), array(-46.95891591)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;76&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_76_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.566
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 0.6965
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 2.452
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 0.4851
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.714
    wind_proj        (time, latitude, longitude) float64 1.552 1.488 ... -1.529
    bearings         (latitude, longitude) float64 35.89 29.02 ... 212.7 219.2
    direc_proj_math  (latitude, longitude) float64 0.9443 1.064 ... -2.254
    wind_proj_mask   (time, latitude, longitude) float64 1.552 1.488 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;76&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 77, coords = (array(168.28463476), array(-46.95891591)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;77&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_77_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -46.05 -45.74
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.566
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 0.6965
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 2.452
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 0.4851
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.714
    wind_proj        (time, latitude, longitude) float64 1.624 1.573 ... -1.513
    bearings         (latitude, longitude) float64 37.11 30.42 ... 211.3 218.0
    direc_proj_math  (latitude, longitude) float64 0.9231 1.04 ... -2.118 -2.234
    wind_proj_mask   (time, latitude, longitude) float64 1.624 1.573 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;77&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 78, coords = (array(167.68010076), array(-46.91731553)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;78&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_78_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -1.47 -1.098 ... 0.7307
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.4108
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 0.8611 0.8301 ... -0.96
    bearings         (latitude, longitude) float64 36.65 30.11 ... 206.1 212.3
    direc_proj_math  (latitude, longitude) float64 0.9312 1.045 ... -2.134
    wind_proj_mask   (time, latitude, longitude) float64 0.8611 0.8301 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;78&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 79, coords = (array(168.16372796), array(-46.91731553)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;79&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_79_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 1.066
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 1.114
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.427 1.355 ... -1.444
    bearings         (latitude, longitude) float64 33.8 26.84 ... 202.4 209.0
    direc_proj_math  (latitude, longitude) float64 0.9808 1.102 ... -2.076
    wind_proj_mask   (time, latitude, longitude) float64 1.427 1.355 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;79&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 80, coords = (array(168.22418136), array(-46.91731553)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;80&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_80_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.416
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 1.455
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 2.006
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 2.117
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 2.031
    wind_proj        (time, latitude, longitude) float64 1.501 1.442 ... -1.997
    bearings         (latitude, longitude) float64 35.04 28.26 ... 207.8 213.7
    direc_proj_math  (latitude, longitude) float64 0.9592 1.078 ... -2.159
    wind_proj_mask   (time, latitude, longitude) float64 1.501 1.442 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;80&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 81, coords = (array(167.68010076), array(-46.87568282)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;81&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_81_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -1.47 -1.098 ... 0.7307
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.4108
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 0.8085 ... -0.9619
    bearings         (latitude, longitude) float64 35.82 29.36 ... 206.7 213.0
    direc_proj_math  (latitude, longitude) float64 0.9457 1.058 ... -2.147
    wind_proj_mask   (time, latitude, longitude) float64 0.8085 0.7827 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;81&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 82, coords = (array(168.16372796), array(-46.87568282)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;82&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_82_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 1.066
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 1.114
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.378 1.313 ... -1.449
    bearings         (latitude, longitude) float64 33.0 26.15 ... 203.0 209.7
    direc_proj_math  (latitude, longitude) float64 0.9948 1.114 ... -2.089
    wind_proj_mask   (time, latitude, longitude) float64 1.378 1.313 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;82&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 83, coords = (array(167.68010076), array(-46.83401779)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;83&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_83_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -1.47 -1.098 ... 0.7307
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.4108
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 0.7578 ... -0.9637
    bearings         (latitude, longitude) float64 35.02 28.64 ... 207.4 213.8
    direc_proj_math  (latitude, longitude) float64 0.9596 1.071 ... -2.05 -2.161
    wind_proj_mask   (time, latitude, longitude) float64 0.7578 0.7373 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;83&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 84, coords = (array(168.10327456), array(-46.83401779)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;84&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_84_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 1.066
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 1.114
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.255 1.185 ... -1.461
    bearings         (latitude, longitude) float64 31.0 24.08 ... 205.0 211.6
    direc_proj_math  (latitude, longitude) float64 1.03 1.15 ... -2.007 -2.123
    wind_proj_mask   (time, latitude, longitude) float64 1.255 1.185 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;84&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 85, coords = (array(168.16372796), array(-46.83401779)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;85&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_85_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 1.066
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 1.114
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.332 1.272 ... -1.454
    bearings         (latitude, longitude) float64 32.24 25.49 ... 203.6 210.4
    direc_proj_math  (latitude, longitude) float64 1.008 1.126 ... -1.983 -2.102
    wind_proj_mask   (time, latitude, longitude) float64 1.332 1.272 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;85&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 86, coords = (array(167.68010076), array(-46.79232043)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;86&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_86_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -1.47 -1.098 ... 0.7307
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.4108
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 0.7089 ... -0.9654
    bearings         (latitude, longitude) float64 34.25 27.96 ... 208.2 214.6
    direc_proj_math  (latitude, longitude) float64 0.973 1.083 ... -2.062 -2.175
    wind_proj_mask   (time, latitude, longitude) float64 0.7089 0.6939 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;86&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 87, coords = (array(168.04282116), array(-46.79232043)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;87&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_87_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.549 3.668 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -1.098 ... 1.066
    uw2              (time, latitude, longitude) float32 12.59 13.46 ... 1.114
    vw2              (time, latitude, longitude) float32 1.206 0.5464 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.715 3.742 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.148 1.133 ... -1.472
    bearings         (latitude, longitude) float64 35.19 29.02 ... 207.0 213.6
    direc_proj_math  (latitude, longitude) float64 0.9566 1.064 ... -2.158
    wind_proj_mask   (time, latitude, longitude) float64 1.148 1.133 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;87&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 88, coords = (array(168.10327456), array(-46.79232043)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;88&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_88_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.668 3.749 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.7392 ... 1.066
    uw2              (time, latitude, longitude) float32 13.46 14.06 ... 1.114
    vw2              (time, latitude, longitude) float32 0.5464 0.143 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.742 3.768 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.211 1.147 ... -1.466
    bearings         (latitude, longitude) float64 30.28 23.48 ... 205.7 212.4
    direc_proj_math  (latitude, longitude) float64 1.042 1.161 ... -2.019 -2.137
    wind_proj_mask   (time, latitude, longitude) float64 1.211 1.147 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;88&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 89, coords = (array(167.68010076), array(-46.75059074)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;89&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_89_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.418 3.549 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -1.47 -1.098 ... 0.7307
    uw2              (time, latitude, longitude) float32 11.68 12.59 ... 0.4108
    vw2              (time, latitude, longitude) float32 2.16 1.206 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.721 3.715 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 0.6618 ... -0.967
    bearings         (latitude, longitude) float64 33.51 27.31 ... 208.9 215.5
    direc_proj_math  (latitude, longitude) float64 0.9859 1.094 ... -2.076 -2.19
    wind_proj_mask   (time, latitude, longitude) float64 0.6618 0.6522 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;89&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 90, coords = (array(168.04282116), array(-46.75059074)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;90&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_90_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -48.24 -47.93 -47.61 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.549 3.668 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -1.098 ... 1.066
    uw2              (time, latitude, longitude) float32 12.59 13.46 ... 1.114
    vw2              (time, latitude, longitude) float32 1.206 0.5464 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.715 3.742 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.101 1.092 ... -1.476
    bearings         (latitude, longitude) float64 34.44 28.35 ... 207.8 214.5
    direc_proj_math  (latitude, longitude) float64 0.9697 1.076 ... -2.173
    wind_proj_mask   (time, latitude, longitude) float64 1.101 1.092 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;90&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 91, coords = (array(167.68010076), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;91&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_91_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.918 3.019 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -0.908 ... 0.7307
    uw2              (time, latitude, longitude) float32 8.517 9.113 ... 0.4108
    vw2              (time, latitude, longitude) float32 0.8244 0.229 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.056 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 1.133 1.208 ... -0.9684
    bearings         (latitude, longitude) float64 39.04 32.29 ... 209.7 216.4
    direc_proj_math  (latitude, longitude) float64 0.8894 1.007 ... -2.09 -2.205
    wind_proj_mask   (time, latitude, longitude) float64 1.133 1.208 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;91&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 92, coords = (array(168.04282116), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;92&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_92_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 3.109 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.4786 ... 1.066
    uw2              (time, latitude, longitude) float32 9.113 9.663 ... 1.114
    vw2              (time, latitude, longitude) float32 0.229 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.109 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.575 1.681 ... -1.48
    bearings         (latitude, longitude) float64 40.03 33.45 ... 208.6 215.4
    direc_proj_math  (latitude, longitude) float64 0.8722 0.987 ... -2.188
    wind_proj_mask   (time, latitude, longitude) float64 1.575 1.681 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;92&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 93, coords = (array(168.82871537), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;93&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_93_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.175
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.551
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 1.381
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.406
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 1.946
    wind_proj        (time, latitude, longitude) float64 2.574 2.592 ... -1.945
    bearings         (latitude, longitude) float64 36.97 29.86 ... 212.0 218.3
    direc_proj_math  (latitude, longitude) float64 0.9256 1.05 ... -2.129 -2.239
    wind_proj_mask   (time, latitude, longitude) float64 2.574 2.592 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;93&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 94, coords = (array(168.88916877), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;94&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_94_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.175
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.551
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 1.381
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.406
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 1.946
    wind_proj        (time, latitude, longitude) float64 2.618 2.645 ... -1.946
    bearings         (latitude, longitude) float64 38.22 31.32 ... 210.7 217.1
    direc_proj_math  (latitude, longitude) float64 0.9038 1.024 ... -2.219
    wind_proj_mask   (time, latitude, longitude) float64 2.618 2.645 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;94&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 95, coords = (array(168.94962217), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;95&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_95_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.175
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.551
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 1.381
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.406
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 1.946
    wind_proj        (time, latitude, longitude) float64 2.659 2.694 ... -1.945
    bearings         (latitude, longitude) float64 39.43 32.74 ... 209.3 216.0
    direc_proj_math  (latitude, longitude) float64 0.8827 0.9993 ... -2.199
    wind_proj_mask   (time, latitude, longitude) float64 2.659 2.694 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;95&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 96, coords = (array(169.01007557), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;96&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_96_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.1 2.97 ... 1.175
    vgrd10m          (time, latitude, longitude) float32 1.209 1.508 ... 1.551
    uw2              (time, latitude, longitude) float32 9.61 8.819 ... 1.381
    vw2              (time, latitude, longitude) float32 1.462 2.275 ... 2.406
    wind_magnitude   (time, latitude, longitude) float32 3.327 3.331 ... 1.946
    wind_proj        (time, latitude, longitude) float64 2.74 2.677 ... -1.944
    bearings         (latitude, longitude) float64 34.12 26.55 ... 207.9 214.8
    direc_proj_math  (latitude, longitude) float64 0.9753 1.107 ... -2.178
    wind_proj_mask   (time, latitude, longitude) float64 2.74 2.677 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;96&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 97, coords = (array(169.07052897), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;97&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_97_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.1 2.97 ... 1.175
    vgrd10m          (time, latitude, longitude) float32 1.209 1.508 ... 1.551
    uw2              (time, latitude, longitude) float32 9.61 8.819 ... 1.381
    vw2              (time, latitude, longitude) float32 1.462 2.275 ... 2.406
    wind_magnitude   (time, latitude, longitude) float32 3.327 3.331 ... 1.946
    wind_proj        (time, latitude, longitude) float64 2.783 2.729 ... -1.942
    bearings         (latitude, longitude) float64 35.46 28.1 ... 206.4 213.5
    direc_proj_math  (latitude, longitude) float64 0.9519 1.08 ... -2.032 -2.156
    wind_proj_mask   (time, latitude, longitude) float64 2.783 2.729 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;97&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 98, coords = (array(169.13098237), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;98&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_98_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.1 2.97 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.209 1.508 ... 0.5469
    uw2              (time, latitude, longitude) float32 9.61 8.819 ... 0.05423
    vw2              (time, latitude, longitude) float32 1.462 2.275 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.327 3.331 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.824 2.779 ... -0.5731
    bearings         (latitude, longitude) float64 36.75 29.61 ... 212.2 218.5
    direc_proj_math  (latitude, longitude) float64 0.9293 1.054 ... -2.242
    wind_proj_mask   (time, latitude, longitude) float64 2.824 2.779 ... -0.5731
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;98&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 99, coords = (array(169.19143577), array(-46.70882871)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;99&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_99_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.1 2.97 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.209 1.508 ... 0.5469
    uw2              (time, latitude, longitude) float32 9.61 8.819 ... 0.05423
    vw2              (time, latitude, longitude) float32 1.462 2.275 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.327 3.331 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.862 2.825 ... -0.5761
    bearings         (latitude, longitude) float64 38.01 31.08 ... 210.9 217.3
    direc_proj_math  (latitude, longitude) float64 0.9074 1.028 ... -2.11 -2.223
    wind_proj_mask   (time, latitude, longitude) float64 2.862 2.825 ... -0.5761
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;99&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 100, coords = (array(167.68010076), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;100&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_100_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.918 3.019 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -0.908 ... 0.7307
    uw2              (time, latitude, longitude) float32 8.517 9.113 ... 0.4108
    vw2              (time, latitude, longitude) float32 0.8244 0.229 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.056 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 1.087 1.166 ... -0.9696
    bearings         (latitude, longitude) float64 38.11 31.44 ... 210.6 217.3
    direc_proj_math  (latitude, longitude) float64 0.9056 1.022 ... -2.222
    wind_proj_mask   (time, latitude, longitude) float64 1.087 1.166 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;100&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 101, coords = (array(167.74055416), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;101&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_101_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.918 3.019 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -0.908 ... 0.7307
    uw2              (time, latitude, longitude) float32 8.517 9.113 ... 0.4108
    vw2              (time, latitude, longitude) float32 0.8244 0.229 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.056 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 1.145 1.234 ... -0.968
    bearings         (latitude, longitude) float64 39.29 32.81 ... 209.1 216.1
    direc_proj_math  (latitude, longitude) float64 0.8851 0.9981 ... -2.08 -2.2
    wind_proj_mask   (time, latitude, longitude) float64 1.145 1.234 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;101&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 102, coords = (array(167.80100756), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;102&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_102_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 3.109 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -0.4786 ... 0.7307
    uw2              (time, latitude, longitude) float32 9.113 9.663 ... 0.4108
    vw2              (time, latitude, longitude) float32 0.229 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.109 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 1.298 1.369 ... -0.9658
    bearings         (latitude, longitude) float64 34.14 26.83 ... 207.7 214.8
    direc_proj_math  (latitude, longitude) float64 0.9749 1.102 ... -2.179
    wind_proj_mask   (time, latitude, longitude) float64 1.298 1.369 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;102&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 103, coords = (array(167.86146096), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;103&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_103_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 3.109 ... 0.6409
    vgrd10m          (time, latitude, longitude) float32 -0.4786 ... 0.7307
    uw2              (time, latitude, longitude) float32 9.113 9.663 ... 0.4108
    vw2              (time, latitude, longitude) float32 0.229 ... 0.5339
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.109 ... 0.9719
    wind_proj        (time, latitude, longitude) float64 1.36 1.441 ... -0.9631
    bearings         (latitude, longitude) float64 35.44 28.33 ... 206.2 213.5
    direc_proj_math  (latitude, longitude) float64 0.9523 1.076 ... -2.156
    wind_proj_mask   (time, latitude, longitude) float64 1.36 1.441 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;103&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 104, coords = (array(167.92191436), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;104&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_104_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 3.109 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.4786 ... 1.066
    uw2              (time, latitude, longitude) float32 9.113 9.663 ... 1.114
    vw2              (time, latitude, longitude) float32 0.229 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.109 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.42 1.511 ... -1.492
    bearings         (latitude, longitude) float64 36.69 29.79 ... 212.2 218.7
    direc_proj_math  (latitude, longitude) float64 0.9304 1.051 ... -2.245
    wind_proj_mask   (time, latitude, longitude) float64 1.42 1.511 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;104&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 105, coords = (array(167.98236776), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;105&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_105_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 3.109 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.4786 ... 1.066
    uw2              (time, latitude, longitude) float32 9.113 9.663 ... 1.114
    vw2              (time, latitude, longitude) float32 0.229 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.109 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.477 1.578 ... -1.488
    bearings         (latitude, longitude) float64 37.91 31.2 ... 210.8 217.5
    direc_proj_math  (latitude, longitude) float64 0.9091 1.026 ... -2.225
    wind_proj_mask   (time, latitude, longitude) float64 1.477 1.578 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;105&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 106, coords = (array(168.04282116), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;106&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_106_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 3.109 ... 1.055
    vgrd10m          (time, latitude, longitude) float32 -0.4786 ... 1.066
    uw2              (time, latitude, longitude) float32 9.113 9.663 ... 1.114
    vw2              (time, latitude, longitude) float32 0.229 ... 1.137
    wind_magnitude   (time, latitude, longitude) float32 3.056 3.109 ... 1.5
    wind_proj        (time, latitude, longitude) float64 1.532 1.642 ... -1.484
    bearings         (latitude, longitude) float64 39.09 32.58 ... 209.4 216.3
    direc_proj_math  (latitude, longitude) float64 0.8885 1.002 ... -2.204
    wind_proj_mask   (time, latitude, longitude) float64 1.532 1.642 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;106&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 107, coords = (array(168.76826196), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;107&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_107_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.515
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.69
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 2.294
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.856
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 2.269
    wind_proj        (time, latitude, longitude) float64 2.494 2.507 ... -2.249
    bearings         (latitude, longitude) float64 34.79 27.57 ... 206.9 214.2
    direc_proj_math  (latitude, longitude) float64 0.9637 1.09 ... -2.041 -2.168
    wind_proj_mask   (time, latitude, longitude) float64 2.494 2.507 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;107&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 108, coords = (array(168.82871537), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;108&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_108_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.175
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.551
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 1.381
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.406
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 1.946
    wind_proj        (time, latitude, longitude) float64 2.541 2.562 ... -1.945
    bearings         (latitude, longitude) float64 36.06 29.05 ... 212.9 219.2
    direc_proj_math  (latitude, longitude) float64 0.9414 1.064 ... -2.255
    wind_proj_mask   (time, latitude, longitude) float64 2.541 2.562 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;108&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 109, coords = (array(169.19143577), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;109&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_109_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.1 2.97 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.209 1.508 ... 0.5469
    uw2              (time, latitude, longitude) float32 9.61 8.819 ... 0.05423
    vw2              (time, latitude, longitude) float32 1.462 2.275 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.327 3.331 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.834 2.799 ... -0.5736
    bearings         (latitude, longitude) float64 37.09 30.25 ... 211.8 218.3
    direc_proj_math  (latitude, longitude) float64 0.9234 1.043 ... -2.239
    wind_proj_mask   (time, latitude, longitude) float64 2.834 2.799 ... -0.5736
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;109&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 110, coords = (array(169.25188917), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;110&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_110_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.1 2.97 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.209 1.508 ... 0.5469
    uw2              (time, latitude, longitude) float32 9.61 8.819 ... 0.05423
    vw2              (time, latitude, longitude) float32 1.462 2.275 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.327 3.331 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.87 2.842 ... -0.5767
    bearings         (latitude, longitude) float64 38.3 31.65 ... 210.4 217.1
    direc_proj_math  (latitude, longitude) float64 0.9024 1.018 ... -2.218
    wind_proj_mask   (time, latitude, longitude) float64 2.87 2.842 ... -0.5767
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;110&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 111, coords = (array(169.31234257), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;111&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_111_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.1 2.97 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.209 1.508 ... 0.5469
    uw2              (time, latitude, longitude) float32 9.61 8.819 ... 0.05423
    vw2              (time, latitude, longitude) float32 1.462 2.275 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.327 3.331 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.904 2.883 ... -0.5796
    bearings         (latitude, longitude) float64 39.47 33.02 ... 208.9 215.9
    direc_proj_math  (latitude, longitude) float64 0.882 0.9945 ... -2.197
    wind_proj_mask   (time, latitude, longitude) float64 2.904 2.883 ... -0.5796
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;111&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 112, coords = (array(169.37279597), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;112&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_112_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 168.1 168.4 168.8 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 2.809 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.508 1.69 ... 0.5469
    uw2              (time, latitude, longitude) float32 8.819 7.893 ... 0.05423
    vw2              (time, latitude, longitude) float32 2.275 2.856 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.331 3.278 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.921 2.783 ... -0.5824
    bearings         (latitude, longitude) float64 34.35 27.07 ... 207.4 214.6
    direc_proj_math  (latitude, longitude) float64 0.9714 1.098 ... -2.05 -2.175
    wind_proj_mask   (time, latitude, longitude) float64 2.921 2.783 ... -0.5824
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;112&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 113, coords = (array(169.43324937), array(-46.66703435)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;113&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_113_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 168.1 168.4 168.8 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 2.809 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.508 1.69 ... 0.5469
    uw2              (time, latitude, longitude) float32 8.819 7.893 ... 0.05423
    vw2              (time, latitude, longitude) float32 2.275 2.856 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.331 3.278 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.956 2.827 ... -0.5849
    bearings         (latitude, longitude) float64 35.63 28.56 ... 205.9 213.3
    direc_proj_math  (latitude, longitude) float64 0.9489 1.072 ... -2.152
    wind_proj_mask   (time, latitude, longitude) float64 2.956 2.827 ... -0.5849
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;113&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 114, coords = (array(168.22418136), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;114&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_114_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.109 3.179 ... 1.416
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... 1.455
    uw2              (time, latitude, longitude) float32 9.663 10.11 ... 2.006
    vw2              (time, latitude, longitude) float32 0.001479 ... 2.117
    wind_magnitude   (time, latitude, longitude) float32 3.109 3.203 ... 2.031
    wind_proj        (time, latitude, longitude) float64 1.779 1.871 ... -2.025
    bearings         (latitude, longitude) float64 35.61 28.76 ... 213.3 219.8
    direc_proj_math  (latitude, longitude) float64 0.9493 1.069 ... -2.266
    wind_proj_mask   (time, latitude, longitude) float64 1.779 1.871 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;114&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 115, coords = (array(168.28463476), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;115&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_115_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.109 3.179 ... 1.416
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... 1.455
    uw2              (time, latitude, longitude) float32 9.663 10.11 ... 2.006
    vw2              (time, latitude, longitude) float32 0.001479 ... 2.117
    wind_magnitude   (time, latitude, longitude) float32 3.109 3.203 ... 2.031
    wind_proj        (time, latitude, longitude) float64 1.832 1.934 ... -2.021
    bearings         (latitude, longitude) float64 36.82 30.16 ... 211.9 218.7
    direc_proj_math  (latitude, longitude) float64 0.9281 1.044 ... -2.246
    wind_proj_mask   (time, latitude, longitude) float64 1.832 1.934 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;115&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 116, coords = (array(168.34508816), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;116&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_116_winds_gradients_12H_tl1.nc
PCs loaded from file
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> ---------------------------------------------------------                         

 Experiment 1 in site 117, coords = (array(168.40554156), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;117&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_117_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.179 ... 1.416
    vgrd10m          (time, latitude, longitude) float32 0.3888 0.8289 ... 1.455
    uw2              (time, latitude, longitude) float32 10.11 10.11 ... 2.006
    vw2              (time, latitude, longitude) float32 0.1512 0.6871 ... 2.117
    wind_magnitude   (time, latitude, longitude) float32 3.203 3.285 ... 2.031
    wind_proj        (time, latitude, longitude) float64 2.051 2.121 ... -2.011
    bearings         (latitude, longitude) float64 32.86 25.6 ... 209.0 216.2
    direc_proj_math  (latitude, longitude) float64 0.9974 1.124 ... -2.203
    wind_proj_mask   (time, latitude, longitude) float64 2.051 2.121 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;117&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 118, coords = (array(168.46599496), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;118&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_118_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.179 ... 1.416
    vgrd10m          (time, latitude, longitude) float32 0.3888 0.8289 ... 1.455
    uw2              (time, latitude, longitude) float32 10.11 10.11 ... 2.006
    vw2              (time, latitude, longitude) float32 0.1512 0.6871 ... 2.117
    wind_magnitude   (time, latitude, longitude) float32 3.203 3.285 ... 2.031
    wind_proj        (time, latitude, longitude) float64 2.106 2.185 ... -2.004
    bearings         (latitude, longitude) float64 34.15 27.08 ... 207.5 214.9
    direc_proj_math  (latitude, longitude) float64 0.9748 1.098 ... -2.051 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 2.106 2.185 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;118&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 119, coords = (array(168.52644836), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;119&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_119_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.179 ... 1.515
    vgrd10m          (time, latitude, longitude) float32 0.3888 0.8289 ... 1.69
    uw2              (time, latitude, longitude) float32 10.11 10.11 ... 2.294
    vw2              (time, latitude, longitude) float32 0.1512 0.6871 ... 2.856
    wind_magnitude   (time, latitude, longitude) float32 3.203 3.285 ... 2.269
    wind_proj        (time, latitude, longitude) float64 2.158 2.246 ... -2.268
    bearings         (latitude, longitude) float64 35.4 28.52 ... 213.6 220.0
    direc_proj_math  (latitude, longitude) float64 0.9529 1.073 ... -2.269
    wind_proj_mask   (time, latitude, longitude) float64 2.158 2.246 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;119&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 120, coords = (array(168.58690176), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;120&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_120_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.179 ... 1.515
    vgrd10m          (time, latitude, longitude) float32 0.3888 0.8289 ... 1.69
    uw2              (time, latitude, longitude) float32 10.11 10.11 ... 2.294
    vw2              (time, latitude, longitude) float32 0.1512 0.6871 ... 2.856
    wind_magnitude   (time, latitude, longitude) float32 3.203 3.285 ... 2.269
    wind_proj        (time, latitude, longitude) float64 2.208 2.304 ... -2.266
    bearings         (latitude, longitude) float64 36.62 29.93 ... 212.2 218.9
    direc_proj_math  (latitude, longitude) float64 0.9317 1.048 ... -2.249
    wind_proj_mask   (time, latitude, longitude) float64 2.208 2.304 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;120&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 121, coords = (array(168.64735516), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;121&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_121_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.179 ... 1.515
    vgrd10m          (time, latitude, longitude) float32 0.3888 0.8289 ... 1.69
    uw2              (time, latitude, longitude) float32 10.11 10.11 ... 2.294
    vw2              (time, latitude, longitude) float32 0.1512 0.6871 ... 2.856
    wind_magnitude   (time, latitude, longitude) float32 3.203 3.285 ... 2.269
    wind_proj        (time, latitude, longitude) float64 2.256 2.36 ... -2.263
    bearings         (latitude, longitude) float64 37.8 31.3 ... 210.8 217.7
    direc_proj_math  (latitude, longitude) float64 0.911 1.025 ... -2.108 -2.228
    wind_proj_mask   (time, latitude, longitude) float64 2.256 2.36 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;121&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 122, coords = (array(168.76826196), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;122&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_122_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.515
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.69
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 2.294
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.856
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 2.269
    wind_proj        (time, latitude, longitude) float64 2.462 2.478 ... -2.254
    bearings         (latitude, longitude) float64 33.93 26.83 ... 207.8 215.1
    direc_proj_math  (latitude, longitude) float64 0.9786 1.103 ... -2.184
    wind_proj_mask   (time, latitude, longitude) float64 2.462 2.478 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;122&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 123, coords = (array(169.43324937), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;123&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_123_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 168.1 168.4 168.8 ... 170.0 170.3 170.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 2.809 ... 0.2329
    vgrd10m          (time, latitude, longitude) float32 1.508 1.69 ... 0.5469
    uw2              (time, latitude, longitude) float32 8.819 7.893 ... 0.05423
    vw2              (time, latitude, longitude) float32 2.275 2.856 ... 0.2991
    wind_magnitude   (time, latitude, longitude) float32 3.331 3.278 ... 0.5944
    wind_proj        (time, latitude, longitude) float64 2.932 2.805 ... -0.5831
    bearings         (latitude, longitude) float64 34.77 27.79 ... 206.7 214.3
    direc_proj_math  (latitude, longitude) float64 0.964 1.086 ... -2.037 -2.169
    wind_proj_mask   (time, latitude, longitude) float64 2.932 2.805 ... -0.5831
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;123&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 124, coords = (array(169.49370277), array(-46.62520765)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;124&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_124_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.74 -45.43
  * longitude        (longitude) float32 168.1 168.4 168.8 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 2.809 ... -0.8332
    vgrd10m          (time, latitude, longitude) float32 1.508 1.69 ... -1.361
    uw2              (time, latitude, longitude) float32 8.819 7.893 ... 0.6942
    vw2              (time, latitude, longitude) float32 2.275 2.856 ... 1.852
    wind_magnitude   (time, latitude, longitude) float32 3.331 3.278 ... 1.596
    wind_proj        (time, latitude, longitude) float64 2.966 2.846 ... 1.58
    bearings         (latitude, longitude) float64 36.0 29.22 ... 212.9 219.5
    direc_proj_math  (latitude, longitude) float64 0.9424 1.061 ... -2.259
    wind_proj_mask   (time, latitude, longitude) float64 2.966 2.846 ... 1.58
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;124&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 125, coords = (array(168.22418136), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;125&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_125_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.109 3.179 ... 1.092
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... 1.459
    uw2              (time, latitude, longitude) float32 9.663 10.11 ... 1.192
    vw2              (time, latitude, longitude) float32 0.001479 ... 2.129
    wind_magnitude   (time, latitude, longitude) float32 3.109 3.203 ... 1.822
    wind_proj        (time, latitude, longitude) float64 1.741 1.837 ... -1.821
    bearings         (latitude, longitude) float64 34.77 28.02 ... 208.3 214.3
    direc_proj_math  (latitude, longitude) float64 0.9639 1.082 ... -2.169
    wind_proj_mask   (time, latitude, longitude) float64 1.741 1.837 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;125&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 126, coords = (array(168.64735516), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;126&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_126_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.179 ... 1.455
    vgrd10m          (time, latitude, longitude) float32 0.3888 0.8289 ... 1.692
    uw2              (time, latitude, longitude) float32 10.11 10.11 ... 2.117
    vw2              (time, latitude, longitude) float32 0.1512 0.6871 ... 2.863
    wind_magnitude   (time, latitude, longitude) float32 3.203 3.285 ... 2.232
    wind_proj        (time, latitude, longitude) float64 2.221 2.328 ... -2.207
    bearings         (latitude, longitude) float64 36.94 30.52 ... 205.9 212.2
    direc_proj_math  (latitude, longitude) float64 0.926 1.038 ... -2.023 -2.133
    wind_proj_mask   (time, latitude, longitude) float64 2.221 2.328 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;126&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 127, coords = (array(168.70780856), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;127&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_127_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.455
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.692
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 2.117
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.863
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 2.232
    wind_proj        (time, latitude, longitude) float64 2.381 2.392 ... -2.2
    bearings         (latitude, longitude) float64 31.83 24.66 ... 204.6 211.1
    direc_proj_math  (latitude, longitude) float64 1.015 1.14 ... -2.0 -2.113
    wind_proj_mask   (time, latitude, longitude) float64 2.381 2.392 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;127&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 128, coords = (array(168.76826196), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;128&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_128_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.179 3.1 ... 1.455
    vgrd10m          (time, latitude, longitude) float32 0.8289 1.209 ... 1.692
    uw2              (time, latitude, longitude) float32 10.11 9.61 ... 2.117
    vw2              (time, latitude, longitude) float32 0.6871 1.462 ... 2.863
    wind_magnitude   (time, latitude, longitude) float32 3.285 3.327 ... 2.232
    wind_proj        (time, latitude, longitude) float64 2.431 2.451 ... -2.192
    bearings         (latitude, longitude) float64 33.11 26.12 ... 203.3 209.9
    direc_proj_math  (latitude, longitude) float64 0.9929 1.115 ... -2.093
    wind_proj_mask   (time, latitude, longitude) float64 2.431 2.451 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;128&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 129, coords = (array(169.49370277), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;129&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_129_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.1 168.4 168.8 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 2.809 ... -0.5384
    vgrd10m          (time, latitude, longitude) float32 1.508 1.69 ... -0.4764
    uw2              (time, latitude, longitude) float32 8.819 7.893 ... 0.2899
    vw2              (time, latitude, longitude) float32 2.275 2.856 ... 0.227
    wind_magnitude   (time, latitude, longitude) float32 3.331 3.278 ... 0.7189
    wind_proj        (time, latitude, longitude) float64 2.943 2.825 ... 0.6958
    bearings         (latitude, longitude) float64 35.16 28.47 ... 207.8 213.9
    direc_proj_math  (latitude, longitude) float64 0.9571 1.074 ... -2.163
    wind_proj_mask   (time, latitude, longitude) float64 2.943 2.825 ... 0.6958
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;129&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 130, coords = (array(169.55415617), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;130&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_130_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.1 168.4 168.8 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 2.809 ... -0.5384
    vgrd10m          (time, latitude, longitude) float32 1.508 1.69 ... -0.4764
    uw2              (time, latitude, longitude) float32 8.819 7.893 ... 0.2899
    vw2              (time, latitude, longitude) float32 2.275 2.856 ... 0.227
    wind_magnitude   (time, latitude, longitude) float32 3.331 3.278 ... 0.7189
    wind_proj        (time, latitude, longitude) float64 2.975 2.864 ... 0.6922
    bearings         (latitude, longitude) float64 36.35 29.84 ... 206.6 212.8
    direc_proj_math  (latitude, longitude) float64 0.9363 1.05 ... -2.035 -2.144
    wind_proj_mask   (time, latitude, longitude) float64 2.975 2.864 ... 0.6922
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;130&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 131, coords = (array(169.61460957), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;131&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_131_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.1 168.4 168.8 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 2.809 ... -0.5384
    vgrd10m          (time, latitude, longitude) float32 1.508 1.69 ... -0.4764
    uw2              (time, latitude, longitude) float32 8.819 7.893 ... 0.2899
    vw2              (time, latitude, longitude) float32 2.275 2.856 ... 0.227
    wind_magnitude   (time, latitude, longitude) float32 3.331 3.278 ... 0.7189
    wind_proj        (time, latitude, longitude) float64 3.005 2.9 ... 0.6882
    bearings         (latitude, longitude) float64 37.51 31.17 ... 205.3 211.7
    direc_proj_math  (latitude, longitude) float64 0.9162 1.027 ... -2.124
    wind_proj_mask   (time, latitude, longitude) float64 3.005 2.9 ... 0.6882
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;131&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 132, coords = (array(169.67506297), array(-46.58334861)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;132&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_132_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 2.698 ... -0.5384
    vgrd10m          (time, latitude, longitude) float32 1.69 1.628 ... -0.4764
    uw2              (time, latitude, longitude) float32 7.893 7.281 ... 0.2899
    vw2              (time, latitude, longitude) float32 2.856 2.65 ... 0.227
    wind_magnitude   (time, latitude, longitude) float32 3.278 3.151 ... 0.7189
    wind_proj        (time, latitude, longitude) float64 2.934 2.628 ... 0.6838
    bearings         (latitude, longitude) float64 32.47 25.39 ... 203.9 210.5
    direc_proj_math  (latitude, longitude) float64 1.004 1.128 ... -1.989 -2.103
    wind_proj_mask   (time, latitude, longitude) float64 2.934 2.628 ... 0.6838
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;132&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 133, coords = (array(168.22418136), array(-46.54145722)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;133&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_133_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.109 3.179 ... 1.092
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... 1.459
    uw2              (time, latitude, longitude) float32 9.663 10.11 ... 1.192
    vw2              (time, latitude, longitude) float32 0.001479 ... 2.129
    wind_magnitude   (time, latitude, longitude) float32 3.109 3.203 ... 1.822
    wind_proj        (time, latitude, longitude) float64 1.705 1.804 ... -1.822
    bearings         (latitude, longitude) float64 33.97 27.31 ... 209.0 215.1
    direc_proj_math  (latitude, longitude) float64 0.978 1.094 ... -2.076 -2.183
    wind_proj_mask   (time, latitude, longitude) float64 1.705 1.804 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;133&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 134, coords = (array(169.67506297), array(-46.54145722)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;134&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_134_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 2.698 ... -0.5384
    vgrd10m          (time, latitude, longitude) float32 1.69 1.628 ... -0.4764
    uw2              (time, latitude, longitude) float32 7.893 7.281 ... 0.2899
    vw2              (time, latitude, longitude) float32 2.856 2.65 ... 0.227
    wind_magnitude   (time, latitude, longitude) float32 3.278 3.151 ... 0.7189
    wind_proj        (time, latitude, longitude) float64 2.914 2.607 ... 0.6866
    bearings         (latitude, longitude) float64 31.69 24.73 ... 204.6 211.2
    direc_proj_math  (latitude, longitude) float64 1.018 1.139 ... -2.0 -2.116
    wind_proj_mask   (time, latitude, longitude) float64 2.914 2.607 ... 0.6866
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;134&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 135, coords = (array(169.73551637), array(-46.54145722)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;135&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_135_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 2.698 ... -0.5384
    vgrd10m          (time, latitude, longitude) float32 1.69 1.628 ... -0.4764
    uw2              (time, latitude, longitude) float32 7.893 7.281 ... 0.2899
    vw2              (time, latitude, longitude) float32 2.856 2.65 ... 0.227
    wind_magnitude   (time, latitude, longitude) float32 3.278 3.151 ... 0.7189
    wind_proj        (time, latitude, longitude) float64 2.946 2.65 ... 0.6819
    bearings         (latitude, longitude) float64 32.94 26.14 ... 203.2 210.0
    direc_proj_math  (latitude, longitude) float64 0.9959 1.115 ... -2.095
    wind_proj_mask   (time, latitude, longitude) float64 2.946 2.65 ... 0.6819
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;135&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 136, coords = (array(168.22418136), array(-46.49953348)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;136&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_136_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.109 3.179 ... 1.092
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... 1.459
    uw2              (time, latitude, longitude) float32 9.663 10.11 ... 1.192
    vw2              (time, latitude, longitude) float32 0.001479 ... 2.129
    wind_magnitude   (time, latitude, longitude) float32 3.109 3.203 ... 1.822
    wind_proj        (time, latitude, longitude) float64 1.67 1.773 ... -1.822
    bearings         (latitude, longitude) float64 33.2 26.64 ... 209.7 215.9
    direc_proj_math  (latitude, longitude) float64 0.9914 1.106 ... -2.197
    wind_proj_mask   (time, latitude, longitude) float64 1.67 1.773 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;136&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 137, coords = (array(169.73551637), array(-46.49953348)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;137&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_137_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.3 170.6 170.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 2.698 ... -0.5384
    vgrd10m          (time, latitude, longitude) float32 1.69 1.628 ... -0.4764
    uw2              (time, latitude, longitude) float32 7.893 7.281 ... 0.2899
    vw2              (time, latitude, longitude) float32 2.856 2.65 ... 0.227
    wind_magnitude   (time, latitude, longitude) float32 3.278 3.151 ... 0.7189
    wind_proj        (time, latitude, longitude) float64 2.927 2.631 ... 0.6849
    bearings         (latitude, longitude) float64 32.18 25.49 ... 203.8 210.8
    direc_proj_math  (latitude, longitude) float64 1.009 1.126 ... -1.987 -2.108
    wind_proj_mask   (time, latitude, longitude) float64 2.927 2.631 ... 0.6849
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;137&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 138, coords = (array(169.79596977), array(-46.49953348)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;138&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_138_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 2.698 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 1.69 1.628 ... -2.767
    uw2              (time, latitude, longitude) float32 7.893 7.281 ... 2.878
    vw2              (time, latitude, longitude) float32 2.856 2.65 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.278 3.151 ... 3.245
    wind_proj        (time, latitude, longitude) float64 2.957 2.671 ... 3.237
    bearings         (latitude, longitude) float64 33.38 26.84 ... 209.5 215.7
    direc_proj_math  (latitude, longitude) float64 0.9882 1.102 ... -2.194
    wind_proj_mask   (time, latitude, longitude) float64 2.957 2.671 ... 3.237
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;138&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 139, coords = (array(168.16372796), array(-46.4575774)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;139&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_139_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.109 3.179 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... 1.335
    uw2              (time, latitude, longitude) float32 9.663 10.11 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.001479 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 3.109 3.203 ... 1.486
    wind_proj        (time, latitude, longitude) float64 1.581 1.68 ... -1.478
    bearings         (latitude, longitude) float64 31.27 24.66 ... 204.7 211.8
    direc_proj_math  (latitude, longitude) float64 1.025 1.14 ... -2.003 -2.126
    wind_proj_mask   (time, latitude, longitude) float64 1.581 1.68 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;139&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 140, coords = (array(168.22418136), array(-46.4575774)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;140&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_140_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.109 3.179 ... 1.092
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... 1.459
    uw2              (time, latitude, longitude) float32 9.663 10.11 ... 1.192
    vw2              (time, latitude, longitude) float32 0.001479 ... 2.129
    wind_magnitude   (time, latitude, longitude) float32 3.109 3.203 ... 1.822
    wind_proj        (time, latitude, longitude) float64 1.636 1.743 ... -1.822
    bearings         (latitude, longitude) float64 32.46 25.99 ... 210.5 216.8
    direc_proj_math  (latitude, longitude) float64 1.004 1.117 ... -2.103 -2.212
    wind_proj_mask   (time, latitude, longitude) float64 1.636 1.743 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;140&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 141, coords = (array(169.79596977), array(-46.4575774)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;141&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_141_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 2.698 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 1.69 1.628 ... -2.767
    uw2              (time, latitude, longitude) float32 7.893 7.281 ... 2.878
    vw2              (time, latitude, longitude) float32 2.856 2.65 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.278 3.151 ... 3.245
    wind_proj        (time, latitude, longitude) float64 2.938 2.652 ... 3.233
    bearings         (latitude, longitude) float64 32.64 26.2 ... 210.3 216.6
    direc_proj_math  (latitude, longitude) float64 1.001 1.114 ... -2.1 -2.209
    wind_proj_mask   (time, latitude, longitude) float64 2.938 2.652 ... 3.233
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;141&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 142, coords = (array(169.85642317), array(-46.4575774)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;142&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_142_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.93 -47.61 -47.3 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 2.698 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 1.69 1.628 ... -2.767
    uw2              (time, latitude, longitude) float32 7.893 7.281 ... 2.878
    vw2              (time, latitude, longitude) float32 2.856 2.65 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.278 3.151 ... 3.245
    wind_proj        (time, latitude, longitude) float64 2.967 2.69 ... 3.238
    bearings         (latitude, longitude) float64 33.79 27.5 ... 209.0 215.4
    direc_proj_math  (latitude, longitude) float64 0.981 1.091 ... -2.076 -2.189
    wind_proj_mask   (time, latitude, longitude) float64 2.967 2.69 ... 3.238
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;142&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 143, coords = (array(167.68010076), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;143&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_143_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... 0.2692
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.395
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.07246
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.946
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.421
    wind_proj        (time, latitude, longitude) float64 1.241 1.425 ... -1.286
    bearings         (latitude, longitude) float64 39.64 32.84 ... 209.5 216.1
    direc_proj_math  (latitude, longitude) float64 0.879 0.9976 ... -2.201
    wind_proj_mask   (time, latitude, longitude) float64 1.241 1.425 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;143&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 144, coords = (array(167.74055416), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;144&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_144_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... 0.2692
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.395
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.07246
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.946
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.421
    wind_proj        (time, latitude, longitude) float64 1.288 1.481 ... -1.298
    bearings         (latitude, longitude) float64 40.82 34.24 ... 208.1 214.9
    direc_proj_math  (latitude, longitude) float64 0.8583 0.9731 ... -2.18
    wind_proj_mask   (time, latitude, longitude) float64 1.288 1.481 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;144&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 145, coords = (array(167.80100756), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;145&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_145_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.72 2.899 ... 0.2692
    vgrd10m          (time, latitude, longitude) float32 -0.05982 ... 1.395
    uw2              (time, latitude, longitude) float32 7.397 8.405 ... 0.07246
    vw2              (time, latitude, longitude) float32 0.003578 ... 1.946
    wind_magnitude   (time, latitude, longitude) float32 2.72 2.927 ... 1.421
    wind_proj        (time, latitude, longitude) float64 1.535 1.718 ... -1.31
    bearings         (latitude, longitude) float64 35.6 28.1 ... 206.7 213.7
    direc_proj_math  (latitude, longitude) float64 0.9494 1.08 ... -2.036 -2.159
    wind_proj_mask   (time, latitude, longitude) float64 1.535 1.718 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;145&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 146, coords = (array(167.86146096), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;146&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_146_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.72 2.899 ... 0.2692
    vgrd10m          (time, latitude, longitude) float32 -0.05982 ... 1.395
    uw2              (time, latitude, longitude) float32 7.397 8.405 ... 0.07246
    vw2              (time, latitude, longitude) float32 0.003578 ... 1.946
    wind_magnitude   (time, latitude, longitude) float32 2.72 2.927 ... 1.421
    wind_proj        (time, latitude, longitude) float64 1.586 1.781 ... -1.322
    bearings         (latitude, longitude) float64 36.92 29.65 ... 205.2 212.4
    direc_proj_math  (latitude, longitude) float64 0.9264 1.053 ... -2.136
    wind_proj_mask   (time, latitude, longitude) float64 1.586 1.781 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;146&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 147, coords = (array(167.92191436), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;147&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_147_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.72 2.899 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 -0.05982 ... 1.335
    uw2              (time, latitude, longitude) float32 7.397 8.405 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.003578 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 2.72 2.927 ... 1.486
    wind_proj        (time, latitude, longitude) float64 1.635 1.841 ... -1.456
    bearings         (latitude, longitude) float64 38.2 31.14 ... 211.1 217.5
    direc_proj_math  (latitude, longitude) float64 0.9041 1.027 ... -2.225
    wind_proj_mask   (time, latitude, longitude) float64 1.635 1.841 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;147&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 148, coords = (array(167.98236776), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;148&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_148_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.72 2.899 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 -0.05982 ... 1.335
    uw2              (time, latitude, longitude) float32 7.397 8.405 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.003578 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 2.72 2.927 ... 1.486
    wind_proj        (time, latitude, longitude) float64 1.681 1.898 ... -1.462
    bearings         (latitude, longitude) float64 39.43 32.6 ... 209.7 216.3
    direc_proj_math  (latitude, longitude) float64 0.8826 1.002 ... -2.09 -2.204
    wind_proj_mask   (time, latitude, longitude) float64 1.681 1.898 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;148&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 149, coords = (array(168.04282116), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;149&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_149_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.72 2.899 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 -0.05982 ... 1.335
    uw2              (time, latitude, longitude) float32 7.397 8.405 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.003578 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 2.72 2.927 ... 1.486
    wind_proj        (time, latitude, longitude) float64 1.725 1.953 ... -1.467
    bearings         (latitude, longitude) float64 40.63 34.01 ... 208.3 215.1
    direc_proj_math  (latitude, longitude) float64 0.8617 0.9772 ... -2.184
    wind_proj_mask   (time, latitude, longitude) float64 1.725 1.953 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;149&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 150, coords = (array(168.10327456), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;150&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_150_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.899 3.079 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 0.3995 0.8695 ... 1.335
    uw2              (time, latitude, longitude) float32 8.405 9.478 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.1596 0.7561 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 2.927 3.199 ... 1.486
    wind_proj        (time, latitude, longitude) float64 2.004 2.207 ... -1.472
    bearings         (latitude, longitude) float64 35.38 27.84 ... 206.9 213.9
    direc_proj_math  (latitude, longitude) float64 0.9534 1.085 ... -2.162
    wind_proj_mask   (time, latitude, longitude) float64 2.004 2.207 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;150&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 151, coords = (array(168.16372796), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;151&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_151_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.899 3.079 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 0.3995 0.8695 ... 1.335
    uw2              (time, latitude, longitude) float32 8.405 9.478 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.1596 0.7561 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 2.927 3.199 ... 1.486
    wind_proj        (time, latitude, longitude) float64 2.053 2.268 ... -1.476
    bearings         (latitude, longitude) float64 36.7 29.39 ... 205.5 212.6
    direc_proj_math  (latitude, longitude) float64 0.9302 1.058 ... -2.015 -2.14
    wind_proj_mask   (time, latitude, longitude) float64 2.053 2.268 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;151&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 152, coords = (array(169.85642317), array(-46.41558896)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;152&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_152_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.059 2.859 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 2.06 1.859 ... -2.767
    uw2              (time, latitude, longitude) float32 9.36 8.171 ... 2.878
    vw2              (time, latitude, longitude) float32 4.242 3.455 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.688 3.41 ... 3.245
    wind_proj        (time, latitude, longitude) float64 3.534 3.105 ... 3.234
    bearings         (latitude, longitude) float64 39.41 32.58 ... 209.8 216.3
    direc_proj_math  (latitude, longitude) float64 0.8829 1.002 ... -2.09 -2.205
    wind_proj_mask   (time, latitude, longitude) float64 3.534 3.105 ... 3.234
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;152&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 153, coords = (array(167.68010076), array(-46.37356816)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;153&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_153_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... 0.2692
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.395
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.07246
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.946
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.421
    wind_proj        (time, latitude, longitude) float64 1.203 1.389 ... -1.276
    bearings         (latitude, longitude) float64 38.69 31.96 ... 210.3 217.0
    direc_proj_math  (latitude, longitude) float64 0.8956 1.013 ... -2.1 -2.217
    wind_proj_mask   (time, latitude, longitude) float64 1.203 1.389 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;153&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 154, coords = (array(168.04282116), array(-46.37356816)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;154&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_154_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.72 2.899 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 -0.05982 ... 1.335
    uw2              (time, latitude, longitude) float32 7.397 8.405 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.003578 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 2.72 2.927 ... 1.486
    wind_proj        (time, latitude, longitude) float64 1.69 1.919 ... -1.463
    bearings         (latitude, longitude) float64 39.67 33.12 ... 209.2 216.0
    direc_proj_math  (latitude, longitude) float64 0.8785 0.9928 ... -2.08 -2.2
    wind_proj_mask   (time, latitude, longitude) float64 1.69 1.919 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;154&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 155, coords = (array(168.10327456), array(-46.37356816)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;155&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_155_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.899 3.079 ... 0.6516
    vgrd10m          (time, latitude, longitude) float32 0.3995 0.8695 ... 1.335
    uw2              (time, latitude, longitude) float32 8.405 9.478 ... 0.4246
    vw2              (time, latitude, longitude) float32 0.1596 0.7561 ... 1.783
    wind_magnitude   (time, latitude, longitude) float32 2.927 3.199 ... 1.486
    wind_proj        (time, latitude, longitude) float64 1.97 2.174 ... -1.468
    bearings         (latitude, longitude) float64 34.47 27.05 ... 207.7 214.8
    direc_proj_math  (latitude, longitude) float64 0.9693 1.099 ... -2.178
    wind_proj_mask   (time, latitude, longitude) float64 1.97 2.174 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;155&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 156, coords = (array(169.85642317), array(-46.37356816)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;156&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_156_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.059 2.859 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 2.06 1.859 ... -2.767
    uw2              (time, latitude, longitude) float32 9.36 8.171 ... 2.878
    vw2              (time, latitude, longitude) float32 4.242 3.455 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.688 3.41 ... 3.245
    wind_proj        (time, latitude, longitude) float64 3.516 3.084 ... 3.229
    bearings         (latitude, longitude) float64 38.46 31.7 ... 210.6 217.2
    direc_proj_math  (latitude, longitude) float64 0.8995 1.017 ... -2.221
    wind_proj_mask   (time, latitude, longitude) float64 3.516 3.084 ... 3.229
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;156&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 157, coords = (array(169.91687657), array(-46.37356816)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;157&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_157_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.059 2.859 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 2.06 1.859 ... -2.767
    uw2              (time, latitude, longitude) float32 9.36 8.171 ... 2.878
    vw2              (time, latitude, longitude) float32 4.242 3.455 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.688 3.41 ... 3.245
    wind_proj        (time, latitude, longitude) float64 3.538 3.118 ... 3.235
    bearings         (latitude, longitude) float64 39.65 33.09 ... 209.2 216.0
    direc_proj_math  (latitude, longitude) float64 0.8788 0.9932 ... -2.08 -2.2
    wind_proj_mask   (time, latitude, longitude) float64 3.538 3.118 ... 3.235
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;157&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 158, coords = (array(167.68010076), array(-46.33151501)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;158&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_158_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... 0.2692
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.395
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.07246
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.946
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.421
    wind_proj        (time, latitude, longitude) float64 1.166 1.355 ... -1.265
    bearings         (latitude, longitude) float64 37.77 31.13 ... 211.2 218.0
    direc_proj_math  (latitude, longitude) float64 0.9115 1.028 ... -2.234
    wind_proj_mask   (time, latitude, longitude) float64 1.166 1.355 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;158&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 159, coords = (array(169.91687657), array(-46.33151501)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;159&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_159_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 168.4 168.8 169.1 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.059 2.859 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 2.06 1.859 ... -2.767
    uw2              (time, latitude, longitude) float32 9.36 8.171 ... 2.878
    vw2              (time, latitude, longitude) float32 4.242 3.455 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.688 3.41 ... 3.245
    wind_proj        (time, latitude, longitude) float64 3.521 3.097 ... 3.23
    bearings         (latitude, longitude) float64 38.73 32.24 ... 210.0 217.0
    direc_proj_math  (latitude, longitude) float64 0.8948 1.008 ... -2.216
    wind_proj_mask   (time, latitude, longitude) float64 3.521 3.097 ... 3.23
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;159&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 160, coords = (array(169.97732997), array(-46.33151501)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;160&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_160_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.43 -45.12
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -1.696
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -2.767
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 2.878
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 7.654
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 3.245
    wind_proj        (time, latitude, longitude) float64 3.129 2.553 ... 3.236
    bearings         (latitude, longitude) float64 33.58 26.27 ... 208.6 215.7
    direc_proj_math  (latitude, longitude) float64 0.9848 1.112 ... -2.194
    wind_proj_mask   (time, latitude, longitude) float64 3.129 2.553 ... 3.236
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;160&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 161, coords = (array(167.01511335), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;161&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_161_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.41 2.47 ... -0.047
    vgrd10m          (time, latitude, longitude) float32 -1.459 ... 0.7777
    uw2              (time, latitude, longitude) float32 5.808 ... 0.002209
    vw2              (time, latitude, longitude) float32 2.129 0.9202 ... 0.6048
    wind_magnitude   (time, latitude, longitude) float32 2.817 2.649 ... 0.7791
    wind_proj        (time, latitude, longitude) float64 0.2413 ... -0.6237
    bearings         (latitude, longitude) float64 36.11 29.42 ... 207.2 213.4
    direc_proj_math  (latitude, longitude) float64 0.9406 1.057 ... -2.153
    wind_proj_mask   (time, latitude, longitude) float64 0.2413 0.3778 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;161&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 162, coords = (array(167.07556675), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;162&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_162_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.41 2.47 ... -0.047
    vgrd10m          (time, latitude, longitude) float32 -1.459 ... 0.7777
    uw2              (time, latitude, longitude) float32 5.808 ... 0.002209
    vw2              (time, latitude, longitude) float32 2.129 0.9202 ... 0.6048
    wind_magnitude   (time, latitude, longitude) float32 2.817 2.649 ... 0.7791
    wind_proj        (time, latitude, longitude) float64 0.2993 ... -0.6327
    bearings         (latitude, longitude) float64 37.29 30.79 ... 206.0 212.2
    direc_proj_math  (latitude, longitude) float64 0.9199 1.033 ... -2.133
    wind_proj_mask   (time, latitude, longitude) float64 0.2993 0.4403 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;162&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 163, coords = (array(167.13602015), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;163&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_163_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.47 2.559 ... -0.047
    vgrd10m          (time, latitude, longitude) float32 -0.9593 ... 0.7777
    uw2              (time, latitude, longitude) float32 6.099 ... 0.002209
    vw2              (time, latitude, longitude) float32 0.9202 ... 0.6048
    wind_magnitude   (time, latitude, longitude) float32 2.649 2.609 ... 0.7791
    wind_proj        (time, latitude, longitude) float64 0.5009 ... -0.6417
    bearings         (latitude, longitude) float64 32.12 24.85 ... 204.7 211.1
    direc_proj_math  (latitude, longitude) float64 1.01 1.137 ... -2.001 -2.113
    wind_proj_mask   (time, latitude, longitude) float64 0.5009 0.6143 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;163&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 164, coords = (array(167.19647355), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;164&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_164_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.47 2.559 ... -0.047
    vgrd10m          (time, latitude, longitude) float32 -0.9593 ... 0.7777
    uw2              (time, latitude, longitude) float32 6.099 ... 0.002209
    vw2              (time, latitude, longitude) float32 0.9202 ... 0.6048
    wind_magnitude   (time, latitude, longitude) float32 2.649 2.609 ... 0.7791
    wind_proj        (time, latitude, longitude) float64 0.5596 ... -0.6507
    bearings         (latitude, longitude) float64 33.42 26.33 ... 203.3 209.9
    direc_proj_math  (latitude, longitude) float64 0.9875 1.111 ... -2.093
    wind_proj_mask   (time, latitude, longitude) float64 0.5596 0.6796 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;164&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 165, coords = (array(167.25692695), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;165&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_165_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.47 2.559 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.9593 ... 1.147
    uw2              (time, latitude, longitude) float32 6.099 6.551 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.9202 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.649 2.609 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.6164 ... -0.8773
    bearings         (latitude, longitude) float64 34.68 27.78 ... 208.7 214.6
    direc_proj_math  (latitude, longitude) float64 0.9655 1.086 ... -2.175
    wind_proj_mask   (time, latitude, longitude) float64 0.6164 0.743 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;165&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 166, coords = (array(167.31738035), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;166&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_166_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.47 2.559 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.9593 ... 1.147
    uw2              (time, latitude, longitude) float32 6.099 6.551 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.9202 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.649 2.609 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.6714 ... -0.8913
    bearings         (latitude, longitude) float64 35.9 29.19 ... 207.5 213.5
    direc_proj_math  (latitude, longitude) float64 0.9441 1.061 ... -2.05 -2.156
    wind_proj_mask   (time, latitude, longitude) float64 0.6714 0.8043 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;166&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 167, coords = (array(167.61964736), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;167&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_167_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.02564
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.053
    uw2              (time, latitude, longitude) float32 6.551 ... 0.0006573
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.109
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.054
    wind_proj        (time, latitude, longitude) float64 1.081 1.264 ... -0.8618
    bearings         (latitude, longitude) float64 35.7 28.95 ... 207.7 213.7
    direc_proj_math  (latitude, longitude) float64 0.9477 1.065 ... -2.159
    wind_proj_mask   (time, latitude, longitude) float64 1.081 1.264 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;167&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 168, coords = (array(167.68010076), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;168&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_168_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.02564
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.053
    uw2              (time, latitude, longitude) float32 6.551 ... 0.0006573
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.109
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.054
    wind_proj        (time, latitude, longitude) float64 1.13 1.322 ... -0.8733
    bearings         (latitude, longitude) float64 36.9 30.33 ... 206.4 212.6
    direc_proj_math  (latitude, longitude) float64 0.9268 1.041 ... -2.032 -2.14
    wind_proj_mask   (time, latitude, longitude) float64 1.13 1.322 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;168&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 169, coords = (array(169.97732997), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;169&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_169_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -2.139
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -1.485
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 4.573
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 2.205
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 2.603
    wind_proj        (time, latitude, longitude) float64 3.11 2.531 ... 2.365
    bearings         (latitude, longitude) float64 32.75 25.56 ... 204.0 210.5
    direc_proj_math  (latitude, longitude) float64 0.9993 1.125 ... -1.99 -2.104
    wind_proj_mask   (time, latitude, longitude) float64 3.11 2.531 ... 2.365
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;169&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 170, coords = (array(170.03778338), array(-46.2894295)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;170&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_170_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -2.139
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -1.485
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 4.573
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 2.205
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 2.603
    wind_proj        (time, latitude, longitude) float64 3.14 2.575 ... 2.342
    bearings         (latitude, longitude) float64 34.02 27.03 ... 202.7 209.3
    direc_proj_math  (latitude, longitude) float64 0.977 1.099 ... -1.967 -2.083
    wind_proj_mask   (time, latitude, longitude) float64 3.14 2.575 ... 2.342
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;170&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 171, coords = (array(166.59193955), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;171&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_171_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.8225
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.1771
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.4079 ... -0.4988
    bearings         (latitude, longitude) float64 33.04 26.13 ... 203.5 210.2
    direc_proj_math  (latitude, longitude) float64 0.9941 1.115 ... -2.098
    wind_proj_mask   (time, latitude, longitude) float64 -0.4079 -0.2489 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;171&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 172, coords = (array(166.65239295), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;172&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_172_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.1111
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.5832
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.01234
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.3402
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.5937
    wind_proj        (time, latitude, longitude) float64 -0.342 ... -0.4137
    bearings         (latitude, longitude) float64 34.28 27.53 ... 209.0 215.0
    direc_proj_math  (latitude, longitude) float64 0.9726 1.09 ... -2.077 -2.183
    wind_proj_mask   (time, latitude, longitude) float64 -0.342 -0.1798 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;172&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 173, coords = (array(166.71284635), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;173&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_173_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.1111
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.5832
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.01234
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.3402
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.5937
    wind_proj        (time, latitude, longitude) float64 -0.2777 ... -0.4218
    bearings         (latitude, longitude) float64 35.48 28.91 ... 207.7 213.9
    direc_proj_math  (latitude, longitude) float64 0.9516 1.066 ... -2.163
    wind_proj_mask   (time, latitude, longitude) float64 -0.2777 -0.1123 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;173&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 174, coords = (array(166.77329975), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;174&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_174_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.1111
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.5832
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.01234
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.3402
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.5937
    wind_proj        (time, latitude, longitude) float64 -0.2151 ... -0.43
    bearings         (latitude, longitude) float64 36.64 30.25 ... 206.4 212.8
    direc_proj_math  (latitude, longitude) float64 0.9312 1.043 ... -2.143
    wind_proj_mask   (time, latitude, longitude) float64 -0.2151 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;174&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 175, coords = (array(166.83375315), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;175&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_175_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.41 2.47 ... -0.1111
    vgrd10m          (time, latitude, longitude) float32 -1.459 ... 0.5832
    uw2              (time, latitude, longitude) float32 5.808 6.099 ... 0.01234
    vw2              (time, latitude, longitude) float32 2.129 0.9202 ... 0.3402
    wind_magnitude   (time, latitude, longitude) float32 2.817 2.649 ... 0.5937
    wind_proj        (time, latitude, longitude) float64 0.01781 ... -0.4383
    bearings         (latitude, longitude) float64 31.56 24.44 ... 205.1 211.6
    direc_proj_math  (latitude, longitude) float64 1.02 1.144 ... -2.008 -2.123
    wind_proj_mask   (time, latitude, longitude) float64 0.01781 0.1484 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;175&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 176, coords = (array(166.89420655), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;176&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_176_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.41 2.47 ... -0.1111
    vgrd10m          (time, latitude, longitude) float32 -1.459 ... 0.5832
    uw2              (time, latitude, longitude) float32 5.808 6.099 ... 0.01234
    vw2              (time, latitude, longitude) float32 2.129 0.9202 ... 0.3402
    wind_magnitude   (time, latitude, longitude) float32 2.817 2.649 ... 0.5937
    wind_proj        (time, latitude, longitude) float64 0.08039 ... -0.4466
    bearings         (latitude, longitude) float64 32.83 25.88 ... 203.7 210.4
    direc_proj_math  (latitude, longitude) float64 0.9978 1.119 ... -2.102
    wind_proj_mask   (time, latitude, longitude) float64 0.08039 0.2152 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;176&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 177, coords = (array(166.95465995), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;177&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_177_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.41 2.47 ... -0.047
    vgrd10m          (time, latitude, longitude) float32 -1.459 ... 0.7777
    uw2              (time, latitude, longitude) float32 5.808 ... 0.002209
    vw2              (time, latitude, longitude) float32 2.129 0.9202 ... 0.6048
    wind_magnitude   (time, latitude, longitude) float32 2.817 2.649 ... 0.7791
    wind_proj        (time, latitude, longitude) float64 0.1413 ... -0.6081
    bearings         (latitude, longitude) float64 34.07 27.3 ... 209.2 215.2
    direc_proj_math  (latitude, longitude) float64 0.9762 1.094 ... -2.08 -2.186
    wind_proj_mask   (time, latitude, longitude) float64 0.1413 0.2803 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;177&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 178, coords = (array(167.01511335), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;178&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_178_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.41 2.47 ... -0.047
    vgrd10m          (time, latitude, longitude) float32 -1.459 ... 0.7777
    uw2              (time, latitude, longitude) float32 5.808 ... 0.002209
    vw2              (time, latitude, longitude) float32 2.129 0.9202 ... 0.6048
    wind_magnitude   (time, latitude, longitude) float32 2.817 2.649 ... 0.7791
    wind_proj        (time, latitude, longitude) float64 0.2005 ... -0.6173
    bearings         (latitude, longitude) float64 35.28 28.68 ... 207.9 214.1
    direc_proj_math  (latitude, longitude) float64 0.9551 1.07 ... -2.058 -2.167
    wind_proj_mask   (time, latitude, longitude) float64 0.2005 0.3436 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;178&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 179, coords = (array(167.31738035), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;179&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_179_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.47 2.559 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.9593 ... 1.147
    uw2              (time, latitude, longitude) float32 6.099 6.551 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.9202 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.649 2.609 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.6341 ... -0.8813
    bearings         (latitude, longitude) float64 35.07 28.45 ... 208.1 214.3
    direc_proj_math  (latitude, longitude) float64 0.9586 1.074 ... -2.062 -2.17
    wind_proj_mask   (time, latitude, longitude) float64 0.6341 0.7721 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;179&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 180, coords = (array(167.37783375), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;180&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_180_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.47 2.559 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.9593 ... 1.147
    uw2              (time, latitude, longitude) float32 6.099 6.551 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.9202 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.649 2.609 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.6869 ... -0.8957
    bearings         (latitude, longitude) float64 36.25 29.8 ... 206.9 213.2
    direc_proj_math  (latitude, longitude) float64 0.9381 1.051 ... -2.04 -2.15
    wind_proj_mask   (time, latitude, longitude) float64 0.6869 0.8307 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;180&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 181, coords = (array(167.61964736), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;181&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_181_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.02564
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.053
    uw2              (time, latitude, longitude) float32 6.551 ... 0.0006573
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.109
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.054
    wind_proj        (time, latitude, longitude) float64 1.046 1.233 ... -0.8534
    bearings         (latitude, longitude) float64 34.87 28.22 ... 208.4 214.5
    direc_proj_math  (latitude, longitude) float64 0.9622 1.078 ... -2.173
    wind_proj_mask   (time, latitude, longitude) float64 1.046 1.233 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;181&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 182, coords = (array(170.03778338), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;182&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_182_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.6 170.9 171.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -2.139
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -1.485
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 4.573
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 2.205
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 2.603
    wind_proj        (time, latitude, longitude) float64 3.121 2.554 ... 2.356
    bearings         (latitude, longitude) float64 33.21 26.32 ... 203.3 210.1
    direc_proj_math  (latitude, longitude) float64 0.9911 1.111 ... -2.095
    wind_proj_mask   (time, latitude, longitude) float64 3.121 2.554 ... 2.356
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;182&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 183, coords = (array(170.09823678), array(-46.24731163)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;183&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_183_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -4.038
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 12.84
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.15 2.596 ... 5.362
    bearings         (latitude, longitude) float64 34.44 27.73 ... 208.8 214.9
    direc_proj_math  (latitude, longitude) float64 0.9696 1.087 ... -2.074 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 3.15 2.596 ... 5.362
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;183&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 184, coords = (array(166.59193955), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;184&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_184_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.8225
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.1771
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.4491 ... -0.4885
    bearings         (latitude, longitude) float64 32.27 25.46 ... 204.1 211.0
    direc_proj_math  (latitude, longitude) float64 1.008 1.126 ... -1.992 -2.112
    wind_proj_mask   (time, latitude, longitude) float64 -0.4491 -0.2815 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;184&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 185, coords = (array(167.37783375), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;185&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_185_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.47 2.559 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.9593 ... 1.147
    uw2              (time, latitude, longitude) float32 6.099 6.551 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.9202 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.649 2.609 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.6506 ... -0.8855
    bearings         (latitude, longitude) float64 35.44 29.07 ... 207.6 214.0
    direc_proj_math  (latitude, longitude) float64 0.9522 1.063 ... -2.164
    wind_proj_mask   (time, latitude, longitude) float64 0.6506 0.7992 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;185&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 186, coords = (array(167.43828715), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;186&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_186_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.147
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.8553 ... -0.9005
    bearings         (latitude, longitude) float64 30.37 23.32 ... 206.2 212.8
    direc_proj_math  (latitude, longitude) float64 1.041 1.164 ... -2.028 -2.144
    wind_proj_mask   (time, latitude, longitude) float64 0.8553 1.022 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;186&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 187, coords = (array(167.49874055), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;187&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_187_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.147
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.9096 ... -0.9154
    bearings         (latitude, longitude) float64 31.64 24.75 ... 204.8 211.6
    direc_proj_math  (latitude, longitude) float64 1.019 1.139 ... -2.004 -2.123
    wind_proj_mask   (time, latitude, longitude) float64 0.9096 1.084 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;187&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 188, coords = (array(167.55919395), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;188&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_188_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.147
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.9621 ... -0.9304
    bearings         (latitude, longitude) float64 32.87 26.15 ... 203.4 210.4
    direc_proj_math  (latitude, longitude) float64 0.9971 1.114 ... -2.101
    wind_proj_mask   (time, latitude, longitude) float64 0.9621 1.145 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;188&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 189, coords = (array(167.61964736), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;189&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_189_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.02564
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.053
    uw2              (time, latitude, longitude) float32 6.551 ... 0.0006573
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.109
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.054
    wind_proj        (time, latitude, longitude) float64 1.013 1.203 ... -0.8446
    bearings         (latitude, longitude) float64 34.08 27.51 ... 209.1 215.3
    direc_proj_math  (latitude, longitude) float64 0.9761 1.091 ... -2.187
    wind_proj_mask   (time, latitude, longitude) float64 1.013 1.203 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;189&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 190, coords = (array(170.09823678), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;190&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_190_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -4.038
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 12.84
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.131 2.576 ... 5.37
    bearings         (latitude, longitude) float64 33.65 27.03 ... 209.6 215.7
    direc_proj_math  (latitude, longitude) float64 0.9834 1.099 ... -2.194
    wind_proj_mask   (time, latitude, longitude) float64 3.131 2.576 ... 5.37
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;190&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 191, coords = (array(170.15869018), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;191&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_191_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -4.038
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 12.84
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.158 2.615 ... 5.358
    bearings         (latitude, longitude) float64 34.84 28.38 ... 208.3 214.6
    direc_proj_math  (latitude, longitude) float64 0.9628 1.075 ... -2.175
    wind_proj_mask   (time, latitude, longitude) float64 3.158 2.615 ... 5.358
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;191&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 192, coords = (array(170.21914358), array(-46.20516139)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;192&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_192_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -4.038
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 12.84
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.184 2.652 ... 5.344
    bearings         (latitude, longitude) float64 35.99 29.69 ... 206.9 213.4
    direc_proj_math  (latitude, longitude) float64 0.9427 1.053 ... -2.154
    wind_proj_mask   (time, latitude, longitude) float64 3.184 2.652 ... 5.344
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;192&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 193, coords = (array(166.59193955), array(-46.16297879)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;193&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_193_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.8225
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.1771
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.4886 ... -0.4775
    bearings         (latitude, longitude) float64 31.53 24.83 ... 204.8 211.8
    direc_proj_math  (latitude, longitude) float64 1.021 1.137 ... -2.004 -2.125
    wind_proj_mask   (time, latitude, longitude) float64 -0.4886 -0.3125 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;193&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 194, coords = (array(167.43828715), array(-46.16297879)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;194&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_194_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.147
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.8245 ... -0.8901
    bearings         (latitude, longitude) float64 29.65 22.72 ... 206.9 213.6
    direc_proj_math  (latitude, longitude) float64 1.053 1.174 ... -2.041 -2.158
    wind_proj_mask   (time, latitude, longitude) float64 0.8245 0.9954 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;194&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 195, coords = (array(167.49874055), array(-46.16297879)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;195&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_195_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.559 2.72 ... -0.1175
    vgrd10m          (time, latitude, longitude) float32 -0.5085 ... 1.147
    uw2              (time, latitude, longitude) float32 6.551 7.397 ... 0.01381
    vw2              (time, latitude, longitude) float32 0.2585 ... 1.316
    wind_magnitude   (time, latitude, longitude) float32 2.609 2.72 ... 1.153
    wind_proj        (time, latitude, longitude) float64 0.8782 ... -0.9055
    bearings         (latitude, longitude) float64 30.9 24.13 ... 205.5 212.4
    direc_proj_math  (latitude, longitude) float64 1.031 1.15 ... -2.016 -2.137
    wind_proj_mask   (time, latitude, longitude) float64 0.8782 1.057 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;195&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 196, coords = (array(170.21914358), array(-46.16297879)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;196&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_196_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -4.038
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 12.84
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.167 2.632 ... 5.354
    bearings         (latitude, longitude) float64 35.2 28.99 ... 207.7 214.3
    direc_proj_math  (latitude, longitude) float64 0.9564 1.065 ... -2.169
    wind_proj_mask   (time, latitude, longitude) float64 3.167 2.632 ... 5.354
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;196&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 197, coords = (array(166.53148615), array(-46.12076382)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;197&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_197_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.8225
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.1771
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.5907 ... -0.4484
    bearings         (latitude, longitude) float64 29.6 22.86 ... 207.0 213.9
    direc_proj_math  (latitude, longitude) float64 1.054 1.172 ... -2.041 -2.162
    wind_proj_mask   (time, latitude, longitude) float64 -0.5907 -0.4084 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;197&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 198, coords = (array(166.59193955), array(-46.12076382)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;198&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_198_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.339 2.41 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.008 ... 0.8225
    uw2              (time, latitude, longitude) float32 5.473 5.808 ... 0.1771
    vw2              (time, latitude, longitude) float32 4.033 2.129 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.083 2.817 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.5263 ... -0.466
    bearings         (latitude, longitude) float64 30.82 24.22 ... 205.5 212.6
    direc_proj_math  (latitude, longitude) float64 1.033 1.148 ... -2.016 -2.14
    wind_proj_mask   (time, latitude, longitude) float64 -0.5263 -0.3421 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;198&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 199, coords = (array(170.21914358), array(-46.12076382)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;199&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_199_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.61 -47.3 -46.99 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.859 2.69 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 1.859 1.519 ... -4.038
    uw2              (time, latitude, longitude) float32 8.171 7.235 ... 12.84
    vw2              (time, latitude, longitude) float32 3.455 2.307 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 3.41 3.089 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.15 2.613 ... 5.364
    bearings         (latitude, longitude) float64 34.45 28.31 ... 208.4 215.1
    direc_proj_math  (latitude, longitude) float64 0.9695 1.077 ... -2.184
    wind_proj_mask   (time, latitude, longitude) float64 3.15 2.613 ... 5.364
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;199&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 200, coords = (array(166.53148615), array(-46.07851648)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;200&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_200_winds_gradients_12H_tl1.nc
PCs loaded from file

 ---------------------------------------------------------                         

 Experiment 1 in site 201, coords = (array(170.21914358), array(-46.07851648)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;201&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_201_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 168.8 169.1 169.4 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.469 4.179 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 1.369 0.9293 ... -4.038
    uw2              (time, latitude, longitude) float32 19.98 17.46 ... 12.84
    vw2              (time, latitude, longitude) float32 1.875 0.8637 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 4.675 4.281 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.922 3.075 ... 5.373
    bearings         (latitude, longitude) float64 40.0 33.37 ... 209.2 216.0
    direc_proj_math  (latitude, longitude) float64 0.8727 0.9884 ... -2.081 -2.2
    wind_proj_mask   (time, latitude, longitude) float64 3.922 3.075 ... 5.373
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;201&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 202, coords = (array(170.27959698), array(-46.07851648)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;202&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_202_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -4.038
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 12.84
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.145 2.136 ... 5.36
    bearings         (latitude, longitude) float64 34.74 27.21 ... 207.8 214.8
    direc_proj_math  (latitude, longitude) float64 0.9645 1.096 ... -2.178
    wind_proj_mask   (time, latitude, longitude) float64 3.145 2.136 ... 5.36
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;202&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 203, coords = (array(166.41057935), array(-46.03623677)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;203&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_203_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.948 2.149 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.478 ... 0.8225
    uw2              (time, latitude, longitude) float32 3.796 4.619 ... 0.1771
    vw2              (time, latitude, longitude) float32 6.142 3.914 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.152 2.921 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.7584 ... -0.3871
    bearings         (latitude, longitude) float64 37.91 31.15 ... 211.5 218.1
    direc_proj_math  (latitude, longitude) float64 0.9092 1.027 ... -2.12 -2.236
    wind_proj_mask   (time, latitude, longitude) float64 -0.7584 -0.5812 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;203&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 204, coords = (array(166.47103275), array(-46.03623677)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;204&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_204_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.948 2.149 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.478 ... 0.8225
    uw2              (time, latitude, longitude) float32 3.796 4.619 ... 0.1771
    vw2              (time, latitude, longitude) float32 6.142 3.914 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.152 2.921 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.6948 ... -0.4047
    bearings         (latitude, longitude) float64 39.09 32.54 ... 210.0 216.9
    direc_proj_math  (latitude, longitude) float64 0.8885 1.003 ... -2.215
    wind_proj_mask   (time, latitude, longitude) float64 -0.6948 -0.5117 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;204&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 205, coords = (array(166.53148615), array(-46.03623677)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;205&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_205_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.149 2.318 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -1.978 ... 0.8225
    uw2              (time, latitude, longitude) float32 4.619 5.373 ... 0.1771
    vw2              (time, latitude, longitude) float32 3.914 2.366 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 2.921 2.782 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.4439 ... -0.4226
    bearings         (latitude, longitude) float64 33.89 26.49 ... 208.6 215.7
    direc_proj_math  (latitude, longitude) float64 0.9793 1.108 ... -2.194
    wind_proj_mask   (time, latitude, longitude) float64 -0.4439 -0.3428 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;205&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 206, coords = (array(170.27959698), array(-46.03623677)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;206&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_206_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -4.038
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 12.84
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.099 2.093 ... 5.37
    bearings         (latitude, longitude) float64 33.85 26.44 ... 208.6 215.7
    direc_proj_math  (latitude, longitude) float64 0.98 1.109 ... -2.07 -2.194
    wind_proj_mask   (time, latitude, longitude) float64 3.099 2.093 ... 5.37
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;206&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 207, coords = (array(170.34005038), array(-46.03623677)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;207&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_207_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -4.038
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 12.84
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.166 2.177 ... 5.356
    bearings         (latitude, longitude) float64 35.16 27.96 ... 207.1 214.4
    direc_proj_math  (latitude, longitude) float64 0.9572 1.083 ... -2.172
    wind_proj_mask   (time, latitude, longitude) float64 3.166 2.177 ... 5.356
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;207&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 208, coords = (array(166.41057935), array(-45.99392469)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;208&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_208_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.948 2.149 ... -0.4209
    vgrd10m          (time, latitude, longitude) float32 -2.478 ... 0.8225
    uw2              (time, latitude, longitude) float32 3.796 4.619 ... 0.1771
    vw2              (time, latitude, longitude) float32 6.142 3.914 ... 0.6765
    wind_magnitude   (time, latitude, longitude) float32 3.152 2.921 ... 0.9239
    wind_proj        (time, latitude, longitude) float64 -0.806 ... -0.3726
    bearings         (latitude, longitude) float64 37.01 30.34 ... 212.4 219.1
    direc_proj_math  (latitude, longitude) float64 0.9248 1.041 ... -2.254
    wind_proj_mask   (time, latitude, longitude) float64 -0.806 -0.6217 ... nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;208&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 209, coords = (array(170.34005038), array(-45.99392469)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;209&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_209_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 170.9 171.2 171.6
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -3.583
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -4.038
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 12.84
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 16.3
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 5.398
    wind_proj        (time, latitude, longitude) float64 3.122 2.135 ... 5.367
    bearings         (latitude, longitude) float64 34.29 27.2 ... 207.9 215.4
    direc_proj_math  (latitude, longitude) float64 0.9723 1.096 ... -2.188
    wind_proj_mask   (time, latitude, longitude) float64 3.122 2.135 ... 5.367
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;209&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 210, coords = (array(170.40050378), array(-45.99392469)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;210&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_210_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -45.12 -44.8
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 171.2 171.6 171.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -4.527
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -6.127
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 20.49
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 37.54
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 7.618
    wind_proj        (time, latitude, longitude) float64 3.186 2.215 ... 7.599
    bearings         (latitude, longitude) float64 35.55 28.65 ... 214.0 220.5
    direc_proj_math  (latitude, longitude) float64 0.9503 1.071 ... -2.278
    wind_proj_mask   (time, latitude, longitude) float64 3.186 2.215 ... 7.599
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;210&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 211, coords = (array(166.41057935), array(-45.95158023)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;211&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_211_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.948 2.149 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.478 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.796 4.619 ... 0.8837
    vw2              (time, latitude, longitude) float32 6.142 3.914 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.152 2.921 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -0.8515 ... -1.227
    bearings         (latitude, longitude) float64 36.15 29.57 ... 207.4 213.6
    direc_proj_math  (latitude, longitude) float64 0.9398 1.055 ... -2.157
    wind_proj_mask   (time, latitude, longitude) float64 -0.8515 ... -1.227
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;211&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 212, coords = (array(170.40050378), array(-45.95158023)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;212&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_212_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 171.2 171.6 171.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -5.3
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -4.865
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 28.1
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 23.66
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 7.194
    wind_proj        (time, latitude, longitude) float64 3.143 2.174 ... 7.023
    bearings         (latitude, longitude) float64 34.71 27.9 ... 208.9 214.9
    direc_proj_math  (latitude, longitude) float64 0.965 1.084 ... -2.075 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 3.143 2.174 ... 7.023
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;212&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 213, coords = (array(170.46095718), array(-45.95158023)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;213&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_213_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 171.2 171.6 171.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -5.3
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -4.865
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 28.1
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 23.66
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 7.194
    wind_proj        (time, latitude, longitude) float64 3.204 2.25 ... 6.992
    bearings         (latitude, longitude) float64 35.92 29.29 ... 207.6 213.8
    direc_proj_math  (latitude, longitude) float64 0.944 1.06 ... -2.053 -2.161
    wind_proj_mask   (time, latitude, longitude) float64 3.204 2.25 ... 6.992
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;213&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 214, coords = (array(170.52141058), array(-45.95158023)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;214&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_214_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.1 169.4 169.7 ... 171.2 171.6 171.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.179 3.799 ... -5.3
    vgrd10m          (time, latitude, longitude) float32 0.9293 ... -4.865
    uw2              (time, latitude, longitude) float32 17.46 14.43 ... 28.1
    vw2              (time, latitude, longitude) float32 0.8637 0.2013 ... 23.66
    wind_magnitude   (time, latitude, longitude) float32 4.281 3.825 ... 7.194
    wind_proj        (time, latitude, longitude) float64 3.261 2.322 ... 6.957
    bearings         (latitude, longitude) float64 37.09 30.65 ... 206.3 212.7
    direc_proj_math  (latitude, longitude) float64 0.9234 1.036 ... -2.03 -2.141
    wind_proj_mask   (time, latitude, longitude) float64 3.261 2.322 ... 6.957
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;214&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 215, coords = (array(170.58186398), array(-45.95158023)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;215&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_215_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.2 171.6 171.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.799 3.369 ... -5.3
    vgrd10m          (time, latitude, longitude) float32 0.4486 ... -4.865
    uw2              (time, latitude, longitude) float32 14.43 11.35 ... 28.1
    vw2              (time, latitude, longitude) float32 0.2013 ... 23.66
    wind_magnitude   (time, latitude, longitude) float32 3.825 3.369 ... 7.194
    wind_proj        (time, latitude, longitude) float64 2.392 1.439 ... 6.918
    bearings         (latitude, longitude) float64 31.97 24.77 ... 205.0 211.5
    direc_proj_math  (latitude, longitude) float64 1.013 1.138 ... -2.007 -2.121
    wind_proj_mask   (time, latitude, longitude) float64 2.392 1.439 ... 6.918
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;215&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 216, coords = (array(170.64231738), array(-45.95158023)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;216&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_216_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.2 171.6 171.9
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.799 3.369 ... -5.3
    vgrd10m          (time, latitude, longitude) float32 0.4486 ... -4.865
    uw2              (time, latitude, longitude) float32 14.43 11.35 ... 28.1
    vw2              (time, latitude, longitude) float32 0.2013 ... 23.66
    wind_magnitude   (time, latitude, longitude) float32 3.825 3.369 ... 7.194
    wind_proj        (time, latitude, longitude) float64 2.458 1.516 ... 6.875
    bearings         (latitude, longitude) float64 33.25 26.24 ... 203.6 210.3
    direc_proj_math  (latitude, longitude) float64 0.9905 1.113 ... -1.983 -2.1
    wind_proj_mask   (time, latitude, longitude) float64 2.458 1.516 ... 6.875
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;216&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 217, coords = (array(170.70277078), array(-45.95158023)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;217&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_217_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.799 3.369 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 0.4486 ... -6.49
    uw2              (time, latitude, longitude) float32 14.43 11.35 ... 35.5
    vw2              (time, latitude, longitude) float32 0.2013 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 3.825 3.369 ... 8.811
    wind_proj        (time, latitude, longitude) float64 2.521 1.591 ... 8.736
    bearings         (latitude, longitude) float64 34.5 27.67 ... 209.1 215.1
    direc_proj_math  (latitude, longitude) float64 0.9687 1.088 ... -2.184
    wind_proj_mask   (time, latitude, longitude) float64 2.521 1.591 ... 8.736
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;217&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 218, coords = (array(166.41057935), array(-45.9092034)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;218&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_218_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.948 2.149 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.478 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.796 4.619 ... 0.8837
    vw2              (time, latitude, longitude) float32 6.142 3.914 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.152 2.921 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -0.8951 ... -1.231
    bearings         (latitude, longitude) float64 35.33 28.83 ... 208.1 214.4
    direc_proj_math  (latitude, longitude) float64 0.9542 1.068 ... -2.171
    wind_proj_mask   (time, latitude, longitude) float64 -0.8951 ... -1.231
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;218&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 219, coords = (array(170.70277078), array(-45.9092034)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;219&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_219_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.799 3.369 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 0.4486 ... -6.49
    uw2              (time, latitude, longitude) float32 14.43 11.35 ... 35.5
    vw2              (time, latitude, longitude) float32 0.2013 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 3.825 3.369 ... 8.811
    wind_proj        (time, latitude, longitude) float64 2.481 1.554 ... 8.752
    bearings         (latitude, longitude) float64 33.69 26.96 ... 209.8 215.9
    direc_proj_math  (latitude, longitude) float64 0.9827 1.1 ... -2.091 -2.198
    wind_proj_mask   (time, latitude, longitude) float64 2.481 1.554 ... 8.752
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;219&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 220, coords = (array(170.76322418), array(-45.9092034)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;220&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_220_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.799 3.369 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 0.4486 ... -6.49
    uw2              (time, latitude, longitude) float32 14.43 11.35 ... 35.5
    vw2              (time, latitude, longitude) float32 0.2013 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 3.825 3.369 ... 8.811
    wind_proj        (time, latitude, longitude) float64 2.541 1.625 ... 8.73
    bearings         (latitude, longitude) float64 34.89 28.33 ... 208.5 214.8
    direc_proj_math  (latitude, longitude) float64 0.9618 1.076 ... -2.178
    wind_proj_mask   (time, latitude, longitude) float64 2.541 1.625 ... 8.73
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;220&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 221, coords = (array(166.41057935), array(-45.86679418)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;221&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_221_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.948 2.149 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.478 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.796 4.619 ... 0.8837
    vw2              (time, latitude, longitude) float32 6.142 3.914 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.152 2.921 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -0.9367 ... -1.235
    bearings         (latitude, longitude) float64 34.54 28.13 ... 208.8 215.2
    direc_proj_math  (latitude, longitude) float64 0.968 1.08 ... -2.074 -2.186
    wind_proj_mask   (time, latitude, longitude) float64 -0.9367 ... -1.235
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;221&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 222, coords = (array(170.76322418), array(-45.86679418)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;222&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_222_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.799 3.369 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 0.4486 ... -6.49
    uw2              (time, latitude, longitude) float32 14.43 11.35 ... 35.5
    vw2              (time, latitude, longitude) float32 0.2013 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 3.825 3.369 ... 8.811
    wind_proj        (time, latitude, longitude) float64 2.502 1.589 ... 8.747
    bearings         (latitude, longitude) float64 34.11 27.64 ... 209.3 215.6
    direc_proj_math  (latitude, longitude) float64 0.9755 1.088 ... -2.193
    wind_proj_mask   (time, latitude, longitude) float64 2.502 1.589 ... 8.747
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;222&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 223, coords = (array(166.41057935), array(-45.82435259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;223&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_223_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -47.3 -46.99 -46.68 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.948 2.149 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.478 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.796 4.619 ... 0.8837
    vw2              (time, latitude, longitude) float32 6.142 3.914 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.152 2.921 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -0.9765 ... -1.239
    bearings         (latitude, longitude) float64 33.78 27.45 ... 209.6 216.1
    direc_proj_math  (latitude, longitude) float64 0.9812 1.092 ... -2.201
    wind_proj_mask   (time, latitude, longitude) float64 -0.9765 ... -1.239
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;223&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 224, coords = (array(170.76322418), array(-45.82435259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;224&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_224_winds_gradients_12H_tl1.nc
PCs loaded from file
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> ---------------------------------------------------------                         

 Experiment 1 in site 225, coords = (array(166.41057935), array(-45.78187862)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;225&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_225_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.839 2.19 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.918 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.384 4.795 ... 0.8837
    vw2              (time, latitude, longitude) float32 8.517 6.65 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.45 3.383 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -1.09 ... -1.243
    bearings         (latitude, longitude) float64 39.35 32.48 ... 210.4 217.0
    direc_proj_math  (latitude, longitude) float64 0.884 1.004 ... -2.102 -2.216
    wind_proj_mask   (time, latitude, longitude) float64 -1.09 ... -1.243
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;225&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 226, coords = (array(166.47103275), array(-45.78187862)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;226&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_226_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.839 2.19 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.918 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.384 4.795 ... 0.8837
    vw2              (time, latitude, longitude) float32 8.517 6.65 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.45 3.383 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -1.021 ... -1.238
    bearings         (latitude, longitude) float64 40.55 33.9 ... 209.0 215.8
    direc_proj_math  (latitude, longitude) float64 0.863 0.9792 ... -2.196
    wind_proj_mask   (time, latitude, longitude) float64 -1.021 ... -1.238
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;226&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 227, coords = (array(170.76322418), array(-45.78187862)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;227&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_227_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -6.49
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 35.5
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 8.811
    wind_proj        (time, latitude, longitude) float64 3.096 1.933 ... 8.776
    bearings         (latitude, longitude) float64 38.9 31.94 ... 210.9 217.4
    direc_proj_math  (latitude, longitude) float64 0.8919 1.013 ... -2.11 -2.224
    wind_proj_mask   (time, latitude, longitude) float64 3.096 1.933 ... 8.776
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;227&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 228, coords = (array(166.47103275), array(-45.73937226)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;228&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_228_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.839 2.19 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.918 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.384 4.795 ... 0.8837
    vw2              (time, latitude, longitude) float32 8.517 6.65 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.45 3.383 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -1.077 ... -1.242
    bearings         (latitude, longitude) float64 39.59 33.0 ... 209.9 216.7
    direc_proj_math  (latitude, longitude) float64 0.8798 0.9948 ... -2.212
    wind_proj_mask   (time, latitude, longitude) float64 -1.077 ... -1.242
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;228&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 229, coords = (array(170.70277078), array(-45.73937226)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;229&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_229_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -6.49
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 35.5
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 8.811
    wind_proj        (time, latitude, longitude) float64 2.924 1.755 ... 8.798
    bearings         (latitude, longitude) float64 36.7 29.62 ... 213.1 219.5
    direc_proj_math  (latitude, longitude) float64 0.9302 1.054 ... -2.261
    wind_proj_mask   (time, latitude, longitude) float64 2.924 1.755 ... 8.798
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;229&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 230, coords = (array(170.76322418), array(-45.73937226)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;230&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_230_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -6.49
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 35.5
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 8.811
    wind_proj        (time, latitude, longitude) float64 3.022 1.867 ... 8.787
    bearings         (latitude, longitude) float64 37.95 31.07 ... 211.8 218.4
    direc_proj_math  (latitude, longitude) float64 0.9085 1.028 ... -2.126 -2.24
    wind_proj_mask   (time, latitude, longitude) float64 3.022 1.867 ... 8.787
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;230&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 231, coords = (array(166.47103275), array(-45.69683352)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;231&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_231_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.839 2.19 ... 0.94
    vgrd10m          (time, latitude, longitude) float32 -2.918 ... 0.8482
    uw2              (time, latitude, longitude) float32 3.384 4.795 ... 0.8837
    vw2              (time, latitude, longitude) float32 8.517 6.65 ... 0.7194
    wind_magnitude   (time, latitude, longitude) float32 3.45 3.383 ... 1.266
    wind_proj        (time, latitude, longitude) float64 -1.129 ... -1.246
    bearings         (latitude, longitude) float64 38.67 32.15 ... 210.7 217.7
    direc_proj_math  (latitude, longitude) float64 0.8959 1.01 ... -2.107 -2.229
    wind_proj_mask   (time, latitude, longitude) float64 -1.129 ... -1.246
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;231&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 232, coords = (array(170.70277078), array(-45.69683352)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;232&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_232_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.8 -44.49
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.958
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -6.49
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 35.5
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 42.13
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 8.811
    wind_proj        (time, latitude, longitude) float64 2.852 1.693 ... 8.805
    bearings         (latitude, longitude) float64 35.8 28.82 ... 214.1 220.5
    direc_proj_math  (latitude, longitude) float64 0.9459 1.068 ... -2.278
    wind_proj_mask   (time, latitude, longitude) float64 2.852 1.693 ... 8.805
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;232&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 233, coords = (array(166.47103275), array(-45.6542624)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;233&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_233_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.839 2.19 ... 1.837
    vgrd10m          (time, latitude, longitude) float32 -2.918 -2.579 ... 2.109
    uw2              (time, latitude, longitude) float32 3.384 4.795 ... 3.376
    vw2              (time, latitude, longitude) float32 8.517 6.65 ... 4.446
    wind_magnitude   (time, latitude, longitude) float32 3.45 3.383 ... 2.797
    wind_proj        (time, latitude, longitude) float64 -1.18 -1.064 ... -2.764
    bearings         (latitude, longitude) float64 37.78 31.33 ... 205.9 212.3
    direc_proj_math  (latitude, longitude) float64 0.9114 1.024 ... -2.135
    wind_proj_mask   (time, latitude, longitude) float64 -1.18 -1.064 ... -2.764
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;233&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 234, coords = (array(170.70277078), array(-45.6542624)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;234&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_234_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -5.14
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 33.3
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.783 1.634 ... 7.52
    bearings         (latitude, longitude) float64 34.94 28.06 ... 209.0 215.0
    direc_proj_math  (latitude, longitude) float64 0.9609 1.081 ... -2.181
    wind_proj_mask   (time, latitude, longitude) float64 2.783 1.634 ... 7.52
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;234&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 235, coords = (array(170.76322418), array(-45.6542624)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;235&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_235_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -5.14
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 33.3
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.881 1.743 ... 7.484
    bearings         (latitude, longitude) float64 36.16 29.46 ... 207.7 213.9
    direc_proj_math  (latitude, longitude) float64 0.9396 1.057 ... -2.162
    wind_proj_mask   (time, latitude, longitude) float64 2.881 1.743 ... 7.484
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;235&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 236, coords = (array(166.47103275), array(-45.61165888)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;236&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_236_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 165.0 165.3 165.6 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.839 2.19 ... 1.837
    vgrd10m          (time, latitude, longitude) float32 -2.918 -2.579 ... 2.109
    uw2              (time, latitude, longitude) float32 3.384 4.795 ... 3.376
    vw2              (time, latitude, longitude) float32 8.517 6.65 ... 4.446
    wind_magnitude   (time, latitude, longitude) float32 3.45 3.383 ... 2.797
    wind_proj        (time, latitude, longitude) float64 -1.228 -1.107 ... -2.77
    bearings         (latitude, longitude) float64 36.93 30.56 ... 206.6 213.1
    direc_proj_math  (latitude, longitude) float64 0.9263 1.037 ... -2.149
    wind_proj_mask   (time, latitude, longitude) float64 -1.228 -1.107 ... -2.77
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;236&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 237, coords = (array(166.53148615), array(-45.61165888)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;237&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_237_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.19 2.579 ... 1.837
    vgrd10m          (time, latitude, longitude) float32 -2.579 -2.228 ... 2.109
    uw2              (time, latitude, longitude) float32 4.795 6.65 ... 3.376
    vw2              (time, latitude, longitude) float32 6.65 4.965 ... 4.446
    wind_magnitude   (time, latitude, longitude) float32 3.383 3.408 ... 2.797
    wind_proj        (time, latitude, longitude) float64 -1.034 ... -2.761
    bearings         (latitude, longitude) float64 31.86 24.76 ... 205.3 211.9
    direc_proj_math  (latitude, longitude) float64 1.015 1.139 ... -2.012 -2.128
    wind_proj_mask   (time, latitude, longitude) float64 -1.034 ... -2.761
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;237&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 238, coords = (array(170.76322418), array(-45.61165888)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;238&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_238_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -5.14
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 33.3
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.814 1.685 ... 7.51
    bearings         (latitude, longitude) float64 35.33 28.72 ... 208.4 214.7
    direc_proj_math  (latitude, longitude) float64 0.9542 1.07 ... -2.067 -2.176
    wind_proj_mask   (time, latitude, longitude) float64 2.814 1.685 ... 7.51
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;238&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 239, coords = (array(166.53148615), array(-45.56902299)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;239&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_239_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.19 2.579 ... 1.837
    vgrd10m          (time, latitude, longitude) float32 -2.579 -2.228 ... 2.109
    uw2              (time, latitude, longitude) float32 4.795 6.65 ... 3.376
    vw2              (time, latitude, longitude) float32 6.65 4.965 ... 4.446
    wind_magnitude   (time, latitude, longitude) float32 3.383 3.408 ... 2.797
    wind_proj        (time, latitude, longitude) float64 -1.077 ... -2.767
    bearings         (latitude, longitude) float64 31.1 24.12 ... 206.0 212.7
    direc_proj_math  (latitude, longitude) float64 1.028 1.15 ... -2.024 -2.142
    wind_proj_mask   (time, latitude, longitude) float64 -1.077 ... -2.767
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;239&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 240, coords = (array(166.59193955), array(-45.56902299)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;240&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_240_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.2 167.5 167.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.19 2.579 ... 1.837
    vgrd10m          (time, latitude, longitude) float32 -2.579 -2.228 ... 2.109
    uw2              (time, latitude, longitude) float32 4.795 6.65 ... 3.376
    vw2              (time, latitude, longitude) float32 6.65 4.965 ... 4.446
    wind_magnitude   (time, latitude, longitude) float32 3.383 3.408 ... 2.797
    wind_proj        (time, latitude, longitude) float64 -1.007 ... -2.758
    bearings         (latitude, longitude) float64 32.35 25.53 ... 204.5 211.5
    direc_proj_math  (latitude, longitude) float64 1.006 1.125 ... -1.999 -2.12
    wind_proj_mask   (time, latitude, longitude) float64 -1.007 ... -2.758
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;240&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 241, coords = (array(166.65239295), array(-45.56902299)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;241&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_241_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.19 2.579 ... 0.8353
    vgrd10m          (time, latitude, longitude) float32 -2.579 ... 0.3867
    uw2              (time, latitude, longitude) float32 4.795 6.65 ... 0.6978
    vw2              (time, latitude, longitude) float32 6.65 4.965 ... 0.1495
    wind_magnitude   (time, latitude, longitude) float32 3.383 3.408 ... 0.9205
    wind_proj        (time, latitude, longitude) float64 -0.9376 ... -0.807
    bearings         (latitude, longitude) float64 33.57 26.92 ... 210.2 216.4
    direc_proj_math  (latitude, longitude) float64 0.9849 1.101 ... -2.206
    wind_proj_mask   (time, latitude, longitude) float64 -0.9376 ... -0.807
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;241&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 242, coords = (array(170.76322418), array(-45.56902299)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;242&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_242_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -5.14
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 33.3
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.749 1.63 ... 7.536
    bearings         (latitude, longitude) float64 34.52 28.0 ... 209.2 215.5
    direc_proj_math  (latitude, longitude) float64 0.9682 1.082 ... -2.08 -2.191
    wind_proj_mask   (time, latitude, longitude) float64 2.749 1.63 ... 7.536
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;242&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 243, coords = (array(170.82367758), array(-45.56902299)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;243&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_243_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -5.14
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 33.3
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.843 1.733 ... 7.5
    bearings         (latitude, longitude) float64 35.69 29.33 ... 207.8 214.4
    direc_proj_math  (latitude, longitude) float64 0.9479 1.059 ... -2.057 -2.17
    wind_proj_mask   (time, latitude, longitude) float64 2.843 1.733 ... 7.5
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;243&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 244, coords = (array(166.65239295), array(-45.5263547)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;244&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_244_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.19 2.579 ... 0.8353
    vgrd10m          (time, latitude, longitude) float32 -2.579 ... 0.3867
    uw2              (time, latitude, longitude) float32 4.795 6.65 ... 0.6978
    vw2              (time, latitude, longitude) float32 6.65 4.965 ... 0.1495
    wind_magnitude   (time, latitude, longitude) float32 3.383 3.408 ... 0.9205
    wind_proj        (time, latitude, longitude) float64 -0.9807 ... -0.8137
    bearings         (latitude, longitude) float64 32.81 26.25 ... 211.0 217.3
    direc_proj_math  (latitude, longitude) float64 0.9981 1.113 ... -2.221
    wind_proj_mask   (time, latitude, longitude) float64 -0.9807 ... -0.8137
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;244&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 245, coords = (array(170.82367758), array(-45.5263547)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;245&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_245_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 169.4 169.7 170.0 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.388 4.709 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.3696 ... -5.14
    uw2              (time, latitude, longitude) float32 29.03 22.17 ... 33.3
    vw2              (time, latitude, longitude) float32 0.1366 0.433 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.401 4.754 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.78 1.678 ... 7.527
    bearings         (latitude, longitude) float64 34.9 28.63 ... 208.6 215.2
    direc_proj_math  (latitude, longitude) float64 0.9616 1.071 ... -2.07 -2.185
    wind_proj_mask   (time, latitude, longitude) float64 2.78 1.678 ... 7.527
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;245&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 246, coords = (array(170.88413098), array(-45.5263547)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;246&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_246_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.99 -46.68 -46.37 ... -44.49 -44.18
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.709 4.13 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.658 ... -5.14
    uw2              (time, latitude, longitude) float32 22.17 17.05 ... 33.3
    vw2              (time, latitude, longitude) float32 0.433 0.323 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 4.754 4.169 ... 7.728
    wind_proj        (time, latitude, longitude) float64 1.777 1.089 ... 7.489
    bearings         (latitude, longitude) float64 29.91 22.98 ... 207.2 214.0
    direc_proj_math  (latitude, longitude) float64 1.049 1.17 ... -2.046 -2.164
    wind_proj_mask   (time, latitude, longitude) float64 1.777 1.089 ... 7.489
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;246&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 247, coords = (array(166.65239295), array(-45.48365403)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;247&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_247_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... 0.8353
    vgrd10m          (time, latitude, longitude) float32 -3.508 ... 0.3867
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.6978
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 0.1495
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 0.9205
    wind_proj        (time, latitude, longitude) float64 -1.41 ... -0.8204
    bearings         (latitude, longitude) float64 38.37 31.19 ... 211.9 218.2
    direc_proj_math  (latitude, longitude) float64 0.9011 1.026 ... -2.237
    wind_proj_mask   (time, latitude, longitude) float64 -1.41 ... -0.8204
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;247&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 248, coords = (array(170.88413098), array(-45.48365403)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;248&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_248_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.49 -44.18
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -5.14
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 33.3
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.419 1.805 ... 7.517
    bearings         (latitude, longitude) float64 35.23 27.49 ... 208.0 214.9
    direc_proj_math  (latitude, longitude) float64 0.956 1.091 ... -2.059 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 2.419 1.805 ... 7.517
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;248&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 249, coords = (array(166.65239295), array(-45.44092096)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;249&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_249_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... 0.8353
    vgrd10m          (time, latitude, longitude) float32 -3.508 ... 0.3867
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.6978
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 0.1495
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 0.9205
    wind_proj        (time, latitude, longitude) float64 -1.474 ... -0.8272
    bearings         (latitude, longitude) float64 37.41 30.32 ... 212.7 219.1
    direc_proj_math  (latitude, longitude) float64 0.9179 1.042 ... -2.254
    wind_proj_mask   (time, latitude, longitude) float64 -1.474 ... -0.8272
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;249&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 250, coords = (array(166.71284635), array(-45.44092096)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;250&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_250_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... 0.8353
    vgrd10m          (time, latitude, longitude) float32 -3.508 ... 0.3867
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.6978
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 0.1495
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 0.9205
    wind_proj        (time, latitude, longitude) float64 -1.391 ... -0.8189
    bearings         (latitude, longitude) float64 38.65 31.78 ... 211.4 218.0
    direc_proj_math  (latitude, longitude) float64 0.8962 1.016 ... -2.234
    wind_proj_mask   (time, latitude, longitude) float64 -1.391 ... -0.8189
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;250&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 251, coords = (array(170.88413098), array(-45.44092096)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;251&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_251_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.49 -44.18
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -5.14
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 33.3
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.344 1.746 ... 7.545
    bearings         (latitude, longitude) float64 34.3 26.69 ... 208.8 215.8
    direc_proj_math  (latitude, longitude) float64 0.9722 1.105 ... -2.196
    wind_proj_mask   (time, latitude, longitude) float64 2.344 1.746 ... 7.545
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;251&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 252, coords = (array(166.71284635), array(-45.39815551)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;252&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_252_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.49 -44.18
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... 0.8353
    vgrd10m          (time, latitude, longitude) float32 -3.508 ... 0.3867
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.6978
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 0.1495
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 0.9205
    wind_proj        (time, latitude, longitude) float64 -1.453 ... -0.8259
    bearings         (latitude, longitude) float64 37.72 30.93 ... 212.3 219.0
    direc_proj_math  (latitude, longitude) float64 0.9125 1.031 ... -2.251
    wind_proj_mask   (time, latitude, longitude) float64 -1.453 ... -0.8259
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;252&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 253, coords = (array(170.88413098), array(-45.39815551)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;253&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_253_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.49 -44.18
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -5.77
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -5.14
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 33.3
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 26.42
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 7.728
    wind_proj        (time, latitude, longitude) float64 2.272 1.689 ... 7.572
    bearings         (latitude, longitude) float64 33.41 25.94 ... 209.7 216.8
    direc_proj_math  (latitude, longitude) float64 0.9876 1.118 ... -2.212
    wind_proj_mask   (time, latitude, longitude) float64 2.272 1.689 ... 7.572
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;253&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 254, coords = (array(166.71284635), array(-45.35535766)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;254&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_254_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.508 -3.119 ... 2.077
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.09074
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.513 ... -1.564
    bearings         (latitude, longitude) float64 36.83 30.12 ... 207.4 213.6
    direc_proj_math  (latitude, longitude) float64 0.928 1.045 ... -2.049 -2.157
    wind_proj_mask   (time, latitude, longitude) float64 -1.513 ... -1.564
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;254&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 255, coords = (array(170.88413098), array(-45.35535766)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;255&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_255_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -4.397
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -3.777
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 19.33
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 14.27
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 5.796
    wind_proj        (time, latitude, longitude) float64 2.202 1.635 ... 5.518
    bearings         (latitude, longitude) float64 32.57 25.22 ... 205.0 211.5
    direc_proj_math  (latitude, longitude) float64 1.002 1.131 ... -2.008 -2.121
    wind_proj_mask   (time, latitude, longitude) float64 2.202 1.635 ... 5.518
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;255&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 256, coords = (array(166.71284635), array(-45.31252742)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;256&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_256_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.508 -3.119 ... 2.077
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.09074
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.57 -1.356 ... -1.544
    bearings         (latitude, longitude) float64 35.97 29.35 ... 208.1 214.4
    direc_proj_math  (latitude, longitude) float64 0.943 1.059 ... -2.061 -2.17
    wind_proj_mask   (time, latitude, longitude) float64 -1.57 -1.356 ... -1.544
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;256&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 257, coords = (array(166.77329975), array(-45.31252742)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;257&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_257_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.508 -3.119 ... 2.077
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.09074
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.492 ... -1.572
    bearings         (latitude, longitude) float64 37.14 30.71 ... 206.8 213.2
    direc_proj_math  (latitude, longitude) float64 0.9225 1.035 ... -2.038 -2.15
    wind_proj_mask   (time, latitude, longitude) float64 -1.492 ... -1.572
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;257&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 258, coords = (array(170.88413098), array(-45.31252742)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;258&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_258_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -4.397
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -3.777
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 19.33
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 14.27
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 5.796
    wind_proj        (time, latitude, longitude) float64 2.135 1.584 ... 5.541
    bearings         (latitude, longitude) float64 31.76 24.54 ... 205.7 212.3
    direc_proj_math  (latitude, longitude) float64 1.016 1.143 ... -2.019 -2.134
    wind_proj_mask   (time, latitude, longitude) float64 2.135 1.584 ... 5.541
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;258&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 259, coords = (array(166.77329975), array(-45.26966479)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;259&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_259_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         27G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.3 165.6 165.9 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.16 2.779 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.508 -3.119 ... 2.077
    uw2              (time, latitude, longitude) float32 4.665 7.726 ... 0.09074
    vw2              (time, latitude, longitude) float32 12.31 9.729 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.12 4.178 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.548 ... -1.553
    bearings         (latitude, longitude) float64 36.31 29.95 ... 207.5 214.0
    direc_proj_math  (latitude, longitude) float64 0.9371 1.048 ... -2.05 -2.165
    wind_proj_mask   (time, latitude, longitude) float64 -1.548 ... -1.553
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;259&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 260, coords = (array(166.83375315), array(-45.26966479)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;260&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_260_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.779 3.448 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.119 -2.568 ... 2.077
    uw2              (time, latitude, longitude) float32 7.726 11.89 ... 0.09074
    vw2              (time, latitude, longitude) float32 9.729 6.595 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.178 4.299 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.225 ... -1.582
    bearings         (latitude, longitude) float64 31.25 24.18 ... 206.1 212.8
    direc_proj_math  (latitude, longitude) float64 1.025 1.149 ... -2.026 -2.144
    wind_proj_mask   (time, latitude, longitude) float64 -1.225 ... -1.582
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;260&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 261, coords = (array(170.88413098), array(-45.26966479)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;261&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_261_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -4.397
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -3.777
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 19.33
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 14.27
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 5.796
    wind_proj        (time, latitude, longitude) float64 2.071 1.534 ... 5.564
    bearings         (latitude, longitude) float64 30.99 23.89 ... 206.4 213.1
    direc_proj_math  (latitude, longitude) float64 1.03 1.154 ... -2.031 -2.148
    wind_proj_mask   (time, latitude, longitude) float64 2.071 1.534 ... 5.564
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;261&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 262, coords = (array(170.94458438), array(-45.26966479)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;262&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_262_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -4.397
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -3.777
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 19.33
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 14.27
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 5.796
    wind_proj        (time, latitude, longitude) float64 2.177 1.643 ... 5.529
    bearings         (latitude, longitude) float64 32.26 25.33 ... 205.0 211.8
    direc_proj_math  (latitude, longitude) float64 1.008 1.129 ... -2.007 -2.127
    wind_proj_mask   (time, latitude, longitude) float64 2.177 1.643 ... 5.529
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;262&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 263, coords = (array(166.83375315), array(-45.22676977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;263&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_263_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.779 3.448 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.119 -2.568 ... 2.077
    uw2              (time, latitude, longitude) float32 7.726 11.89 ... 0.09074
    vw2              (time, latitude, longitude) float32 9.729 6.595 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.178 4.299 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.276 ... -1.562
    bearings         (latitude, longitude) float64 30.51 23.56 ... 206.8 213.7
    direc_proj_math  (latitude, longitude) float64 1.038 1.16 ... -2.039 -2.158
    wind_proj_mask   (time, latitude, longitude) float64 -1.276 ... -1.562
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;263&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 264, coords = (array(166.89420655), array(-45.22676977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;264&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_264_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.779 3.448 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.119 -2.568 ... 2.077
    uw2              (time, latitude, longitude) float32 7.726 11.89 ... 0.09074
    vw2              (time, latitude, longitude) float32 9.729 6.595 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.178 4.299 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.189 ... -1.592
    bearings         (latitude, longitude) float64 31.76 24.97 ... 205.4 212.4
    direc_proj_math  (latitude, longitude) float64 1.017 1.135 ... -2.014 -2.137
    wind_proj_mask   (time, latitude, longitude) float64 -1.189 ... -1.592
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;264&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 265, coords = (array(170.94458438), array(-45.22676977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;265&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_265_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -4.397
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -3.777
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 19.33
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 14.27
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 5.796
    wind_proj        (time, latitude, longitude) float64 2.114 1.595 ... 5.553
    bearings         (latitude, longitude) float64 31.51 24.69 ... 205.7 212.7
    direc_proj_math  (latitude, longitude) float64 1.021 1.14 ... -2.019 -2.141
    wind_proj_mask   (time, latitude, longitude) float64 2.114 1.595 ... 5.553
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;265&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 266, coords = (array(166.89420655), array(-45.18384235)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;266&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_266_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.5 167.8 168.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.779 3.448 ... -0.3012
    vgrd10m          (time, latitude, longitude) float32 -3.119 -2.568 ... 2.077
    uw2              (time, latitude, longitude) float32 7.726 11.89 ... 0.09074
    vw2              (time, latitude, longitude) float32 9.729 6.595 ... 4.312
    wind_magnitude   (time, latitude, longitude) float32 4.178 4.299 ... 2.098
    wind_proj        (time, latitude, longitude) float64 -1.24 -0.918 ... -1.571
    bearings         (latitude, longitude) float64 31.03 24.35 ... 206.1 213.3
    direc_proj_math  (latitude, longitude) float64 1.029 1.146 ... -2.027 -2.151
    wind_proj_mask   (time, latitude, longitude) float64 -1.24 -0.918 ... -1.571
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;266&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 267, coords = (array(166.95465995), array(-45.18384235)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;267&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_267_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.779 3.448 ... -2.878
    vgrd10m          (time, latitude, longitude) float32 -3.119 ... 0.1709
    uw2              (time, latitude, longitude) float32 7.726 11.89 ... 8.282
    vw2              (time, latitude, longitude) float32 9.729 6.595 ... 0.02921
    wind_magnitude   (time, latitude, longitude) float32 4.178 4.299 ... 2.883
    wind_proj        (time, latitude, longitude) float64 -1.156 ... 1.648
    bearings         (latitude, longitude) float64 32.23 25.7 ... 212.0 218.3
    direc_proj_math  (latitude, longitude) float64 1.008 1.122 ... -2.129 -2.239
    wind_proj_mask   (time, latitude, longitude) float64 -1.156 ... 1.648
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;267&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 268, coords = (array(170.94458438), array(-45.18384235)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;268&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_268_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.6 171.9 172.2
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -4.397
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -3.777
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 19.33
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 14.27
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 5.796
    wind_proj        (time, latitude, longitude) float64 2.054 1.549 ... 5.577
    bearings         (latitude, longitude) float64 30.78 24.07 ... 206.4 213.5
    direc_proj_math  (latitude, longitude) float64 1.034 1.151 ... -2.032 -2.156
    wind_proj_mask   (time, latitude, longitude) float64 2.054 1.549 ... 5.577
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;268&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 269, coords = (array(171.00503778), array(-45.18384235)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;269&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_269_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.68 -46.37 -46.05 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 5.168 4.6 ... -5.412
    vgrd10m          (time, latitude, longitude) float32 -0.6879 ... -4.683
    uw2              (time, latitude, longitude) float32 26.71 21.16 ... 29.29
    vw2              (time, latitude, longitude) float32 0.4732 0.1288 ... 21.93
    wind_magnitude   (time, latitude, longitude) float32 5.214 4.614 ... 7.157
    wind_proj        (time, latitude, longitude) float64 2.155 1.651 ... 7.033
    bearings         (latitude, longitude) float64 31.99 25.43 ... 212.2 218.5
    direc_proj_math  (latitude, longitude) float64 1.012 1.127 ... -2.133 -2.243
    wind_proj_mask   (time, latitude, longitude) float64 2.155 1.651 ... 7.033
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;269&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 270, coords = (array(166.95465995), array(-45.14088254)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;270&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_270_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.478 3.358 ... -2.878
    vgrd10m          (time, latitude, longitude) float32 -3.698 -2.85 ... 0.1709
    uw2              (time, latitude, longitude) float32 6.142 11.28 ... 8.282
    vw2              (time, latitude, longitude) float32 13.68 8.122 ... 0.02921
    wind_magnitude   (time, latitude, longitude) float32 4.452 4.405 ... 2.883
    wind_proj        (time, latitude, longitude) float64 -1.417 ... 1.687
    bearings         (latitude, longitude) float64 37.61 30.45 ... 212.8 219.2
    direc_proj_math  (latitude, longitude) float64 0.9143 1.039 ... -2.255
    wind_proj_mask   (time, latitude, longitude) float64 -1.417 ... 1.687
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;270&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 271, coords = (array(171.00503778), array(-45.14088254)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;271&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_271_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -5.412
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -4.683
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 29.29
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 21.93
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 7.157
    wind_proj        (time, latitude, longitude) float64 2.494 2.66 ... 7.054
    bearings         (latitude, longitude) float64 37.36 30.15 ... 213.1 219.4
    direc_proj_math  (latitude, longitude) float64 0.9188 1.045 ... -2.259
    wind_proj_mask   (time, latitude, longitude) float64 2.494 2.66 ... 7.054
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;271&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 272, coords = (array(166.95465995), array(-45.09789033)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;272&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_272_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.478 3.358 ... -2.878
    vgrd10m          (time, latitude, longitude) float32 -3.698 -2.85 ... 0.1709
    uw2              (time, latitude, longitude) float32 6.142 11.28 ... 8.282
    vw2              (time, latitude, longitude) float32 13.68 8.122 ... 0.02921
    wind_magnitude   (time, latitude, longitude) float32 4.452 4.405 ... 2.883
    wind_proj        (time, latitude, longitude) float64 -1.486 ... 1.726
    bearings         (latitude, longitude) float64 36.68 29.61 ... 213.8 220.2
    direc_proj_math  (latitude, longitude) float64 0.9306 1.054 ... -2.16 -2.272
    wind_proj_mask   (time, latitude, longitude) float64 -1.486 ... 1.726
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;272&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 273, coords = (array(167.01511335), array(-45.09789033)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;273&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_273_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -44.18 -43.87
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.478 3.358 ... -2.878
    vgrd10m          (time, latitude, longitude) float32 -3.698 -2.85 ... 0.1709
    uw2              (time, latitude, longitude) float32 6.142 11.28 ... 8.282
    vw2              (time, latitude, longitude) float32 13.68 8.122 ... 0.02921
    wind_magnitude   (time, latitude, longitude) float32 4.452 4.405 ... 2.883
    wind_proj        (time, latitude, longitude) float64 -1.394 -0.7085 ... 1.68
    bearings         (latitude, longitude) float64 37.92 31.06 ... 212.4 219.0
    direc_proj_math  (latitude, longitude) float64 0.9089 1.029 ... -2.252
    wind_proj_mask   (time, latitude, longitude) float64 -1.394 -0.7085 ... 1.68
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;273&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 274, coords = (array(171.00503778), array(-45.09789033)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;274&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_274_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -5.412
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -4.683
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 29.29
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 21.93
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 7.157
    wind_proj        (time, latitude, longitude) float64 2.448 2.617 ... 7.074
    bearings         (latitude, longitude) float64 36.42 29.31 ... 214.0 220.4
    direc_proj_math  (latitude, longitude) float64 0.9351 1.059 ... -2.276
    wind_proj_mask   (time, latitude, longitude) float64 2.448 2.617 ... 7.074
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;274&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 275, coords = (array(171.06549118), array(-45.09789033)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;275&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_275_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -44.18 -43.87
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -5.412
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -4.683
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 29.29
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 21.93
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 7.157
    wind_proj        (time, latitude, longitude) float64 2.51 2.691 ... 7.051
    bearings         (latitude, longitude) float64 37.68 30.77 ... 212.7 219.3
    direc_proj_math  (latitude, longitude) float64 0.9132 1.034 ... -2.256
    wind_proj_mask   (time, latitude, longitude) float64 2.51 2.691 ... 7.051
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;275&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 276, coords = (array(167.01511335), array(-45.05486573)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;276&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_276_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.478 3.358 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -3.698 -2.85 ... 1.051
    uw2              (time, latitude, longitude) float32 6.142 11.28 ... 13.79
    vw2              (time, latitude, longitude) float32 13.68 8.122 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.452 4.405 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -1.461 ... 1.185
    bearings         (latitude, longitude) float64 37.01 30.24 ... 207.5 213.7
    direc_proj_math  (latitude, longitude) float64 0.9248 1.043 ... -2.159
    wind_proj_mask   (time, latitude, longitude) float64 -1.461 ... 1.185
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;276&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 277, coords = (array(171.06549118), array(-45.05486573)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;277&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_277_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -3.149
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 16.22
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.465 2.65 ... 4.86
    bearings         (latitude, longitude) float64 36.77 29.96 ... 207.8 213.9
    direc_proj_math  (latitude, longitude) float64 0.929 1.048 ... -2.056 -2.163
    wind_proj_mask   (time, latitude, longitude) float64 2.465 2.65 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;277&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 278, coords = (array(171.12594458), array(-45.05486573)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;278&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_278_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -3.149
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 16.22
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.524 2.72 ... 4.828
    bearings         (latitude, longitude) float64 37.97 31.35 ... 206.5 212.8
    direc_proj_math  (latitude, longitude) float64 0.9081 1.024 ... -2.143
    wind_proj_mask   (time, latitude, longitude) float64 2.524 2.72 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;278&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 279, coords = (array(167.01511335), array(-45.01180874)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;279&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_279_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.478 3.358 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -3.698 -2.85 ... 1.051
    uw2              (time, latitude, longitude) float32 6.142 11.28 ... 13.79
    vw2              (time, latitude, longitude) float32 13.68 8.122 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.452 4.405 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -1.525 ... 1.235
    bearings         (latitude, longitude) float64 36.14 29.46 ... 208.2 214.5
    direc_proj_math  (latitude, longitude) float64 0.94 1.057 ... -2.064 -2.172
    wind_proj_mask   (time, latitude, longitude) float64 -1.525 ... 1.235
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;279&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 280, coords = (array(167.07556675), array(-45.01180874)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;280&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_280_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.478 3.358 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -3.698 -2.85 ... 1.051
    uw2              (time, latitude, longitude) float32 6.142 11.28 ... 13.79
    vw2              (time, latitude, longitude) float32 13.68 8.122 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.452 4.405 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -1.438 ... 1.162
    bearings         (latitude, longitude) float64 37.33 30.82 ... 206.9 213.3
    direc_proj_math  (latitude, longitude) float64 0.9193 1.033 ... -2.153
    wind_proj_mask   (time, latitude, longitude) float64 -1.438 ... 1.162
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;280&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 281, coords = (array(171.12594458), array(-45.01180874)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;281&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_281_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -3.149
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 16.22
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.481 2.68 ... 4.851
    bearings         (latitude, longitude) float64 37.09 30.55 ... 207.2 213.6
    direc_proj_math  (latitude, longitude) float64 0.9234 1.038 ... -2.157
    wind_proj_mask   (time, latitude, longitude) float64 2.481 2.68 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;281&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 282, coords = (array(171.18639798), array(-45.01180874)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;282&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_282_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -3.149
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 16.22
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.538 2.747 ... 4.817
    bearings         (latitude, longitude) float64 38.25 31.89 ... 205.9 212.4
    direc_proj_math  (latitude, longitude) float64 0.9032 1.014 ... -2.136
    wind_proj_mask   (time, latitude, longitude) float64 2.538 2.747 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;282&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 283, coords = (array(167.07556675), array(-44.96871935)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;283&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_283_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.6 165.9 166.2 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.478 3.358 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -3.698 -2.85 ... 1.051
    uw2              (time, latitude, longitude) float32 6.142 11.28 ... 13.79
    vw2              (time, latitude, longitude) float32 13.68 8.122 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.452 4.405 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -1.5 -0.7847 ... 1.214
    bearings         (latitude, longitude) float64 36.48 30.06 ... 207.6 214.1
    direc_proj_math  (latitude, longitude) float64 0.9341 1.046 ... -2.167
    wind_proj_mask   (time, latitude, longitude) float64 -1.5 -0.7847 ... 1.214
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;283&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 284, coords = (array(167.13602015), array(-44.96871935)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;284&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_284_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.358 4.16 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -2.85 -1.658 ... 1.051
    uw2              (time, latitude, longitude) float32 11.28 17.3 ... 13.79
    vw2              (time, latitude, longitude) float32 8.122 2.749 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.405 4.478 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -0.6851 ... 1.138
    bearings         (latitude, longitude) float64 31.37 24.22 ... 206.3 213.0
    direc_proj_math  (latitude, longitude) float64 1.023 1.148 ... -2.029 -2.146
    wind_proj_mask   (time, latitude, longitude) float64 -0.6851 ... 1.138
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;284&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 285, coords = (array(171.18639798), array(-44.96871935)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;285&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_285_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -3.149
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 16.22
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.496 2.708 ... 4.84
    bearings         (latitude, longitude) float64 37.4 31.11 ... 206.6 213.2
    direc_proj_math  (latitude, longitude) float64 0.9181 1.028 ... -2.034 -2.15
    wind_proj_mask   (time, latitude, longitude) float64 2.496 2.708 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;285&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 286, coords = (array(167.13602015), array(-44.92559757)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;286&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_286_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.358 4.16 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -2.85 -1.658 ... 1.051
    uw2              (time, latitude, longitude) float32 11.28 17.3 ... 13.79
    vw2              (time, latitude, longitude) float32 8.122 2.749 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.405 4.478 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -0.7423 ... 1.192
    bearings         (latitude, longitude) float64 30.62 23.59 ... 207.0 213.8
    direc_proj_math  (latitude, longitude) float64 1.036 1.159 ... -2.042 -2.161
    wind_proj_mask   (time, latitude, longitude) float64 -0.7423 ... 1.192
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;286&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 287, coords = (array(167.19647355), array(-44.92559757)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;287&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_287_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.358 4.16 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -2.85 -1.658 ... 1.051
    uw2              (time, latitude, longitude) float32 11.28 17.3 ... 13.79
    vw2              (time, latitude, longitude) float32 8.122 2.749 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.405 4.478 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -0.6465 ... 1.112
    bearings         (latitude, longitude) float64 31.88 25.01 ... 205.6 212.6
    direc_proj_math  (latitude, longitude) float64 1.014 1.134 ... -2.017 -2.139
    wind_proj_mask   (time, latitude, longitude) float64 -0.6465 ... 1.112
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;287&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 288, coords = (array(171.18639798), array(-44.92559757)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;288&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_288_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -3.149
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 16.22
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.455 2.67 ... 4.864
    bearings         (latitude, longitude) float64 36.57 30.36 ... 207.3 214.0
    direc_proj_math  (latitude, longitude) float64 0.9325 1.041 ... -2.165
    wind_proj_mask   (time, latitude, longitude) float64 2.455 2.67 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;288&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 289, coords = (array(167.19647355), array(-44.88244339)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;289&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_289_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.358 4.16 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -2.85 -1.658 ... 1.051
    uw2              (time, latitude, longitude) float32 11.28 17.3 ... 13.79
    vw2              (time, latitude, longitude) float32 8.122 2.749 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 4.405 4.478 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -0.7025 ... 1.167
    bearings         (latitude, longitude) float64 31.14 24.38 ... 206.3 213.4
    direc_proj_math  (latitude, longitude) float64 1.027 1.145 ... -2.03 -2.154
    wind_proj_mask   (time, latitude, longitude) float64 -0.7025 ... 1.167
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;289&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 290, coords = (array(171.18639798), array(-44.88244339)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;290&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_290_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.37 -46.05 -45.74 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.758 3.85 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 0.2692 ... -3.149
    uw2              (time, latitude, longitude) float32 14.12 14.82 ... 16.22
    vw2              (time, latitude, longitude) float32 0.07246 0.705 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.768 3.94 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.416 2.634 ... 4.887
    bearings         (latitude, longitude) float64 35.78 29.64 ... 208.1 214.9
    direc_proj_math  (latitude, longitude) float64 0.9463 1.053 ... -2.061 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 2.416 2.634 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;290&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 291, coords = (array(167.19647355), array(-44.83925682)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;291&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_291_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 167.8 168.1 168.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.668 3.499 ... -3.713
    vgrd10m          (time, latitude, longitude) float32 -2.69 -1.348 ... 1.051
    uw2              (time, latitude, longitude) float32 7.12 12.25 ... 13.79
    vw2              (time, latitude, longitude) float32 7.235 1.817 ... 1.105
    wind_magnitude   (time, latitude, longitude) float32 3.789 3.75 ... 3.859
    wind_proj        (time, latitude, longitude) float64 -0.5765 ... 1.224
    bearings         (latitude, longitude) float64 36.48 29.0 ... 207.1 214.3
    direc_proj_math  (latitude, longitude) float64 0.9342 1.065 ... -2.169
    wind_proj_mask   (time, latitude, longitude) float64 -0.5765 ... 1.224
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;291&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 292, coords = (array(167.25692695), array(-44.83925682)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;292&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_292_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.668 3.499 ... -7.228
    vgrd10m          (time, latitude, longitude) float32 -2.69 -1.348 ... -1.124
    uw2              (time, latitude, longitude) float32 7.12 12.25 ... 52.24
    vw2              (time, latitude, longitude) float32 7.235 1.817 ... 1.263
    wind_magnitude   (time, latitude, longitude) float32 3.789 3.75 ... 7.314
    wind_proj        (time, latitude, longitude) float64 -0.4908 ... 5.449
    bearings         (latitude, longitude) float64 37.79 30.54 ... 213.0 219.3
    direc_proj_math  (latitude, longitude) float64 0.9113 1.038 ... -2.257
    wind_proj_mask   (time, latitude, longitude) float64 -0.4908 ... 5.449
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;292&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 293, coords = (array(167.31738035), array(-44.83925682)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;293&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_293_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.668 3.499 ... -7.228
    vgrd10m          (time, latitude, longitude) float32 -2.69 -1.348 ... -1.124
    uw2              (time, latitude, longitude) float32 7.12 12.25 ... 52.24
    vw2              (time, latitude, longitude) float32 7.235 1.817 ... 1.263
    wind_magnitude   (time, latitude, longitude) float32 3.789 3.75 ... 7.314
    wind_proj        (time, latitude, longitude) float64 -0.4077 0.7136 ... 5.35
    bearings         (latitude, longitude) float64 39.05 32.04 ... 211.6 218.2
    direc_proj_math  (latitude, longitude) float64 0.8892 1.012 ... -2.237
    wind_proj_mask   (time, latitude, longitude) float64 -0.4077 0.7136 ... 5.35
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;293&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 294, coords = (array(171.18639798), array(-44.83925682)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;294&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_294_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.649 2.69 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 1.538 2.288 ... -3.149
    uw2              (time, latitude, longitude) float32 7.018 7.235 ... 16.22
    vw2              (time, latitude, longitude) float32 2.366 5.235 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.063 3.531 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.906 3.415 ... 4.91
    bearings         (latitude, longitude) float64 41.42 34.85 ... 208.9 215.8
    direc_proj_math  (latitude, longitude) float64 0.8478 0.9626 ... -2.196
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.415 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;294&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 295, coords = (array(167.31738035), array(-44.79603786)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;295&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_295_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.668 3.499 ... -7.228
    vgrd10m          (time, latitude, longitude) float32 -2.69 -1.348 ... -1.124
    uw2              (time, latitude, longitude) float32 7.12 12.25 ... 52.24
    vw2              (time, latitude, longitude) float32 7.235 1.817 ... 1.263
    wind_magnitude   (time, latitude, longitude) float32 3.789 3.75 ... 7.314
    wind_proj        (time, latitude, longitude) float64 -0.4709 ... 5.434
    bearings         (latitude, longitude) float64 38.09 31.16 ... 212.5 219.1
    direc_proj_math  (latitude, longitude) float64 0.906 1.027 ... -2.139 -2.254
    wind_proj_mask   (time, latitude, longitude) float64 -0.4709 ... 5.434
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;295&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 296, coords = (array(167.37783375), array(-44.79603786)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;296&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_296_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.668 3.499 ... -7.228
    vgrd10m          (time, latitude, longitude) float32 -2.69 -1.348 ... -1.124
    uw2              (time, latitude, longitude) float32 7.12 12.25 ... 52.24
    vw2              (time, latitude, longitude) float32 7.235 1.817 ... 1.263
    wind_magnitude   (time, latitude, longitude) float32 3.789 3.75 ... 7.314
    wind_proj        (time, latitude, longitude) float64 -0.391 0.7489 ... 5.332
    bearings         (latitude, longitude) float64 39.3 32.59 ... 211.1 218.0
    direc_proj_math  (latitude, longitude) float64 0.8848 1.002 ... -2.233
    wind_proj_mask   (time, latitude, longitude) float64 -0.391 0.7489 ... 5.332
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;296&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 297, coords = (array(171.18639798), array(-44.79603786)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;297&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_297_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.649 2.69 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 1.538 2.288 ... -3.149
    uw2              (time, latitude, longitude) float32 7.018 7.235 ... 16.22
    vw2              (time, latitude, longitude) float32 2.366 5.235 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.063 3.531 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.889 3.4 ... 4.933
    bearings         (latitude, longitude) float64 40.45 33.93 ... 209.7 216.8
    direc_proj_math  (latitude, longitude) float64 0.8649 0.9786 ... -2.213
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.4 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;297&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 298, coords = (array(167.37783375), array(-44.7527865)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;298&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_298_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 165.9 166.2 166.6 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.668 3.499 ... -7.228
    vgrd10m          (time, latitude, longitude) float32 -2.69 -1.348 ... -1.124
    uw2              (time, latitude, longitude) float32 7.12 12.25 ... 52.24
    vw2              (time, latitude, longitude) float32 7.235 1.817 ... 1.263
    wind_magnitude   (time, latitude, longitude) float32 3.789 3.75 ... 7.314
    wind_proj        (time, latitude, longitude) float64 -0.4523 ... 5.419
    bearings         (latitude, longitude) float64 38.37 31.73 ... 212.1 219.0
    direc_proj_math  (latitude, longitude) float64 0.9011 1.017 ... -2.13 -2.251
    wind_proj_mask   (time, latitude, longitude) float64 -0.4523 ... 5.419
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;298&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 299, coords = (array(167.43828715), array(-44.7527865)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;299&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_299_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -7.228
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -1.124
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 52.24
    vw2              (time, latitude, longitude) float32 1.817 ... 1.263
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 7.314
    wind_proj        (time, latitude, longitude) float64 0.7815 1.651 ... 5.311
    bearings         (latitude, longitude) float64 33.1 25.61 ... 210.6 217.7
    direc_proj_math  (latitude, longitude) float64 0.9932 1.124 ... -2.229
    wind_proj_mask   (time, latitude, longitude) float64 0.7815 1.651 ... 5.311
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;299&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 300, coords = (array(171.18639798), array(-44.7527865)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;300&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_300_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.87 -43.56
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.649 2.69 ... -4.027
    vgrd10m          (time, latitude, longitude) float32 1.538 2.288 ... -3.149
    uw2              (time, latitude, longitude) float32 7.018 7.235 ... 16.22
    vw2              (time, latitude, longitude) float32 2.366 5.235 ... 9.917
    wind_magnitude   (time, latitude, longitude) float32 3.063 3.531 ... 5.112
    wind_proj        (time, latitude, longitude) float64 2.872 3.385 ... 4.956
    bearings         (latitude, longitude) float64 39.51 33.05 ... 210.6 217.8
    direc_proj_math  (latitude, longitude) float64 0.8813 0.9939 ... -2.23
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.385 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;300&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 301, coords = (array(167.43828715), array(-44.70950274)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;301&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_301_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -4.747
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -0.6666
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 22.54
    vw2              (time, latitude, longitude) float32 1.817 ... 0.4443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 4.794
    wind_proj        (time, latitude, longitude) float64 0.7278 1.609 ... 3.102
    bearings         (latitude, longitude) float64 32.26 24.9 ... 205.8 212.3
    direc_proj_math  (latitude, longitude) float64 1.008 1.136 ... -2.021 -2.135
    wind_proj_mask   (time, latitude, longitude) float64 0.7278 1.609 ... 3.102
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;301&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 302, coords = (array(167.49874055), array(-44.70950274)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;302&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_302_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -4.747
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -0.6666
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 22.54
    vw2              (time, latitude, longitude) float32 1.817 ... 0.4443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 4.794
    wind_proj        (time, latitude, longitude) float64 0.8117 1.698 ... 3.025
    bearings         (latitude, longitude) float64 33.57 26.4 ... 204.4 211.1
    direc_proj_math  (latitude, longitude) float64 0.9849 1.11 ... -1.997 -2.114
    wind_proj_mask   (time, latitude, longitude) float64 0.8117 1.698 ... 3.025
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;302&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 303, coords = (array(171.18639798), array(-44.70950274)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;303&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_303_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.649 2.69 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 1.538 2.288 ... -2.203
    uw2              (time, latitude, longitude) float32 7.018 7.235 ... 4.492
    vw2              (time, latitude, longitude) float32 2.366 5.235 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.063 3.531 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.855 3.37 ... 2.995
    bearings         (latitude, longitude) float64 38.6 32.22 ... 205.8 212.4
    direc_proj_math  (latitude, longitude) float64 0.8971 1.008 ... -2.136
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.37 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;303&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 304, coords = (array(167.49874055), array(-44.6661866)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;304&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_304_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -4.747
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -0.6666
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 22.54
    vw2              (time, latitude, longitude) float32 1.817 ... 0.4443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 4.794
    wind_proj        (time, latitude, longitude) float64 0.7595 1.657 ... 3.075
    bearings         (latitude, longitude) float64 32.75 25.7 ... 205.1 211.9
    direc_proj_math  (latitude, longitude) float64 0.9992 1.122 ... -2.128
    wind_proj_mask   (time, latitude, longitude) float64 0.7595 1.657 ... 3.075
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;304&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 305, coords = (array(167.55919395), array(-44.6661866)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;305&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_305_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -4.747
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -0.6666
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 22.54
    vw2              (time, latitude, longitude) float32 1.817 ... 0.4443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 4.794
    wind_proj        (time, latitude, longitude) float64 0.8399 1.741 ... 2.994
    bearings         (latitude, longitude) float64 34.01 27.14 ... 203.7 210.7
    direc_proj_math  (latitude, longitude) float64 0.9772 1.097 ... -2.106
    wind_proj_mask   (time, latitude, longitude) float64 0.8399 1.741 ... 2.994
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;305&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 306, coords = (array(171.18639798), array(-44.6661866)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;306&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_306_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.649 2.69 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 1.538 2.288 ... -2.203
    uw2              (time, latitude, longitude) float32 7.018 7.235 ... 4.492
    vw2              (time, latitude, longitude) float32 2.366 5.235 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.063 3.531 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.838 3.355 ... 3.003
    bearings         (latitude, longitude) float64 37.73 31.42 ... 206.5 213.2
    direc_proj_math  (latitude, longitude) float64 0.9122 1.022 ... -2.034 -2.15
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.355 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;306&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 307, coords = (array(167.55919395), array(-44.62283806)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;307&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_307_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         10G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.1 168.4 168.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -4.747
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -0.6666
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 22.54
    vw2              (time, latitude, longitude) float32 1.817 ... 0.4443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 4.794
    wind_proj        (time, latitude, longitude) float64 0.789 1.7 ... 3.046
    bearings         (latitude, longitude) float64 33.21 26.44 ... 204.3 211.5
    direc_proj_math  (latitude, longitude) float64 0.9911 1.109 ... -1.995 -2.12
    wind_proj_mask   (time, latitude, longitude) float64 0.789 1.7 ... 3.046
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;307&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 308, coords = (array(167.61964736), array(-44.62283806)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;308&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_308_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -2.333
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 67.69
    vw2              (time, latitude, longitude) float32 1.817 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 8.552
    wind_proj        (time, latitude, longitude) float64 0.8661 1.78 ... 6.769
    bearings         (latitude, longitude) float64 34.42 27.82 ... 210.2 216.5
    direc_proj_math  (latitude, longitude) float64 0.97 1.085 ... -2.097 -2.208
    wind_proj_mask   (time, latitude, longitude) float64 0.8661 1.78 ... 6.769
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;308&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 309, coords = (array(171.18639798), array(-44.62283806)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;309&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_309_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.649 2.69 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 1.538 2.288 ... -2.203
    uw2              (time, latitude, longitude) float32 7.018 7.235 ... 4.492
    vw2              (time, latitude, longitude) float32 2.366 5.235 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.063 3.531 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.821 3.34 ... 3.011
    bearings         (latitude, longitude) float64 36.9 30.66 ... 207.3 214.0
    direc_proj_math  (latitude, longitude) float64 0.9268 1.036 ... -2.164
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.34 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;309&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 310, coords = (array(167.61964736), array(-44.57945713)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;310&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_310_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -2.333
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 67.69
    vw2              (time, latitude, longitude) float32 1.817 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 8.552
    wind_proj        (time, latitude, longitude) float64 0.8165 1.741 ... 6.85
    bearings         (latitude, longitude) float64 33.64 27.13 ... 211.0 217.4
    direc_proj_math  (latitude, longitude) float64 0.9836 1.097 ... -2.223
    wind_proj_mask   (time, latitude, longitude) float64 0.8165 1.741 ... 6.85
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;310&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 311, coords = (array(167.68010076), array(-44.57945713)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;311&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_311_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -2.333
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 67.69
    vw2              (time, latitude, longitude) float32 1.817 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 8.552
    wind_proj        (time, latitude, longitude) float64 0.8907 1.817 ... 6.744
    bearings         (latitude, longitude) float64 34.81 28.46 ... 209.6 216.2
    direc_proj_math  (latitude, longitude) float64 0.9633 1.074 ... -2.203
    wind_proj_mask   (time, latitude, longitude) float64 0.8907 1.817 ... 6.744
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;311&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 312, coords = (array(167.74055416), array(-44.57945713)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;312&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_312_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.499 3.758 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -1.348 ... -2.333
    uw2              (time, latitude, longitude) float32 12.25 14.12 ... 67.69
    vw2              (time, latitude, longitude) float32 1.817 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 3.75 3.758 ... 8.552
    wind_proj        (time, latitude, longitude) float64 0.9626 1.891 ... 6.633
    bearings         (latitude, longitude) float64 35.94 29.75 ... 208.2 215.0
    direc_proj_math  (latitude, longitude) float64 0.9435 1.052 ... -2.182
    wind_proj_mask   (time, latitude, longitude) float64 0.9626 1.891 ... 6.633
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;312&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 313, coords = (array(171.18639798), array(-44.57945713)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;313&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_313_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 169.7 170.0 170.3 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.649 2.69 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 1.538 2.288 ... -2.203
    uw2              (time, latitude, longitude) float32 7.018 7.235 ... 4.492
    vw2              (time, latitude, longitude) float32 2.366 5.235 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.063 3.531 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.804 3.325 ... 3.019
    bearings         (latitude, longitude) float64 36.1 29.93 ... 208.0 214.9
    direc_proj_math  (latitude, longitude) float64 0.9408 1.048 ... -2.06 -2.179
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.325 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;313&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 314, coords = (array(171.24685139), array(-44.57945713)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;314&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_314_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -46.05 -45.74 -45.43 ... -43.56 -43.24
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.69 2.75 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 2.288 3.149 ... -2.203
    uw2              (time, latitude, longitude) float32 7.235 7.56 ... 4.492
    vw2              (time, latitude, longitude) float32 5.235 9.917 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.531 4.181 ... 3.057
    wind_proj        (time, latitude, longitude) float64 3.35 4.003 ... 3.008
    bearings         (latitude, longitude) float64 31.18 24.35 ... 206.6 213.6
    direc_proj_math  (latitude, longitude) float64 1.027 1.146 ... -2.035 -2.158
    wind_proj_mask   (time, latitude, longitude) float64 3.35 4.003 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;314&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 315, coords = (array(167.74055416), array(-44.53604381)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;315&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_315_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 166.2 166.6 166.9 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.698 2.91 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -1.199 ... -2.333
    uw2              (time, latitude, longitude) float32 7.281 8.467 ... 67.69
    vw2              (time, latitude, longitude) float32 1.436 0.01187 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 2.953 2.912 ... 8.552
    wind_proj        (time, latitude, longitude) float64 0.8965 1.58 ... 6.718
    bearings         (latitude, longitude) float64 41.63 35.0 ... 209.0 215.9
    direc_proj_math  (latitude, longitude) float64 0.8443 0.9599 ... -2.198
    wind_proj_mask   (time, latitude, longitude) float64 0.8965 1.58 ... 6.718
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;315&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 316, coords = (array(167.80100756), array(-44.53604381)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;316&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_316_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.333
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 67.69
    vw2              (time, latitude, longitude) float32 0.01187 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 8.552
    wind_proj        (time, latitude, longitude) float64 1.638 1.728 ... 6.601
    bearings         (latitude, longitude) float64 36.37 28.78 ... 207.6 214.7
    direc_proj_math  (latitude, longitude) float64 0.936 1.068 ... -2.052 -2.176
    wind_proj_mask   (time, latitude, longitude) float64 1.638 nan ... 6.601
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;316&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 317, coords = (array(171.24685139), array(-44.53604381)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;317&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_317_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -2.203
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 4.492
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.982 3.491 ... 3.016
    bearings         (latitude, longitude) float64 36.56 29.0 ... 207.4 214.5
    direc_proj_math  (latitude, longitude) float64 0.9327 1.065 ... -2.173
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.491 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;317&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 318, coords = (array(167.80100756), array(-44.4925981)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;318&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_318_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.333
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 67.69
    vw2              (time, latitude, longitude) float32 0.01187 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 8.552
    wind_proj        (time, latitude, longitude) float64 1.598 1.7 ... 6.689
    bearings         (latitude, longitude) float64 35.42 27.95 ... 208.4 215.6
    direc_proj_math  (latitude, longitude) float64 0.9525 1.083 ... -2.193
    wind_proj_mask   (time, latitude, longitude) float64 1.598 nan ... 6.689
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;318&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 319, coords = (array(171.24685139), array(-44.4925981)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;319&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_319_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -2.203
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 4.492
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.988 3.5 ... 3.024
    bearings         (latitude, longitude) float64 35.61 28.16 ... 208.2 215.4
    direc_proj_math  (latitude, longitude) float64 0.9493 1.079 ... -2.189
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.5 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;319&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 320, coords = (array(171.30730479), array(-44.4925981)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;320&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_320_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -2.203
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 4.492
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.979 3.484 ... 3.012
    bearings         (latitude, longitude) float64 36.92 29.69 ... 206.6 214.1
    direc_proj_math  (latitude, longitude) float64 0.9265 1.053 ... -2.167
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.484 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;320&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 321, coords = (array(167.80100756), array(-44.44912001)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;321&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_321_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -8.227
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.333
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 67.69
    vw2              (time, latitude, longitude) float32 0.01187 ... 5.443
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 8.552
    wind_proj        (time, latitude, longitude) float64 1.559 1.673 ... 6.779
    bearings         (latitude, longitude) float64 34.52 27.16 ... 209.3 216.6
    direc_proj_math  (latitude, longitude) float64 0.9683 1.097 ... -2.081 -2.21
    wind_proj_mask   (time, latitude, longitude) float64 1.559 nan ... 6.779
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;321&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 322, coords = (array(171.30730479), array(-44.44912001)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;322&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_322_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.56 -43.24
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -2.119
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -2.203
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 4.492
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 4.852
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 3.057
    wind_proj        (time, latitude, longitude) float64 2.985 3.493 ... 3.021
    bearings         (latitude, longitude) float64 35.99 28.87 ... 207.5 215.1
    direc_proj_math  (latitude, longitude) float64 0.9426 1.067 ... -2.05 -2.183
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.493 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;322&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 323, coords = (array(167.80100756), array(-44.40560952)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;323&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_323_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -0.9336
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 2.23
    vw2              (time, latitude, longitude) float32 0.01187 ... 0.8716
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 1.761
    wind_proj        (time, latitude, longitude) float64 1.522 1.648 ... 1.574
    bearings         (latitude, longitude) float64 33.65 26.41 ... 204.6 211.3
    direc_proj_math  (latitude, longitude) float64 0.9834 1.11 ... -2.001 -2.118
    wind_proj_mask   (time, latitude, longitude) float64 1.522 nan ... 1.574
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;323&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 324, coords = (array(167.86146096), array(-44.40560952)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;324&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_324_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -0.9336
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 2.23
    vw2              (time, latitude, longitude) float32 0.01187 ... 0.8716
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 1.761
    wind_proj        (time, latitude, longitude) float64 1.577 1.698 ... 1.557
    bearings         (latitude, longitude) float64 34.94 27.89 ... 203.3 210.1
    direc_proj_math  (latitude, longitude) float64 0.961 1.084 ... -1.977 -2.096
    wind_proj_mask   (time, latitude, longitude) float64 1.577 nan ... 1.557
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;324&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 325, coords = (array(171.30730479), array(-44.40560952)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;325&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_325_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 171.9 172.2 172.5
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... 0.3354
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -1.816
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 0.1125
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 3.298
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 1.847
    wind_proj        (time, latitude, longitude) float64 2.991 3.501 ... 1.406
    bearings         (latitude, longitude) float64 35.11 28.09 ... 203.1 209.9
    direc_proj_math  (latitude, longitude) float64 0.958 1.08 ... -1.973 -2.093
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.501 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;325&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 326, coords = (array(167.86146096), array(-44.36206664)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;326&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_326_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.4 168.8 169.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -0.9336
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 2.23
    vw2              (time, latitude, longitude) float32 0.01187 ... 0.8716
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 1.761
    wind_proj        (time, latitude, longitude) float64 1.541 1.673 ... 1.568
    bearings         (latitude, longitude) float64 34.1 27.15 ... 203.9 210.9
    direc_proj_math  (latitude, longitude) float64 0.9757 1.097 ... -1.988 -2.11
    wind_proj_mask   (time, latitude, longitude) float64 1.541 nan ... 1.568
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;326&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 327, coords = (array(167.92191436), array(-44.36206664)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;327&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_327_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.568
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 22.92
    vw2              (time, latitude, longitude) float32 0.01187 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.594 1.721 ... 4.884
    bearings         (latitude, longitude) float64 35.33 28.57 ... 209.6 215.8
    direc_proj_math  (latitude, longitude) float64 0.9542 1.072 ... -2.196
    wind_proj_mask   (time, latitude, longitude) float64 1.594 nan ... 4.884
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;327&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 328, coords = (array(171.30730479), array(-44.36206664)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;328&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_328_winds_gradients_12H_tl1.nc
PCs loaded from file

 ---------------------------------------------------------                         

 Experiment 1 in site 329, coords = (array(171.36775819), array(-44.36206664)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;329&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_329_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -1.724
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 2.23
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 2.281
    wind_proj        (time, latitude, longitude) float64 2.988 3.494 ... 2.271
    bearings         (latitude, longitude) float64 35.5 28.76 ... 209.4 215.7
    direc_proj_math  (latitude, longitude) float64 0.9513 1.069 ... -2.193
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.494 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;329&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 330, coords = (array(167.92191436), array(-44.31849138)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;330&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_330_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.568
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 22.92
    vw2              (time, latitude, longitude) float32 0.01187 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.559 1.696 ... 4.919
    bearings         (latitude, longitude) float64 34.51 27.84 ... 210.4 216.7
    direc_proj_math  (latitude, longitude) float64 0.9685 1.085 ... -2.211
    wind_proj_mask   (time, latitude, longitude) float64 1.559 nan ... 4.919
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;330&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 331, coords = (array(167.98236776), array(-44.31849138)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;331&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_331_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.568
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 22.92
    vw2              (time, latitude, longitude) float32 0.01187 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.609 1.742 ... 4.872
    bearings         (latitude, longitude) float64 35.69 29.2 ... 209.0 215.5
    direc_proj_math  (latitude, longitude) float64 0.9478 1.061 ... -2.191
    wind_proj_mask   (time, latitude, longitude) float64 1.609 nan ... 4.872
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;331&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 332, coords = (array(168.04282116), array(-44.31849138)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;332&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_332_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.568
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 22.92
    vw2              (time, latitude, longitude) float32 0.01187 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.658 1.785 ... 4.822
    bearings         (latitude, longitude) float64 36.85 30.53 ... 207.7 214.4
    direc_proj_math  (latitude, longitude) float64 0.9277 1.038 ... -2.054 -2.17
    wind_proj_mask   (time, latitude, longitude) float64 1.658 nan ... 4.822
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;332&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 333, coords = (array(171.36775819), array(-44.31849138)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;333&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_333_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -1.724
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 2.23
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 2.281
    wind_proj        (time, latitude, longitude) float64 2.993 3.501 ... 2.274
    bearings         (latitude, longitude) float64 34.67 28.03 ... 210.2 216.5
    direc_proj_math  (latitude, longitude) float64 0.9656 1.082 ... -2.208
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.501 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;333&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 334, coords = (array(171.42821159), array(-44.31849138)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;334&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_334_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -1.724
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 2.23
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 2.281
    wind_proj        (time, latitude, longitude) float64 2.986 3.487 ... 2.27
    bearings         (latitude, longitude) float64 35.86 29.39 ... 208.9 215.4
    direc_proj_math  (latitude, longitude) float64 0.945 1.058 ... -2.074 -2.188
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.487 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;334&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 335, coords = (array(168.04282116), array(-44.27488373)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;335&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_335_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.91 2.5 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.109 ... -2.568
    uw2              (time, latitude, longitude) float32 8.467 6.248 ... 22.92
    vw2              (time, latitude, longitude) float32 0.01187 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 2.912 2.57 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.624 1.761 ... 4.859
    bearings         (latitude, longitude) float64 36.04 29.79 ... 208.4 215.2
    direc_proj_math  (latitude, longitude) float64 0.9418 1.051 ... -2.186
    wind_proj_mask   (time, latitude, longitude) float64 1.624 nan ... 4.859
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;335&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 336, coords = (array(171.42821159), array(-44.27488373)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;336&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_336_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -1.724
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 2.23
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 2.281
    wind_proj        (time, latitude, longitude) float64 2.991 3.495 ... 2.273
    bearings         (latitude, longitude) float64 35.05 28.67 ... 209.6 216.3
    direc_proj_math  (latitude, longitude) float64 0.959 1.07 ... -2.088 -2.204
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.495 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;336&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 337, coords = (array(171.48866499), array(-44.27488373)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;337&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_337_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.74 -45.43 -45.12 ... -43.24 -42.93
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.459 1.158 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.63 3.35 ... -1.724
    uw2              (time, latitude, longitude) float32 2.129 1.341 ... 2.23
    vw2              (time, latitude, longitude) float32 6.917 11.22 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 3.008 3.544 ... 2.281
    wind_proj        (time, latitude, longitude) float64 2.984 3.48 ... 2.269
    bearings         (latitude, longitude) float64 36.19 29.97 ... 208.2 215.1
    direc_proj_math  (latitude, longitude) float64 0.9391 1.048 ... -2.183
    wind_proj_mask   (time, latitude, longitude) float64 nan 3.48 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;337&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 338, coords = (array(168.04282116), array(-44.2312437)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;338&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_338_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 166.6 166.9 167.2 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.769 3.269 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.3482 ... -2.568
    uw2              (time, latitude, longitude) float32 14.2 10.68 ... 22.92
    vw2              (time, latitude, longitude) float32 0.1213 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 3.785 3.269 ... 5.433
    wind_proj        (time, latitude, longitude) float64 2.25 1.847 ... 4.897
    bearings         (latitude, longitude) float64 41.75 35.07 ... 209.3 216.1
    direc_proj_math  (latitude, longitude) float64 0.8421 0.9587 ... -2.201
    wind_proj_mask   (time, latitude, longitude) float64 2.25 1.847 ... 4.897
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;338&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 339, coords = (array(168.10327456), array(-44.2312437)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;339&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_339_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.568
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 22.92
    vw2              (time, latitude, longitude) float32 0.001479 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.911 1.226 ... 4.845
    bearings         (latitude, longitude) float64 36.45 28.79 ... 207.8 214.9
    direc_proj_math  (latitude, longitude) float64 0.9345 1.068 ... -2.056 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 1.911 nan ... 4.845
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;339&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 340, coords = (array(171.48866499), array(-44.2312437)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;340&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_340_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 170.0 170.3 170.6 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 0.6495 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 1.899 2.389 ... -1.724
    uw2              (time, latitude, longitude) float32 0.4218 ... 2.23
    vw2              (time, latitude, longitude) float32 3.607 5.705 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 2.007 2.389 ... 2.281
    wind_proj        (time, latitude, longitude) float64 1.847 1.916 ... 2.272
    bearings         (latitude, longitude) float64 41.91 35.26 ... 209.1 216.0
    direc_proj_math  (latitude, longitude) float64 0.8393 0.9553 ... -2.199
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;340&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 341, coords = (array(171.54911839), array(-44.2312437)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;341&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_341_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -1.724
    uw2              (time, latitude, longitude) float32 0.003578 ... 2.23
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 2.281
    wind_proj        (time, latitude, longitude) float64 1.881 2.447 ... 2.268
    bearings         (latitude, longitude) float64 36.64 29.01 ... 207.6 214.7
    direc_proj_math  (latitude, longitude) float64 0.9313 1.065 ... -2.177
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.447 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;341&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 342, coords = (array(168.10327456), array(-44.18757129)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;342&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_342_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.568
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 22.92
    vw2              (time, latitude, longitude) float32 0.001479 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.867 1.198 ... 4.885
    bearings         (latitude, longitude) float64 35.49 27.94 ... 208.6 215.8
    direc_proj_math  (latitude, longitude) float64 0.9513 1.083 ... -2.07 -2.196
    wind_proj_mask   (time, latitude, longitude) float64 1.867 nan ... 4.885
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;342&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 343, coords = (array(168.16372796), array(-44.18757129)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;343&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_343_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.568
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 22.92
    vw2              (time, latitude, longitude) float32 0.001479 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.928 1.249 ... 4.829
    bearings         (latitude, longitude) float64 36.82 29.5 ... 207.1 214.5
    direc_proj_math  (latitude, longitude) float64 0.9282 1.056 ... -2.173
    wind_proj_mask   (time, latitude, longitude) float64 1.928 nan ... 4.829
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;343&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 344, coords = (array(171.54911839), array(-44.18757129)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;344&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_344_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -1.724
    uw2              (time, latitude, longitude) float32 0.003578 ... 2.23
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 2.281
    wind_proj        (time, latitude, longitude) float64 1.905 2.478 ... 2.271
    bearings         (latitude, longitude) float64 35.68 28.16 ... 208.4 215.7
    direc_proj_math  (latitude, longitude) float64 0.9481 1.079 ... -2.193
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.478 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;344&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 345, coords = (array(171.60957179), array(-44.18757129)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;345&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_345_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.2 172.5 172.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -1.493
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -1.724
    uw2              (time, latitude, longitude) float32 0.003578 ... 2.23
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 2.973
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 2.281
    wind_proj        (time, latitude, longitude) float64 1.872 2.421 ... 2.266
    bearings         (latitude, longitude) float64 37.0 29.71 ... 206.9 214.3
    direc_proj_math  (latitude, longitude) float64 0.925 1.052 ... -2.04 -2.17
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.421 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;345&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 346, coords = (array(171.67002519), array(-44.18757129)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;346&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_346_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -3.48
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -2.53
    uw2              (time, latitude, longitude) float32 0.003578 ... 12.11
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 6.399
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 4.302
    wind_proj        (time, latitude, longitude) float64 1.838 2.363 ... 4.166
    bearings         (latitude, longitude) float64 38.28 31.21 ... 213.0 219.5
    direc_proj_math  (latitude, longitude) float64 0.9027 1.026 ... -2.147 -2.26
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.363 ... nan 4.166
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;346&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 347, coords = (array(168.16372796), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;347&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_347_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 168.8 169.1 169.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... -4.788
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.568
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 22.92
    vw2              (time, latitude, longitude) float32 0.001479 ... 6.595
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 5.433
    wind_proj        (time, latitude, longitude) float64 1.885 1.222 ... 4.871
    bearings         (latitude, longitude) float64 35.89 28.67 ... 207.9 215.5
    direc_proj_math  (latitude, longitude) float64 0.9444 1.07 ... -2.059 -2.19
    wind_proj_mask   (time, latitude, longitude) float64 1.885 nan ... 4.871
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;347&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 348, coords = (array(168.22418136), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;348&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_348_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... -6.399
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.711
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 40.94
    vw2              (time, latitude, longitude) float32 0.001479 ... 7.35
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 6.949
    wind_proj        (time, latitude, longitude) float64 1.944 1.271 ... 6.227
    bearings         (latitude, longitude) float64 37.16 30.15 ... 214.1 220.7
    direc_proj_math  (latitude, longitude) float64 0.9222 1.045 ... -2.281
    wind_proj_mask   (time, latitude, longitude) float64 1.944 nan ... 6.227
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;348&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 349, coords = (array(171.67002519), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;349&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_349_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -3.48
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -2.53
    uw2              (time, latitude, longitude) float32 0.003578 ... 12.11
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 6.399
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 4.302
    wind_proj        (time, latitude, longitude) float64 1.863 2.396 ... 4.184
    bearings         (latitude, longitude) float64 37.33 30.35 ... 213.9 220.5
    direc_proj_math  (latitude, longitude) float64 0.9192 1.041 ... -2.278
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.396 ... nan 4.184
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;349&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 350, coords = (array(171.73047859), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;350&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_350_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -3.48
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -2.53
    uw2              (time, latitude, longitude) float32 0.003578 ... 12.11
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 6.399
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 4.302
    wind_proj        (time, latitude, longitude) float64 1.83 2.341 ... 4.163
    bearings         (latitude, longitude) float64 38.56 31.79 ... 212.5 219.3
    direc_proj_math  (latitude, longitude) float64 0.8978 1.016 ... -2.257
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.341 ... nan 4.163
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;350&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 351, coords = (array(183.33753149), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;351&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_351_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.91 2.809 ... -9.699
    vgrd10m          (time, latitude, longitude) float32 -4.108 -4.779 ... 1.26
    uw2              (time, latitude, longitude) float32 15.29 7.893 ... 94.08
    vw2              (time, latitude, longitude) float32 16.88 22.84 ... 1.589
    wind_magnitude   (time, latitude, longitude) float32 5.671 5.544 ... 9.781
    wind_proj        (time, latitude, longitude) float64 -0.6893 ... 5.044
    bearings         (latitude, longitude) float64 39.44 32.82 ... 211.5 218.4
    direc_proj_math  (latitude, longitude) float64 0.8825 0.998 ... -2.12 -2.242
    wind_proj_mask   (time, latitude, longitude) float64 -0.6893 ... 5.044
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;351&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 352, coords = (array(183.39798489), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;352&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_352_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 1.478 ... -9.699
    vgrd10m          (time, latitude, longitude) float32 -4.779 -4.719 ... 1.26
    uw2              (time, latitude, longitude) float32 7.893 2.186 ... 94.08
    vw2              (time, latitude, longitude) float32 22.84 22.27 ... 1.589
    wind_magnitude   (time, latitude, longitude) float32 5.544 4.946 ... 9.781
    wind_proj        (time, latitude, longitude) float64 -2.375 -3.552 ... 4.859
    bearings         (latitude, longitude) float64 34.18 26.69 ... 210.0 217.2
    direc_proj_math  (latitude, longitude) float64 0.9742 1.105 ... -2.094 -2.22
    wind_proj_mask   (time, latitude, longitude) float64 -2.375 -3.552 ... 4.859
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;352&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 353, coords = (array(183.45843829), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;353&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_353_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 1.478 ... -9.699
    vgrd10m          (time, latitude, longitude) float32 -4.779 -4.719 ... 1.26
    uw2              (time, latitude, longitude) float32 7.893 2.186 ... 94.08
    vw2              (time, latitude, longitude) float32 22.84 22.27 ... 1.589
    wind_magnitude   (time, latitude, longitude) float32 5.544 4.946 ... 9.781
    wind_proj        (time, latitude, longitude) float64 -2.259 -3.459 ... 4.665
    bearings         (latitude, longitude) float64 35.51 28.23 ... 208.4 215.9
    direc_proj_math  (latitude, longitude) float64 0.9511 1.078 ... -2.197
    wind_proj_mask   (time, latitude, longitude) float64 -2.259 -3.459 ... 4.665
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;353&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 354, coords = (array(183.51889169), array(-44.1438665)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;354&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_354_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -43.24 -42.93
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 1.478 ... -10.34
    vgrd10m          (time, latitude, longitude) float32 -4.779 -4.719 ... 1.087
    uw2              (time, latitude, longitude) float32 7.893 2.186 ... 106.8
    vw2              (time, latitude, longitude) float32 22.84 22.27 ... 1.183
    wind_magnitude   (time, latitude, longitude) float32 5.544 4.946 ... 10.39
    wind_proj        (time, latitude, longitude) float64 -2.145 -3.366 ... 5.963
    bearings         (latitude, longitude) float64 36.79 29.72 ... 214.5 221.0
    direc_proj_math  (latitude, longitude) float64 0.9287 1.052 ... -2.287
    wind_proj_mask   (time, latitude, longitude) float64 -2.145 -3.366 ... 5.963
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;354&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 355, coords = (array(168.22418136), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;355&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_355_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.423
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 1.268
    vw2              (time, latitude, longitude) float32 0.001479 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.902 1.244 ... 1.331
    bearings         (latitude, longitude) float64 36.26 29.34 ... 209.1 215.2
    direc_proj_math  (latitude, longitude) float64 0.938 1.059 ... -2.078 -2.185
    wind_proj_mask   (time, latitude, longitude) float64 1.902 nan ... 1.331
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;355&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 356, coords = (array(168.28463476), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;356&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_356_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.423
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 1.268
    vw2              (time, latitude, longitude) float32 0.001479 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.958 1.29 ... 1.376
    bearings         (latitude, longitude) float64 37.48 30.76 ... 207.8 214.1
    direc_proj_math  (latitude, longitude) float64 0.9167 1.034 ... -2.166
    wind_proj_mask   (time, latitude, longitude) float64 1.958 nan ... 1.376
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;356&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 357, coords = (array(171.73047859), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;357&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_357_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -0.9657
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -1.637
    uw2              (time, latitude, longitude) float32 0.003578 ... 0.9325
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 2.678
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 1.9
    wind_proj        (time, latitude, longitude) float64 1.855 2.373 ... 1.897
    bearings         (latitude, longitude) float64 37.64 30.95 ... 207.6 213.9
    direc_proj_math  (latitude, longitude) float64 0.9138 1.031 ... -2.163
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.373 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;357&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 358, coords = (array(171.79093199), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;358&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_358_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.3 170.6 170.9 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.05982 ... -0.9657
    vgrd10m          (time, latitude, longitude) float32 2.389 3.168 ... -1.637
    uw2              (time, latitude, longitude) float32 0.003578 ... 0.9325
    vw2              (time, latitude, longitude) float32 5.705 10.04 ... 2.678
    wind_magnitude   (time, latitude, longitude) float32 2.389 3.238 ... 1.9
    wind_proj        (time, latitude, longitude) float64 1.823 2.32 ... 1.899
    bearings         (latitude, longitude) float64 38.82 32.33 ... 206.3 212.8
    direc_proj_math  (latitude, longitude) float64 0.8932 1.007 ... -2.03 -2.143
    wind_proj_mask   (time, latitude, longitude) float64 nan 2.32 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;358&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 359, coords = (array(171.85138539), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;359&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_359_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -0.9657
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -1.637
    uw2              (time, latitude, longitude) float32 0.4472 ... 0.9325
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 2.678
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 1.9
    wind_proj        (time, latitude, longitude) float64 2.266 3.581 ... 1.9
    bearings         (latitude, longitude) float64 33.66 26.34 ... 204.9 211.6
    direc_proj_math  (latitude, longitude) float64 0.9833 1.111 ... -2.122
    wind_proj_mask   (time, latitude, longitude) float64 2.266 3.581 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;359&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 360, coords = (array(183.27707809), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;360&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_360_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.91 2.809 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -4.108 -4.779 ... 2.06
    uw2              (time, latitude, longitude) float32 15.29 7.893 ... 91.57
    vw2              (time, latitude, longitude) float32 16.88 22.84 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 5.671 5.544 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -0.8962 ... 3.678
    bearings         (latitude, longitude) float64 37.33 30.59 ... 208.0 214.2
    direc_proj_math  (latitude, longitude) float64 0.9193 1.037 ... -2.168
    wind_proj_mask   (time, latitude, longitude) float64 -0.8962 ... 3.678
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;360&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 361, coords = (array(183.33753149), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;361&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_361_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.91 2.809 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -4.108 -4.779 ... 2.06
    uw2              (time, latitude, longitude) float32 15.29 7.893 ... 91.57
    vw2              (time, latitude, longitude) float32 16.88 22.84 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 5.671 5.544 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -0.7799 ... 3.496
    bearings         (latitude, longitude) float64 38.52 31.97 ... 206.6 213.1
    direc_proj_math  (latitude, longitude) float64 0.8986 1.013 ... -2.148
    wind_proj_mask   (time, latitude, longitude) float64 -0.7799 ... 3.496
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;361&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 362, coords = (array(183.51889169), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;362&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_362_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 1.478 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -4.779 -4.719 ... 1.63
    uw2              (time, latitude, longitude) float32 7.893 2.186 ... 88.53
    vw2              (time, latitude, longitude) float32 22.84 22.27 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 5.544 4.946 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -2.225 -3.416 ... 4.139
    bearings         (latitude, longitude) float64 35.89 28.92 ... 209.4 215.5
    direc_proj_math  (latitude, longitude) float64 0.9444 1.066 ... -2.191
    wind_proj_mask   (time, latitude, longitude) float64 -2.225 -3.416 ... 4.139
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;362&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 363, coords = (array(183.57934509), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;363&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_363_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 1.478 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -4.779 -4.719 ... 1.63
    uw2              (time, latitude, longitude) float32 7.893 2.186 ... 88.53
    vw2              (time, latitude, longitude) float32 22.84 22.27 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 5.544 4.946 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -2.115 -3.326 ... 3.972
    bearings         (latitude, longitude) float64 37.12 30.35 ... 208.2 214.4
    direc_proj_math  (latitude, longitude) float64 0.9229 1.041 ... -2.171
    wind_proj_mask   (time, latitude, longitude) float64 -2.115 -3.326 ... 3.972
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;363&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 364, coords = (array(183.63979849), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;364&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_364_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 1.478 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -4.779 -4.719 ... 1.63
    uw2              (time, latitude, longitude) float32 7.893 2.186 ... 88.53
    vw2              (time, latitude, longitude) float32 22.84 22.27 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 5.544 4.946 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -2.008 -3.236 ... 3.799
    bearings         (latitude, longitude) float64 38.32 31.74 ... 206.9 213.3
    direc_proj_math  (latitude, longitude) float64 0.902 1.017 ... -2.04 -2.151
    wind_proj_mask   (time, latitude, longitude) float64 -2.008 -3.236 ... 3.799
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;364&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 365, coords = (array(183.70025189), array(-44.10012932)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;365&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_365_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 182.5 182.8 183.1 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.478 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -4.719 -3.888 ... 1.63
    uw2              (time, latitude, longitude) float32 2.186 ... 88.53
    vw2              (time, latitude, longitude) float32 22.27 15.12 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 4.946 3.888 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -3.147 -3.491 ... 3.619
    bearings         (latitude, longitude) float64 33.09 25.68 ... 205.5 212.1
    direc_proj_math  (latitude, longitude) float64 0.9933 1.123 ... -2.131
    wind_proj_mask   (time, latitude, longitude) float64 -3.147 -3.491 ... 3.619
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;365&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 366, coords = (array(168.28463476), array(-44.05635977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;366&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_366_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.423
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 1.268
    vw2              (time, latitude, longitude) float32 0.001479 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.918 1.265 ... 1.343
    bearings         (latitude, longitude) float64 36.6 29.97 ... 208.5 214.9
    direc_proj_math  (latitude, longitude) float64 0.932 1.048 ... -2.069 -2.18
    wind_proj_mask   (time, latitude, longitude) float64 1.918 nan ... 1.343
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;366&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 367, coords = (array(171.85138539), array(-44.05635977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;367&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_367_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -0.9657
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -1.637
    uw2              (time, latitude, longitude) float32 0.4472 ... 0.9325
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 2.678
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 1.9
    wind_proj        (time, latitude, longitude) float64 2.3 3.61 ... 1.899
    bearings         (latitude, longitude) float64 32.83 25.63 ... 205.6 212.4
    direc_proj_math  (latitude, longitude) float64 0.9979 1.124 ... -2.136
    wind_proj_mask   (time, latitude, longitude) float64 2.3 3.61 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;367&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 368, coords = (array(171.91183879), array(-44.05635977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;368&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_368_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.5 172.8 173.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -0.9657
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -1.637
    uw2              (time, latitude, longitude) float32 0.4472 ... 0.9325
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 2.678
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 1.9
    wind_proj        (time, latitude, longitude) float64 2.248 3.549 ... 1.9
    bearings         (latitude, longitude) float64 34.11 27.1 ... 204.2 211.1
    direc_proj_math  (latitude, longitude) float64 0.9755 1.098 ... -2.114
    wind_proj_mask   (time, latitude, longitude) float64 2.248 3.549 ... nan nan
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;368&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 369, coords = (array(171.97229219), array(-44.05635977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;369&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_369_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -2.831
    uw2              (time, latitude, longitude) float32 0.4472 0.2807 ... 9.386
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 4.171
    wind_proj        (time, latitude, longitude) float64 2.197 3.488 ... 4.092
    bearings         (latitude, longitude) float64 35.35 28.53 ... 209.9 216.1
    direc_proj_math  (latitude, longitude) float64 0.9538 1.073 ... -2.092 -2.2
    wind_proj_mask   (time, latitude, longitude) float64 2.197 3.488 ... 4.092
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;369&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 370, coords = (array(183.27707809), array(-44.05635977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;370&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_370_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.91 2.809 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -4.108 -4.779 ... 2.06
    uw2              (time, latitude, longitude) float32 15.29 7.893 ... 91.57
    vw2              (time, latitude, longitude) float32 16.88 22.84 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 5.671 5.544 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -0.9818 ... 3.807
    bearings         (latitude, longitude) float64 36.45 29.79 ... 208.7 215.0
    direc_proj_math  (latitude, longitude) float64 0.9346 1.051 ... -2.182
    wind_proj_mask   (time, latitude, longitude) float64 -0.9818 ... 3.807
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;370&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 371, coords = (array(183.70025189), array(-44.05635977)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;371&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_371_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 182.5 182.8 183.1 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.478 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -4.719 -3.888 ... 1.63
    uw2              (time, latitude, longitude) float32 2.186 ... 88.53
    vw2              (time, latitude, longitude) float32 22.27 15.12 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 4.946 3.888 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -3.202 -3.512 ... 3.741
    bearings         (latitude, longitude) float64 32.26 24.98 ... 206.2 212.9
    direc_proj_math  (latitude, longitude) float64 1.008 1.135 ... -2.028 -2.145
    wind_proj_mask   (time, latitude, longitude) float64 -3.202 -3.512 ... 3.741
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;371&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 372, coords = (array(168.28463476), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;372&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_372_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.423
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 1.268
    vw2              (time, latitude, longitude) float32 0.001479 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.879 1.24 ... 1.309
    bearings         (latitude, longitude) float64 35.76 29.21 ... 209.3 215.7
    direc_proj_math  (latitude, longitude) float64 0.9467 1.061 ... -2.195
    wind_proj_mask   (time, latitude, longitude) float64 1.879 nan ... 1.309
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;372&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 373, coords = (array(168.34508816), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;373&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_373_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.423
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 1.268
    vw2              (time, latitude, longitude) float32 0.001479 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.933 1.283 ... 1.356
    bearings         (latitude, longitude) float64 36.92 30.55 ... 207.9 214.6
    direc_proj_math  (latitude, longitude) float64 0.9264 1.038 ... -2.174
    wind_proj_mask   (time, latitude, longitude) float64 1.933 nan ... 1.356
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;373&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 374, coords = (array(171.97229219), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;374&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_374_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -2.831
    uw2              (time, latitude, longitude) float32 0.4472 0.2807 ... 9.386
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 4.171
    wind_proj        (time, latitude, longitude) float64 2.231 3.52 ... 4.103
    bearings         (latitude, longitude) float64 34.52 27.79 ... 210.7 216.9
    direc_proj_math  (latitude, longitude) float64 0.9683 1.086 ... -2.215
    wind_proj_mask   (time, latitude, longitude) float64 2.231 3.52 ... 4.103
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;374&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 375, coords = (array(172.03274559), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;375&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_375_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -2.831
    uw2              (time, latitude, longitude) float32 0.4472 0.2807 ... 9.386
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 4.171
    wind_proj        (time, latitude, longitude) float64 2.182 3.46 ... 4.088
    bearings         (latitude, longitude) float64 35.72 29.17 ... 209.3 215.8
    direc_proj_math  (latitude, longitude) float64 0.9474 1.062 ... -2.195
    wind_proj_mask   (time, latitude, longitude) float64 2.182 3.46 ... 4.088
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;375&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 376, coords = (array(172.09319899), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;376&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_376_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -2.831
    uw2              (time, latitude, longitude) float32 0.4472 0.2807 ... 9.386
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 4.171
    wind_proj        (time, latitude, longitude) float64 2.133 3.4 ... 4.07
    bearings         (latitude, longitude) float64 36.88 30.51 ... 208.0 214.6
    direc_proj_math  (latitude, longitude) float64 0.927 1.038 ... -2.059 -2.175
    wind_proj_mask   (time, latitude, longitude) float64 2.133 3.4 ... nan 4.07
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;376&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 377, coords = (array(183.27707809), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;377&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_377_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.91 2.809 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -4.108 -4.779 ... 2.06
    uw2              (time, latitude, longitude) float32 15.29 7.893 ... 91.57
    vw2              (time, latitude, longitude) float32 16.88 22.84 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 5.671 5.544 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -1.064 -2.815 ... 3.941
    bearings         (latitude, longitude) float64 35.61 29.04 ... 209.5 215.9
    direc_proj_math  (latitude, longitude) float64 0.9493 1.064 ... -2.197
    wind_proj_mask   (time, latitude, longitude) float64 -1.064 -2.815 ... 3.941
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;377&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 378, coords = (array(183.63979849), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;378&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_378_winds_gradients_12H_tl1.nc
PCs loaded from file
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> ---------------------------------------------------------                         

 Experiment 1 in site 379, coords = (array(183.70025189), array(-44.01255784)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;379&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_379_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 182.5 182.8 183.1 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.478 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -4.719 -3.888 ... 1.63
    uw2              (time, latitude, longitude) float32 2.186 ... 88.53
    vw2              (time, latitude, longitude) float32 22.27 15.12 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 4.946 3.888 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -3.253 -3.531 ... 3.867
    bearings         (latitude, longitude) float64 31.47 24.31 ... 206.9 213.7
    direc_proj_math  (latitude, longitude) float64 1.022 1.146 ... -2.041 -2.159
    wind_proj_mask   (time, latitude, longitude) float64 -3.253 -3.531 ... 3.867
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;379&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 380, coords = (array(168.34508816), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;380&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_380_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 166.9 167.2 167.5 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.269 2.239 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 -0.03846 ... -2.423
    uw2              (time, latitude, longitude) float32 10.68 5.013 ... 1.268
    vw2              (time, latitude, longitude) float32 0.001479 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 3.269 2.245 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.895 1.259 ... 1.321
    bearings         (latitude, longitude) float64 36.1 29.8 ... 208.7 215.4
    direc_proj_math  (latitude, longitude) float64 0.9407 1.051 ... -2.189
    wind_proj_mask   (time, latitude, longitude) float64 1.895 nan ... 1.321
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;380&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 381, coords = (array(168.40554156), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;381&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_381_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.239 1.09 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 0.1688 ... -2.423
    uw2              (time, latitude, longitude) float32 5.013 1.187 ... 1.268
    vw2              (time, latitude, longitude) float32 0.02849 0.2899 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 2.245 1.215 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.301 0.9364 ... 1.37
    bearings         (latitude, longitude) float64 31.09 24.1 ... 207.3 214.2
    direc_proj_math  (latitude, longitude) float64 1.028 1.15 ... -2.047 -2.168
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 1.37
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;381&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 382, coords = (array(168.46599496), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;382&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_382_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.1 169.4 169.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.239 1.09 ... 1.126
    vgrd10m          (time, latitude, longitude) float32 0.1688 ... -2.423
    uw2              (time, latitude, longitude) float32 5.013 1.187 ... 1.268
    vw2              (time, latitude, longitude) float32 0.02849 0.2899 ... 5.87
    wind_magnitude   (time, latitude, longitude) float32 2.245 1.215 ... 2.672
    wind_proj        (time, latitude, longitude) float64 1.34 0.9553 ... 1.42
    bearings         (latitude, longitude) float64 32.34 25.52 ... 205.8 213.0
    direc_proj_math  (latitude, longitude) float64 1.006 1.125 ... -2.021 -2.146
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 1.42
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;382&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 383, coords = (array(168.52644836), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;383&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_383_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.239 1.09 ... -1.145
    vgrd10m          (time, latitude, longitude) float32 0.1688 ... -3.895
    uw2              (time, latitude, longitude) float32 5.013 1.187 ... 1.311
    vw2              (time, latitude, longitude) float32 0.02849 ... 15.17
    wind_magnitude   (time, latitude, longitude) float32 2.245 1.215 ... 4.06
    wind_proj        (time, latitude, longitude) float64 1.378 0.9732 ... 3.775
    bearings         (latitude, longitude) float64 33.56 26.91 ... 211.7 218.0
    direc_proj_math  (latitude, longitude) float64 0.985 1.101 ... -2.123 -2.234
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 1.471 3.775
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;383&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 384, coords = (array(168.70780856), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;384&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_384_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.09 0.1196 ... -1.145
    vgrd10m          (time, latitude, longitude) float32 0.5384 1.09 ... -3.895
    uw2              (time, latitude, longitude) float32 1.187 0.01431 ... 1.311
    vw2              (time, latitude, longitude) float32 0.2899 1.187 ... 15.17
    wind_magnitude   (time, latitude, longitude) float32 1.215 1.096 ... 4.06
    wind_proj        (time, latitude, longitude) float64 1.021 1.045 ... 3.86
    bearings         (latitude, longitude) float64 30.87 23.86 ... 207.5 214.4
    direc_proj_math  (latitude, longitude) float64 1.032 1.154 ... -2.051 -2.172
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 1.628 3.86
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;384&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 385, coords = (array(168.76826196), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;385&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_385_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.09 0.1196 ... -1.145
    vgrd10m          (time, latitude, longitude) float32 0.5384 1.09 ... -3.895
    uw2              (time, latitude, longitude) float32 1.187 0.01431 ... 1.311
    vw2              (time, latitude, longitude) float32 0.2899 1.187 ... 15.17
    wind_magnitude   (time, latitude, longitude) float32 1.215 1.096 ... 4.06
    wind_proj        (time, latitude, longitude) float64 1.035 1.036 ... 3.886
    bearings         (latitude, longitude) float64 32.13 25.28 ... 206.1 213.2
    direc_proj_math  (latitude, longitude) float64 1.01 1.13 ... -2.026 -2.15
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 1.682 3.886
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;385&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 386, coords = (array(172.09319899), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;386&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_386_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.6 170.9 171.2 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.6687 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 3.168 4.258 ... -2.831
    uw2              (time, latitude, longitude) float32 0.4472 0.2807 ... 9.386
    vw2              (time, latitude, longitude) float32 10.04 18.13 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 3.238 4.291 ... 4.171
    wind_proj        (time, latitude, longitude) float64 2.167 3.433 ... 4.083
    bearings         (latitude, longitude) float64 36.07 29.76 ... 208.7 215.5
    direc_proj_math  (latitude, longitude) float64 0.9413 1.051 ... -2.072 -2.19
    wind_proj_mask   (time, latitude, longitude) float64 2.167 3.433 ... 4.083
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;386&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 387, coords = (array(172.15365239), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;387&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_387_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.9 171.2 171.6 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.5298 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 4.258 5.209 ... -2.831
    uw2              (time, latitude, longitude) float32 0.2807 0.1844 ... 9.386
    vw2              (time, latitude, longitude) float32 18.13 27.13 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 4.291 5.226 ... 4.171
    wind_proj        (time, latitude, longitude) float64 3.375 4.931 ... 4.064
    bearings         (latitude, longitude) float64 31.05 24.06 ... 207.3 214.3
    direc_proj_math  (latitude, longitude) float64 1.029 1.151 ... -2.048 -2.169
    wind_proj_mask   (time, latitude, longitude) float64 3.375 4.931 ... 4.064
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;387&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 388, coords = (array(172.21410579), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;388&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_388_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 170.9 171.2 171.6 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.5298 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 4.258 5.209 ... -2.831
    uw2              (time, latitude, longitude) float32 0.2807 0.1844 ... 9.386
    vw2              (time, latitude, longitude) float32 18.13 27.13 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 4.291 5.226 ... 4.171
    wind_proj        (time, latitude, longitude) float64 3.316 4.887 ... 4.043
    bearings         (latitude, longitude) float64 32.3 25.48 ... 205.9 213.0
    direc_proj_math  (latitude, longitude) float64 1.007 1.126 ... -2.022 -2.147
    wind_proj_mask   (time, latitude, longitude) float64 3.316 4.887 ... 4.043
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;388&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 389, coords = (array(183.27707809), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;389&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_389_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.91 2.809 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -4.108 -4.779 ... 2.06
    uw2              (time, latitude, longitude) float32 15.29 7.893 ... 91.57
    vw2              (time, latitude, longitude) float32 16.88 22.84 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 5.671 5.544 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -1.142 -2.874 ... 4.08
    bearings         (latitude, longitude) float64 34.8 28.32 ... 210.3 216.8
    direc_proj_math  (latitude, longitude) float64 0.9634 1.077 ... -2.213
    wind_proj_mask   (time, latitude, longitude) float64 -1.142 -2.874 ... 4.08
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;389&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 390, coords = (array(183.33753149), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;390&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_390_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.91 2.809 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -4.108 -4.779 ... 2.06
    uw2              (time, latitude, longitude) float32 15.29 7.893 ... 91.57
    vw2              (time, latitude, longitude) float32 16.88 22.84 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 5.671 5.544 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -1.03 -2.764 ... 3.895
    bearings         (latitude, longitude) float64 35.96 29.64 ... 208.9 215.6
    direc_proj_math  (latitude, longitude) float64 0.9432 1.053 ... -2.192
    wind_proj_mask   (time, latitude, longitude) float64 -1.03 -2.764 ... 3.895
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;390&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 391, coords = (array(183.63979849), array(-43.96872353)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;391&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_391_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.43 -45.12 -44.8 ... -42.93 -42.62
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.809 1.478 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -4.779 -4.719 ... 1.63
    uw2              (time, latitude, longitude) float32 7.893 2.186 ... 88.53
    vw2              (time, latitude, longitude) float32 22.84 22.27 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 5.544 4.946 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -2.236 -3.385 ... 4.182
    bearings         (latitude, longitude) float64 35.77 29.42 ... 209.1 215.8
    direc_proj_math  (latitude, longitude) float64 0.9466 1.057 ... -2.196
    wind_proj_mask   (time, latitude, longitude) float64 -2.236 -3.385 ... 4.182
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;391&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 392, coords = (array(168.52644836), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;392&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_392_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.108 2.97 ... -1.145
    vgrd10m          (time, latitude, longitude) float32 0.02991 ... -3.895
    uw2              (time, latitude, longitude) float32 16.88 8.819 ... 1.311
    vw2              (time, latitude, longitude) float32 0.0008946 ... 15.17
    wind_magnitude   (time, latitude, longitude) float32 4.108 2.971 ... 4.06
    wind_proj        (time, latitude, longitude) float64 2.617 1.646 ... 3.75
    bearings         (latitude, longitude) float64 39.16 31.9 ... 212.5 218.9
    direc_proj_math  (latitude, longitude) float64 0.8874 1.014 ... -2.138 -2.25
    wind_proj_mask   (time, latitude, longitude) float64 2.617 nan ... 3.75
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;392&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 393, coords = (array(168.58690176), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;393&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_393_winds_gradients_12H_tl1.nc
PCs loaded from file
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> ---------------------------------------------------------                         

 Experiment 1 in site 394, coords = (array(168.64735516), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;394&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_394_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.2 167.5 167.8 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 4.108 2.97 ... -1.145
    vgrd10m          (time, latitude, longitude) float32 0.02991 ... -3.895
    uw2              (time, latitude, longitude) float32 16.88 8.819 ... 1.311
    vw2              (time, latitude, longitude) float32 0.0008946 ... 15.17
    wind_magnitude   (time, latitude, longitude) float32 4.108 2.971 ... 4.06
    wind_proj        (time, latitude, longitude) float64 2.752 1.771 ... 3.81
    bearings         (latitude, longitude) float64 41.64 34.86 ... 209.8 216.6
    direc_proj_math  (latitude, longitude) float64 0.8441 0.9624 ... -2.209
    wind_proj_mask   (time, latitude, longitude) float64 2.752 nan ... 3.81
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;394&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 395, coords = (array(168.70780856), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;395&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_395_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 1.978 ... -1.145
    vgrd10m          (time, latitude, longitude) float32 0.08973 ... -3.895
    uw2              (time, latitude, longitude) float32 8.819 3.914 ... 1.311
    vw2              (time, latitude, longitude) float32 0.008051 ... 15.17
    wind_magnitude   (time, latitude, longitude) float32 2.971 2.024 ... 4.06
    wind_proj        (time, latitude, longitude) float64 1.829 1.321 ... 3.84
    bearings         (latitude, longitude) float64 36.27 28.48 ... 208.3 215.3
    direc_proj_math  (latitude, longitude) float64 0.9378 1.074 ... -2.188
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 1.599 3.84
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;395&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 396, coords = (array(168.76826196), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;396&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_396_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.4 169.7 170.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 1.978 ... -1.145
    vgrd10m          (time, latitude, longitude) float32 0.08973 ... -3.895
    uw2              (time, latitude, longitude) float32 8.819 3.914 ... 1.311
    vw2              (time, latitude, longitude) float32 0.008051 ... 15.17
    wind_magnitude   (time, latitude, longitude) float32 2.971 2.024 ... 4.06
    wind_proj        (time, latitude, longitude) float64 1.884 1.363 ... 3.868
    bearings         (latitude, longitude) float64 37.62 30.09 ... 206.8 214.1
    direc_proj_math  (latitude, longitude) float64 0.9141 1.046 ... -2.165
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 1.654 3.868
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;396&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 397, coords = (array(168.82871537), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;397&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_397_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 1.978 ... -3.626
    vgrd10m          (time, latitude, longitude) float32 0.08973 ... -4.794
    uw2              (time, latitude, longitude) float32 8.819 3.914 ... 13.14
    vw2              (time, latitude, longitude) float32 0.008051 ... 22.98
    wind_magnitude   (time, latitude, longitude) float32 2.971 2.024 ... 6.011
    wind_proj        (time, latitude, longitude) float64 1.936 1.404 ... 6.007
    bearings         (latitude, longitude) float64 38.94 31.65 ... 212.8 219.1
    direc_proj_math  (latitude, longitude) float64 0.8912 1.018 ... -2.253
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.895 6.007
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;397&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 398, coords = (array(172.21410579), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;398&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_398_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 170.9 171.2 171.6 ... 172.8 173.1 173.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -2.16 -1.408 ... -3.064
    vgrd10m          (time, latitude, longitude) float32 2.068 3.429 ... -2.831
    uw2              (time, latitude, longitude) float32 4.665 1.982 ... 9.386
    vw2              (time, latitude, longitude) float32 4.277 11.76 ... 8.013
    wind_magnitude   (time, latitude, longitude) float32 2.99 3.707 ... 4.171
    wind_proj        (time, latitude, longitude) float64 0.3098 2.25 ... 4.058
    bearings         (latitude, longitude) float64 37.81 30.31 ... 206.6 213.9
    direc_proj_math  (latitude, longitude) float64 0.9109 1.042 ... -2.162
    wind_proj_mask   (time, latitude, longitude) float64 0.3098 2.25 ... 4.058
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;398&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 399, coords = (array(172.27455919), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;399&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_399_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 170.9 171.2 171.6 ... 173.1 173.4 173.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -2.16 -1.408 ... -4.657
    vgrd10m          (time, latitude, longitude) float32 2.068 3.429 ... -4.553
    uw2              (time, latitude, longitude) float32 4.665 1.982 ... 21.69
    vw2              (time, latitude, longitude) float32 4.277 11.76 ... 20.73
    wind_magnitude   (time, latitude, longitude) float32 2.99 3.707 ... 6.513
    wind_proj        (time, latitude, longitude) float64 0.2418 2.169 ... 6.468
    bearings         (latitude, longitude) float64 39.12 31.86 ... 212.6 218.9
    direc_proj_math  (latitude, longitude) float64 0.8881 1.015 ... -2.139 -2.25
    wind_proj_mask   (time, latitude, longitude) float64 0.2418 2.169 ... 6.468
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;399&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 400, coords = (array(172.33501259), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;400&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_400_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 170.9 171.2 171.6 ... 173.1 173.4 173.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -2.16 -1.408 ... -4.657
    vgrd10m          (time, latitude, longitude) float32 2.068 3.429 ... -4.553
    uw2              (time, latitude, longitude) float32 4.665 1.982 ... 21.69
    vw2              (time, latitude, longitude) float32 4.277 11.76 ... 20.73
    wind_magnitude   (time, latitude, longitude) float32 2.99 3.707 ... 6.513
    wind_proj        (time, latitude, longitude) float64 0.1761 2.09 ... 6.452
    bearings         (latitude, longitude) float64 40.38 33.36 ... 211.2 217.8
    direc_proj_math  (latitude, longitude) float64 0.866 0.9886 ... -2.115 -2.23
    wind_proj_mask   (time, latitude, longitude) float64 0.1761 2.09 ... 6.452
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;400&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 401, coords = (array(172.7581864), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;401&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_401_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.4 173.8 174.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.392
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -5.858
    uw2              (time, latitude, longitude) float32 0.008051 ... 29.08
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 34.32
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.962
    wind_proj        (time, latitude, longitude) float64 3.79 5.85 ... 7.902
    bearings         (latitude, longitude) float64 35.99 28.15 ... 208.6 215.6
    direc_proj_math  (latitude, longitude) float64 0.9427 1.079 ... -2.07 -2.192
    wind_proj_mask   (time, latitude, longitude) float64 3.79 5.85 ... 7.902
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;401&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 402, coords = (array(172.8186398), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;402&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_402_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.4 173.8 174.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.392
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -5.858
    uw2              (time, latitude, longitude) float32 0.008051 ... 29.08
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 34.32
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.962
    wind_proj        (time, latitude, longitude) float64 3.721 5.808 ... 7.879
    bearings         (latitude, longitude) float64 37.36 29.77 ... 207.1 214.3
    direc_proj_math  (latitude, longitude) float64 0.9188 1.051 ... -2.044 -2.17
    wind_proj_mask   (time, latitude, longitude) float64 3.721 5.808 ... 7.879
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;402&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 403, coords = (array(172.8790932), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;403&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_403_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -6.174
    uw2              (time, latitude, longitude) float32 0.008051 ... 25.66
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.986
    wind_proj        (time, latitude, longitude) float64 3.652 5.762 ... 7.986
    bearings         (latitude, longitude) float64 38.68 31.34 ... 213.0 219.3
    direc_proj_math  (latitude, longitude) float64 0.8957 1.024 ... -2.257
    wind_proj_mask   (time, latitude, longitude) float64 3.652 5.762 ... 7.986
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;403&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 404, coords = (array(172.9395466), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;404&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_404_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -6.174
    uw2              (time, latitude, longitude) float32 0.008051 ... 25.66
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.986
    wind_proj        (time, latitude, longitude) float64 3.583 5.714 ... 7.985
    bearings         (latitude, longitude) float64 39.96 32.86 ... 211.7 218.2
    direc_proj_math  (latitude, longitude) float64 0.8734 0.9973 ... -2.237
    wind_proj_mask   (time, latitude, longitude) float64 3.583 5.714 ... 7.985
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;404&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 405, coords = (array(173.), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;405&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_405_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -6.174
    uw2              (time, latitude, longitude) float32 0.008051 ... 25.66
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.986
    wind_proj        (time, latitude, longitude) float64 3.515 5.664 ... 7.98
    bearings         (latitude, longitude) float64 41.19 34.33 ... 210.3 217.0
    direc_proj_math  (latitude, longitude) float64 0.8519 0.9717 ... -2.217
    wind_proj_mask   (time, latitude, longitude) float64 3.515 5.664 ... 7.98
Computing using CPU
matrix (23007, 126)
PCs (23007, 126)
comp (126, 126)
var (126,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;405&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 406, coords = (array(173.0604534), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;406&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_406_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -6.174
    uw2              (time, latitude, longitude) float32 0.008051 ... 25.66
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.986
    wind_proj        (time, latitude, longitude) float64 3.448 5.611 ... 7.971
    bearings         (latitude, longitude) float64 42.38 35.75 ... 208.9 215.8
    direc_proj_math  (latitude, longitude) float64 0.8311 0.9468 ... -2.196
    wind_proj_mask   (time, latitude, longitude) float64 3.448 5.611 ... 7.971
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;406&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 407, coords = (array(183.33753149), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;407&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_407_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 2.06
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 91.57
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -0.7922 ... 4.038
    bearings         (latitude, longitude) float64 41.69 34.92 ... 209.7 216.5
    direc_proj_math  (latitude, longitude) float64 0.8432 0.9613 ... -2.208
    wind_proj_mask   (time, latitude, longitude) float64 -0.7922 ... 4.038
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;407&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 408, coords = (array(183.63979849), array(-43.92485685)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;408&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_408_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.899 0.7285 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -3.779 -3.109 ... 1.63
    uw2              (time, latitude, longitude) float32 3.607 0.5307 ... 88.53
    vw2              (time, latitude, longitude) float32 14.28 9.663 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 4.23 3.193 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -1.573 -2.142 ... 4.318
    bearings         (latitude, longitude) float64 41.49 34.68 ... 209.9 216.7
    direc_proj_math  (latitude, longitude) float64 0.8467 0.9655 ... -2.212
    wind_proj_mask   (time, latitude, longitude) float64 -1.573 -2.142 ... 4.318
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;408&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 409, coords = (array(168.82871537), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;409&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_409_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 1.978 ... -3.626
    vgrd10m          (time, latitude, longitude) float32 0.08973 ... -4.794
    uw2              (time, latitude, longitude) float32 8.819 3.914 ... 13.14
    vw2              (time, latitude, longitude) float32 0.008051 ... 22.98
    wind_magnitude   (time, latitude, longitude) float32 2.971 2.024 ... 6.011
    wind_proj        (time, latitude, longitude) float64 1.897 1.38 ... 6.003
    bearings         (latitude, longitude) float64 37.94 30.74 ... 213.7 220.1
    direc_proj_math  (latitude, longitude) float64 0.9085 1.034 ... -2.158 -2.27
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.876 6.003
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;409&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 410, coords = (array(168.88916877), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;410&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_410_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 1.978 ... -3.626
    vgrd10m          (time, latitude, longitude) float32 0.08973 ... -4.794
    uw2              (time, latitude, longitude) float32 8.819 3.914 ... 13.14
    vw2              (time, latitude, longitude) float32 0.008051 ... 22.98
    wind_magnitude   (time, latitude, longitude) float32 2.971 2.024 ... 6.011
    wind_proj        (time, latitude, longitude) float64 1.947 1.418 ... 6.008
    bearings         (latitude, longitude) float64 39.2 32.23 ... 212.3 218.9
    direc_proj_math  (latitude, longitude) float64 0.8866 1.008 ... -2.134 -2.25
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.904 6.008
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;410&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 411, coords = (array(172.33501259), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;411&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_411_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 170.9 171.2 171.6 ... 173.1 173.4 173.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -2.16 -1.408 ... -4.657
    vgrd10m          (time, latitude, longitude) float32 2.068 3.429 ... -4.553
    uw2              (time, latitude, longitude) float32 4.665 1.982 ... 21.69
    vw2              (time, latitude, longitude) float32 4.277 11.76 ... 20.73
    wind_magnitude   (time, latitude, longitude) float32 2.99 3.707 ... 6.513
    wind_proj        (time, latitude, longitude) float64 0.2285 2.139 ... 6.466
    bearings         (latitude, longitude) float64 39.37 32.43 ... 212.1 218.8
    direc_proj_math  (latitude, longitude) float64 0.8836 1.005 ... -2.247
    wind_proj_mask   (time, latitude, longitude) float64 0.2285 2.139 ... 6.466
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;411&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 412, coords = (array(172.39546599), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;412&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_412_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 170.9 171.2 171.6 ... 173.1 173.4 173.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -2.16 -1.408 ... -4.657
    vgrd10m          (time, latitude, longitude) float32 2.068 3.429 ... -4.553
    uw2              (time, latitude, longitude) float32 4.665 1.982 ... 21.69
    vw2              (time, latitude, longitude) float32 4.277 11.76 ... 20.73
    wind_magnitude   (time, latitude, longitude) float32 2.99 3.707 ... 6.513
    wind_proj        (time, latitude, longitude) float64 0.1654 2.063 ... 6.448
    bearings         (latitude, longitude) float64 40.59 33.87 ... 210.7 217.6
    direc_proj_math  (latitude, longitude) float64 0.8624 0.9797 ... -2.226
    wind_proj_mask   (time, latitude, longitude) float64 0.1654 2.063 ... 6.448
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;412&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 413, coords = (array(172.4559194), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;413&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_413_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.2 171.6 171.9 ... 173.1 173.4 173.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -1.408 ... -4.657
    vgrd10m          (time, latitude, longitude) float32 3.429 4.749 ... -4.553
    uw2              (time, latitude, longitude) float32 1.982 ... 21.69
    vw2              (time, latitude, longitude) float32 11.76 22.56 ... 20.73
    wind_magnitude   (time, latitude, longitude) float32 3.707 4.75 ... 6.513
    wind_proj        (time, latitude, longitude) float64 1.987 4.168 ... 6.427
    bearings         (latitude, longitude) float64 35.26 27.59 ... 209.2 216.3
    direc_proj_math  (latitude, longitude) float64 0.9555 1.089 ... -2.08 -2.205
    wind_proj_mask   (time, latitude, longitude) float64 1.987 4.168 ... 6.427
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;413&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 414, coords = (array(172.5163728), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;414&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_414_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.2 171.6 171.9 ... 173.1 173.4 173.8
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -1.408 ... -4.657
    vgrd10m          (time, latitude, longitude) float32 3.429 4.749 ... -4.553
    uw2              (time, latitude, longitude) float32 1.982 ... 21.69
    vw2              (time, latitude, longitude) float32 11.76 22.56 ... 20.73
    wind_magnitude   (time, latitude, longitude) float32 3.707 4.75 ... 6.513
    wind_proj        (time, latitude, longitude) float64 1.913 4.104 ... 6.401
    bearings         (latitude, longitude) float64 36.6 29.16 ... 207.7 215.0
    direc_proj_math  (latitude, longitude) float64 0.932 1.062 ... -2.054 -2.182
    wind_proj_mask   (time, latitude, longitude) float64 1.913 4.104 ... 6.401
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;414&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 415, coords = (array(172.5768262), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;415&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_415_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.2 171.6 171.9 ... 173.4 173.8 174.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -1.408 ... -5.392
    vgrd10m          (time, latitude, longitude) float32 3.429 4.749 ... -5.858
    uw2              (time, latitude, longitude) float32 1.982 ... 29.08
    vw2              (time, latitude, longitude) float32 11.76 22.56 ... 34.32
    wind_magnitude   (time, latitude, longitude) float32 3.707 4.75 ... 7.962
    wind_proj        (time, latitude, longitude) float64 1.841 4.038 ... 7.954
    bearings         (latitude, longitude) float64 37.9 30.7 ... 213.7 220.1
    direc_proj_math  (latitude, longitude) float64 0.9092 1.035 ... -2.271
    wind_proj_mask   (time, latitude, longitude) float64 1.841 4.038 ... 7.954
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;415&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 416, coords = (array(172.6372796), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;416&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_416_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.2 171.6 171.9 ... 173.4 173.8 174.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -1.408 ... -5.392
    vgrd10m          (time, latitude, longitude) float32 3.429 4.749 ... -5.858
    uw2              (time, latitude, longitude) float32 1.982 ... 29.08
    vw2              (time, latitude, longitude) float32 11.76 22.56 ... 34.32
    wind_magnitude   (time, latitude, longitude) float32 3.707 4.75 ... 7.962
    wind_proj        (time, latitude, longitude) float64 1.769 3.972 ... 7.946
    bearings         (latitude, longitude) float64 39.16 32.18 ... 212.3 219.0
    direc_proj_math  (latitude, longitude) float64 0.8872 1.009 ... -2.251
    wind_proj_mask   (time, latitude, longitude) float64 1.769 3.972 ... 7.946
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;416&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 417, coords = (array(172.697733), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;417&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_417_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.2 171.6 171.9 ... 173.4 173.8 174.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -1.408 ... -5.392
    vgrd10m          (time, latitude, longitude) float32 3.429 4.749 ... -5.858
    uw2              (time, latitude, longitude) float32 1.982 ... 29.08
    vw2              (time, latitude, longitude) float32 11.76 22.56 ... 34.32
    wind_magnitude   (time, latitude, longitude) float32 3.707 4.75 ... 7.962
    wind_proj        (time, latitude, longitude) float64 1.7 3.905 ... 7.933
    bearings         (latitude, longitude) float64 40.38 33.63 ... 210.9 217.8
    direc_proj_math  (latitude, longitude) float64 0.866 0.9839 ... -2.11 -2.23
    wind_proj_mask   (time, latitude, longitude) float64 1.7 3.905 ... 7.933
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;417&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 418, coords = (array(172.7581864), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;418&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_418_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.4 173.8 174.1
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.392
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -5.858
    uw2              (time, latitude, longitude) float32 0.008051 ... 29.08
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 34.32
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.962
    wind_proj        (time, latitude, longitude) float64 3.838 5.87 ... 7.917
    bearings         (latitude, longitude) float64 35.02 27.31 ... 209.5 216.5
    direc_proj_math  (latitude, longitude) float64 0.9595 1.094 ... -2.208
    wind_proj_mask   (time, latitude, longitude) float64 3.838 5.87 ... 7.917
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;418&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 419, coords = (array(173.0604534), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;419&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_419_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.6 171.9 172.2 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 -0.08973 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 4.749 5.828 ... -6.174
    uw2              (time, latitude, longitude) float32 0.008051 ... 25.66
    vw2              (time, latitude, longitude) float32 22.56 33.97 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 4.75 6.02 ... 7.986
    wind_proj        (time, latitude, longitude) float64 3.505 5.647 ... 7.978
    bearings         (latitude, longitude) float64 41.36 34.79 ... 209.7 216.7
    direc_proj_math  (latitude, longitude) float64 0.8488 0.9636 ... -2.212
    wind_proj_mask   (time, latitude, longitude) float64 3.505 5.647 ... 7.978
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;419&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 420, coords = (array(173.1209068), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;420&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_420_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.9 172.2 172.5 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.508 2.779 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 5.828 6.51 ... -6.174
    uw2              (time, latitude, longitude) float32 2.275 7.726 ... 25.66
    vw2              (time, latitude, longitude) float32 33.97 42.38 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 6.02 7.078 ... 7.986
    wind_proj        (time, latitude, longitude) float64 5.596 7.046 ... 7.968
    bearings         (latitude, longitude) float64 36.15 28.63 ... 208.2 215.5
    direc_proj_math  (latitude, longitude) float64 0.9399 1.071 ... -2.063 -2.19
    wind_proj_mask   (time, latitude, longitude) float64 5.596 7.046 ... 7.968
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;420&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 421, coords = (array(183.09571788), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;421&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_421_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 183.8 184.1 184.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -9.251
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 2.087
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 85.58
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 4.357
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 9.483
    wind_proj        (time, latitude, longitude) float64 -1.292 -2.447 ... 3.75
    bearings         (latitude, longitude) float64 35.59 27.98 ... 208.8 216.0
    direc_proj_math  (latitude, longitude) float64 0.9497 1.083 ... -2.199
    wind_proj_mask   (time, latitude, longitude) float64 -1.292 -2.447 ... 3.75
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;421&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 422, coords = (array(183.15617128), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;422&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_422_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 183.8 184.1 184.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -9.251
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 2.087
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 85.58
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 4.357
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 9.483
    wind_proj        (time, latitude, longitude) float64 -1.184 -2.351 ... 3.552
    bearings         (latitude, longitude) float64 36.92 29.54 ... 207.3 214.7
    direc_proj_math  (latitude, longitude) float64 0.9263 1.055 ... -2.177
    wind_proj_mask   (time, latitude, longitude) float64 -1.184 -2.351 ... 3.552
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;422&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 423, coords = (array(183.21662469), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;423&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_423_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 2.06
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 91.57
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -1.078 -2.257 ... 4.548
    bearings         (latitude, longitude) float64 38.22 31.06 ... 213.4 219.8
    direc_proj_math  (latitude, longitude) float64 0.9038 1.029 ... -2.266
    wind_proj_mask   (time, latitude, longitude) float64 -1.078 -2.257 ... 4.548
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;423&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 424, coords = (array(183.27707809), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;424&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_424_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 2.06
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 91.57
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -0.9757 ... 4.371
    bearings         (latitude, longitude) float64 39.47 32.54 ... 212.0 218.7
    direc_proj_math  (latitude, longitude) float64 0.882 1.003 ... -2.129 -2.246
    wind_proj_mask   (time, latitude, longitude) float64 -0.9757 ... 4.371
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;424&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 425, coords = (array(183.33753149), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;425&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_425_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 184.1 184.4 184.7
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -9.569
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 2.06
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 91.57
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 4.242
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 9.788
    wind_proj        (time, latitude, longitude) float64 -0.8761 ... 4.186
    bearings         (latitude, longitude) float64 40.68 33.97 ... 210.6 217.5
    direc_proj_math  (latitude, longitude) float64 0.8609 0.9779 ... -2.225
    wind_proj_mask   (time, latitude, longitude) float64 -0.8761 ... 4.186
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;425&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 426, coords = (array(183.63979849), array(-43.8809578)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;426&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_426_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.899 0.7285 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -3.779 -3.109 ... 1.63
    uw2              (time, latitude, longitude) float32 3.607 0.5307 ... 88.53
    vw2              (time, latitude, longitude) float32 14.28 9.663 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 4.23 3.193 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -1.642 -2.181 ... 4.46
    bearings         (latitude, longitude) float64 40.47 33.73 ... 210.8 217.7
    direc_proj_math  (latitude, longitude) float64 0.8644 0.9821 ... -2.228
    wind_proj_mask   (time, latitude, longitude) float64 -1.642 -2.181 ... 4.46
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;426&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 427, coords = (array(168.88916877), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;427&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_427_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 1.978 ... -3.626
    vgrd10m          (time, latitude, longitude) float32 0.08973 ... -4.794
    uw2              (time, latitude, longitude) float32 8.819 3.914 ... 13.14
    vw2              (time, latitude, longitude) float32 0.008051 ... 22.98
    wind_magnitude   (time, latitude, longitude) float32 2.971 2.024 ... 6.011
    wind_proj        (time, latitude, longitude) float64 1.909 1.396 ... 6.003
    bearings         (latitude, longitude) float64 38.24 31.35 ... 213.2 219.9
    direc_proj_math  (latitude, longitude) float64 0.9034 1.024 ... -2.268
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.885 6.003
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;427&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 428, coords = (array(168.94962217), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;428&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_428_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.5 167.8 168.1 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 2.97 1.978 ... -3.626
    vgrd10m          (time, latitude, longitude) float32 0.08973 ... -4.794
    uw2              (time, latitude, longitude) float32 8.819 3.914 ... 13.14
    vw2              (time, latitude, longitude) float32 0.008051 ... 22.98
    wind_magnitude   (time, latitude, longitude) float32 2.971 2.024 ... 6.011
    wind_proj        (time, latitude, longitude) float64 1.956 1.432 ... 6.008
    bearings         (latitude, longitude) float64 39.45 32.77 ... 211.8 218.7
    direc_proj_math  (latitude, longitude) float64 0.8823 0.9989 ... -2.247
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.914 6.008
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;428&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 429, coords = (array(169.01007557), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;429&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_429_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.978 1.179 ... -3.626
    vgrd10m          (time, latitude, longitude) float32 0.4294 1.068 ... -4.794
    uw2              (time, latitude, longitude) float32 3.914 1.391 ... 13.14
    vw2              (time, latitude, longitude) float32 0.1844 1.141 ... 22.98
    wind_magnitude   (time, latitude, longitude) float32 2.024 1.591 ... 6.011
    wind_proj        (time, latitude, longitude) float64 1.466 1.483 ... 6.011
    bearings         (latitude, longitude) float64 34.15 26.57 ... 210.3 217.5
    direc_proj_math  (latitude, longitude) float64 0.9748 1.107 ... -2.1 -2.225
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.94 6.011
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;429&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 430, coords = (array(173.1209068), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;430&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_430_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.9 172.2 172.5 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.508 2.779 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 5.828 6.51 ... -6.174
    uw2              (time, latitude, longitude) float32 2.275 7.726 ... 25.66
    vw2              (time, latitude, longitude) float32 33.97 42.38 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 6.02 7.078 ... 7.986
    wind_proj        (time, latitude, longitude) float64 5.631 7.055 ... 7.976
    bearings         (latitude, longitude) float64 35.22 27.82 ... 209.1 216.5
    direc_proj_math  (latitude, longitude) float64 0.9561 1.085 ... -2.207
    wind_proj_mask   (time, latitude, longitude) float64 5.631 7.055 ... 7.976
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;430&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 431, coords = (array(173.1813602), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;431&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_431_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 171.9 172.2 172.5 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.508 2.779 ... -5.065
    vgrd10m          (time, latitude, longitude) float32 5.828 6.51 ... -6.174
    uw2              (time, latitude, longitude) float32 2.275 7.726 ... 25.66
    vw2              (time, latitude, longitude) float32 33.97 42.38 ... 38.12
    wind_magnitude   (time, latitude, longitude) float32 6.02 7.078 ... 7.986
    wind_proj        (time, latitude, longitude) float64 5.581 7.037 ... 7.964
    bearings         (latitude, longitude) float64 36.52 29.34 ... 207.5 215.1
    direc_proj_math  (latitude, longitude) float64 0.9334 1.059 ... -2.184
    wind_proj_mask   (time, latitude, longitude) float64 5.581 7.037 ... 7.964
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;431&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 432, coords = (array(183.09571788), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;432&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_432_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 183.8 184.1 184.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -9.251
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 2.087
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 85.58
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 4.357
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 9.483
    wind_proj        (time, latitude, longitude) float64 -1.367 -2.495 ... 3.899
    bearings         (latitude, longitude) float64 34.66 27.17 ... 209.7 217.0
    direc_proj_math  (latitude, longitude) float64 0.9658 1.097 ... -2.216
    wind_proj_mask   (time, latitude, longitude) float64 -1.367 -2.495 ... 3.899
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;432&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 433, coords = (array(183.63979849), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;433&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_433_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 182.2 182.5 182.8 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.899 0.7285 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -3.779 -3.109 ... 1.63
    uw2              (time, latitude, longitude) float32 3.607 0.5307 ... 88.53
    vw2              (time, latitude, longitude) float32 14.28 9.663 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 4.23 3.193 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -1.708 -2.217 ... 4.607
    bearings         (latitude, longitude) float64 39.5 32.83 ... 211.7 218.7
    direc_proj_math  (latitude, longitude) float64 0.8814 0.9978 ... -2.246
    wind_proj_mask   (time, latitude, longitude) float64 -1.708 -2.217 ... 4.607
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;433&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 434, coords = (array(183.70025189), array(-43.83702638)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;434&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_434_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 9, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.93 -42.62
  * longitude        (longitude) float32 182.5 182.8 183.1 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 0.7285 ... -9.409
    vgrd10m          (time, latitude, longitude) float32 -3.109 -1.818 ... 1.63
    uw2              (time, latitude, longitude) float32 0.5307 0.1154 ... 88.53
    vw2              (time, latitude, longitude) float32 9.663 3.305 ... 2.657
    wind_magnitude   (time, latitude, longitude) float32 3.193 1.85 ... 9.549
    wind_proj        (time, latitude, longitude) float64 -2.161 -1.777 ... 4.424
    bearings         (latitude, longitude) float64 34.21 26.64 ... 210.2 217.4
    direc_proj_math  (latitude, longitude) float64 0.9738 1.106 ... -2.224
    wind_proj_mask   (time, latitude, longitude) float64 -2.161 -1.777 ... 4.424
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;434&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 435, coords = (array(169.01007557), array(-43.79306259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;435&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_435_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.62 -42.31
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.978 1.179 ... 1.863
    vgrd10m          (time, latitude, longitude) float32 0.4294 1.068 ... -5.313
    uw2              (time, latitude, longitude) float32 3.914 1.391 ... 3.471
    vw2              (time, latitude, longitude) float32 0.1844 1.141 ... 28.23
    wind_magnitude   (time, latitude, longitude) float32 2.024 1.591 ... 5.63
    wind_proj        (time, latitude, longitude) float64 1.444 1.475 ... 3.504
    bearings         (latitude, longitude) float64 33.27 25.82 ... 205.6 212.2
    direc_proj_math  (latitude, longitude) float64 0.9902 1.12 ... -2.018 -2.133
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.504
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;435&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 436, coords = (array(169.07052897), array(-43.79306259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;436&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_436_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.62 -42.31
  * longitude        (longitude) float32 167.8 168.1 168.4 ... 169.7 170.0 170.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.978 1.179 ... 1.863
    vgrd10m          (time, latitude, longitude) float32 0.4294 1.068 ... -5.313
    uw2              (time, latitude, longitude) float32 3.914 1.391 ... 3.471
    vw2              (time, latitude, longitude) float32 0.1844 1.141 ... 28.23
    wind_magnitude   (time, latitude, longitude) float32 2.024 1.591 ... 5.63
    wind_proj        (time, latitude, longitude) float64 1.477 1.491 ... 3.596
    bearings         (latitude, longitude) float64 34.59 27.34 ... 204.2 211.0
    direc_proj_math  (latitude, longitude) float64 0.9671 1.094 ... -2.112
    wind_proj_mask   (time, latitude, longitude) float64 nan nan ... 3.596
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;436&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 437, coords = (array(173.1813602), array(-43.79306259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;437&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_437_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.62 -42.31
  * longitude        (longitude) float32 171.9 172.2 172.5 ... 173.8 174.1 174.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 1.508 2.779 ... -4.14
    vgrd10m          (time, latitude, longitude) float32 5.828 6.51 ... -5.546
    uw2              (time, latitude, longitude) float32 2.275 7.726 ... 17.14
    vw2              (time, latitude, longitude) float32 33.97 42.38 ... 30.76
    wind_magnitude   (time, latitude, longitude) float32 6.02 7.078 ... 6.921
    wind_proj        (time, latitude, longitude) float64 5.616 7.047 ... 6.873
    bearings         (latitude, longitude) float64 35.62 28.53 ... 203.1 210.0
    direc_proj_math  (latitude, longitude) float64 0.9492 1.073 ... -2.094
    wind_proj_mask   (time, latitude, longitude) float64 5.616 7.047 ... 6.873
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;437&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 438, coords = (array(183.09571788), array(-43.79306259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;438&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_438_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.62 -42.31
  * longitude        (longitude) float32 181.9 182.2 182.5 ... 183.8 184.1 184.4
Data variables:
    ugrd10m          (time, latitude, longitude) float32 3.019 1.899 ... -8.7
    vgrd10m          (time, latitude, longitude) float32 -3.749 -3.779 ... 1.925
    uw2              (time, latitude, longitude) float32 9.113 3.607 ... 75.68
    vw2              (time, latitude, longitude) float32 14.06 14.28 ... 3.705
    wind_magnitude   (time, latitude, longitude) float32 4.814 4.23 ... 8.91
    wind_proj        (time, latitude, longitude) float64 -1.438 -2.54 ... 2.939
    bearings         (latitude, longitude) float64 33.78 26.41 ... 205.1 211.7
    direc_proj_math  (latitude, longitude) float64 0.9813 1.11 ... -2.009 -2.125
    wind_proj_mask   (time, latitude, longitude) float64 -1.438 -2.54 ... 2.939
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;438&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 439, coords = (array(183.70025189), array(-43.79306259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;439&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_439_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.62 -42.31
  * longitude        (longitude) float32 182.5 182.8 183.1 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 0.7285 ... -7.191
    vgrd10m          (time, latitude, longitude) float32 -3.109 ... 0.2692
    uw2              (time, latitude, longitude) float32 0.5307 0.1154 ... 51.71
    vw2              (time, latitude, longitude) float32 9.663 3.305 ... 0.07246
    wind_magnitude   (time, latitude, longitude) float32 3.193 1.85 ... 7.196
    wind_proj        (time, latitude, longitude) float64 -2.197 -1.784 ... 3.598
    bearings         (latitude, longitude) float64 33.33 25.89 ... 205.6 212.1
    direc_proj_math  (latitude, longitude) float64 0.9891 1.119 ... -2.132
    wind_proj_mask   (time, latitude, longitude) float64 -2.197 -1.784 ... 3.598
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;439&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 440, coords = (array(183.76070529), array(-43.79306259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;440&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_440_winds_gradients_12H_tl1.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 9)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.62 -42.31
  * longitude        (longitude) float32 182.5 182.8 183.1 ... 184.4 184.7 185.0
Data variables:
    ugrd10m          (time, latitude, longitude) float32 0.7285 ... -7.191
    vgrd10m          (time, latitude, longitude) float32 -3.109 ... 0.2692
    uw2              (time, latitude, longitude) float32 0.5307 0.1154 ... 51.71
    vw2              (time, latitude, longitude) float32 9.663 3.305 ... 0.07246
    wind_magnitude   (time, latitude, longitude) float32 3.193 1.85 ... 7.196
    wind_proj        (time, latitude, longitude) float64 -2.143 -1.77 ... 3.466
    bearings         (latitude, longitude) float64 34.65 27.41 ... 204.2 210.9
    direc_proj_math  (latitude, longitude) float64 0.9661 1.092 ... -2.111
    wind_proj_mask   (time, latitude, longitude) float64 -2.143 -1.77 ... 3.466
Computing using CPU
matrix (23007, 108)
PCs (23007, 108)
comp (108, 108)
var (108,)
lon &lt;xarray.DataArray &#39;longitude&#39; (longitude: 101)&gt;
array([140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5, 144. , 144.5,
       145. , 145.5, 146. , 146.5, 147. , 147.5, 148. , 148.5, 149. , 149.5,
       150. , 150.5, 151. , 151.5, 152. , 152.5, 153. , 153.5, 154. , 154.5,
       155. , 155.5, 156. , 156.5, 157. , 157.5, 158. , 158.5, 159. , 159.5,
       160. , 160.5, 161. , 161.5, 162. , 162.5, 163. , 163.5, 164. , 164.5,
       165. , 165.5, 166. , 166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5,
       170. , 170.5, 171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5,
       175. , 175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
       180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. , 184.5,
       185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5, 189. , 189.5,
       190. ])
Coordinates:
  * longitude  (longitude) float64 140.0 140.5 141.0 141.5 ... 189.0 189.5 190.0
Attributes:
    units:      degrees_east
    long_name:  longitude
lat &lt;xarray.DataArray &#39;latitude&#39; (latitude: 101)&gt;
array([-70. , -69.5, -69. , -68.5, -68. , -67.5, -67. , -66.5, -66. , -65.5,
       -65. , -64.5, -64. , -63.5, -63. , -62.5, -62. , -61.5, -61. , -60.5,
       -60. , -59.5, -59. , -58.5, -58. , -57.5, -57. , -56.5, -56. , -55.5,
       -55. , -54.5, -54. , -53.5, -53. , -52.5, -52. , -51.5, -51. , -50.5,
       -50. , -49.5, -49. , -48.5, -48. , -47.5, -47. , -46.5, -46. , -45.5,
       -45. , -44.5, -44. , -43.5, -43. , -42.5, -42. , -41.5, -41. , -40.5,
       -40. , -39.5, -39. , -38.5, -38. , -37.5, -37. , -36.5, -36. , -35.5,
       -35. , -34.5, -34. , -33.5, -33. , -32.5, -32. , -31.5, -31. , -30.5,
       -30. , -29.5, -29. , -28.5, -28. , -27.5, -27. , -26.5, -26. , -25.5,
       -25. , -24.5, -24. , -23.5, -23. , -22.5, -22. , -21.5, -21. , -20.5,
       -20. ])
Coordinates:
  * latitude  (latitude) float64 -70.0 -69.5 -69.0 -68.5 ... -21.0 -20.5 -20.0
Attributes:
    units:      degrees_north
    long_name:  latitude
time (46015,)
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;440&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]

 ---------------------------------------------------------                         

 Experiment 1 in site 441, coords = (array(183.82115869), array(-43.79306259)) ......                         

 pca_params = {&#39;calculate_gradient&#39;: True, &#39;winds&#39;: True, &#39;time_lapse&#39;: 1, &#39;time_resample&#39;: &#39;12H&#39;, &#39;region&#39;: (&#39;local&#39;, (1.5, 1.5))} 

                         

 and iteration with indexes = (0, 0, 0, 0, 0)                         

time resample 12H-----------------------------------------
/home/metocean/pcas [&#39;local_1.5_1.5&#39;, &#39;441&#39;, &#39;winds&#39;, &#39;gradients&#39;, &#39;12H&#39;, &#39;tl1&#39;]
FILE /home/metocean/pcas/local_1.5_1.5_441_winds_gradients_12H_tl1.nc

 calculating winds with: 

 &lt;xarray.Dataset&gt;
Dimensions:         (time: 46141, latitude: 160, longitude: 161)
Coordinates:
  * time            (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude        (latitude) float32 -69.78 -69.47 -69.16 ... -20.45 -20.14
  * longitude       (longitude) float32 140.0 140.3 140.6 ... 189.4 189.7 190.0
Data variables:
    ugrd10m         (time, latitude, longitude) float32 1.25 1.408 ... 10.53
    vgrd10m         (time, latitude, longitude) float32 8.33 8.559 ... -10.06
    uw2             (time, latitude, longitude) float32 1.562 1.982 ... 110.8
    vw2             (time, latitude, longitude) float32 69.39 73.25 ... 101.2
    wind_magnitude  (time, latitude, longitude) float32 8.423 8.674 ... 14.56 

Assembling matrix
              total        used        free      shared  buff/cache   available
Mem:           125G         87G         26G         18M         11G         36G
Swap:          3.9G        215M        3.7G
Start 0
&lt;xarray.Dataset&gt;
Dimensions:          (time: 46141, latitude: 10, longitude: 10)
Coordinates:
  * time             (time) datetime64[ns] 1990-01-01 ... 2021-08-01
  * latitude         (latitude) float32 -45.12 -44.8 -44.49 ... -42.62 -42.31
  * longitude        (longitude) float32 182.5 182.8 183.1 ... 184.7 185.0 185.3
Data variables:
    ugrd10m          (time, latitude, longitude) float32 0.7285 ... -5.568
    vgrd10m          (time, latitude, longitude) float32 -3.109 ... -1.536
    uw2              (time, latitude, longitude) float32 0.5307 0.1154 ... 31.0
    vw2              (time, latitude, longitude) float32 9.663 3.305 ... 2.36
    wind_magnitude   (time, latitude, longitude) float32 3.193 1.85 ... 5.776
    wind_proj        (time, latitude, longitude) float64 -2.09 -1.756 ... 4.499
    bearings         (latitude, longitude) float64 35.92 28.89 ... 209.7 215.7
    direc_proj_math  (latitude, longitude) float64 0.9438 1.067 ... -2.195
    wind_proj_mask   (time, latitude, longitude) float64 -2.09 -1.756 ... 4.499
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-.conda-seb_ss-py"
        },
        kernelOptions: {
            kernelName: "conda-env-.conda-seb_ss-py",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-.conda-seb_ss-py'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Javier Tausa Hoyal<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>